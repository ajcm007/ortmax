/*! For license information please see officebrowserfeedback_floodgate.min.js.LICENSE.txt */
!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=53)}([function(n,t,i){"use strict";i.d(t,"a",function(){return r});i.d(t,"b",function(){return u});i.d(t,"c",function(){return f});i.d(t,"d",function(){return e});i.d(t,"e",function(){return o});i.d(t,"h",function(){return s});i.d(t,"g",function(){return h});i.d(t,"i",function(){return c});i.d(t,"f",function(){return l});var r=function(){function n(){}return n.Alt="alt",n.AriaLabel="aria-label",n.AriaSelected="aria-selected",n.AriaOrientation="aria-orientation",n.AriaExpanded="aria-expanded",n.AriaControls="aria-controls",n.AriaHasPopups="aria-haspopup",n.AriaModal="aria-modal",n.AriaLabelledBy="aria-labelledby",n.AriaDescribedBy="aria-describedby",n.Class="class",n.DataHtml2CanvasIgnore="data-html2canvas-ignore",n.Disabled="disabled",n.Fill="fill",n.For="for",n.Preview="preview",n.Form="form",n.Height="height",n.HRef="href",n.Id="id",n.MaxLength="maxlength",n.Name="name",n.Placeholder="placeholder",n.Points="points",n.Rel="rel",n.Role="role",n.Source="src",n.Stroke="stroke",n.TabIndex="tabindex",n.Target="target",n.Transform="transform",n.Type="type",n.Value="value",n.ViewBox="viewBox",n.Width="width",n.xlinkHref="xlink:href",n.X="x",n.Y="y",n}(),u=function(){function n(){}return n.BlankWindow="_blank",n.Button="button",n.Dialog="dialog",n.Tab="tab",n.TabList="tablist",n.TabPanel="tabpanel",n.Checkbox="checkbox",n.Checked="checked",n.False="false",n.Zero="0",n.Polite="polite",n.Radio="radio",n.Submit="submit",n.ScreenshotPreview="ScreenshotPreview",n.Text="text",n.TextAreaMaxLength="1000",n.True="true",n.Unchecked="unchecked",n.NoReferrer="noreferrer",n.AriaOrientationValueVertical="vertical",n}(),f=(function(){function n(){}n.CLCID="CLCID"}(),function(){function n(){}return n.AriaLiveTemplate="obf-AriaLiveTemplate",n.CheckBox="obf-CheckBox",n.FontTitle="obf-FontTitle",n.CloseButton="obf-CloseButton",n.FontSubtitle="obf-FontSubtitle",n.FontText="obf-FontText",n.FontSubText="obf-FontSubText",n.FontSubSubText="obf-FontSubSubText",n.Hidden="obf-Hidden",n.Link="obf-Link",n.MarginLeft60px="obf-MarginLeft60px",n.MarginLeft180px="obf-MarginLeft180px",n.NarrowLayout="obf-NarrowLayout",n.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",n.Rtl="obf-Rtl",n.Spinner="obf-Spinner",n.SpinnerCircle="obf-SpinnerCircle",n.SubmitButton="obf-SubmitButton",n.CancelButton="obf-CancelButton",n.TextInput="obf-TextInput",n.Visible="obf-Visible",n.Rating="obf-Rating",n.RatingGraphic="obf-RatingGraphic",n.RatingGraphicFilled="obf-RatingGraphic-Filled",n.ChoiceGroup="obf-ChoiceGroup",n.ChoiceGroupIcon="obf-ChoiceGroupIcon",n.OverallAnchor="obf-OverallAnchor",n.OverallAnchorActive="obf-OverallAnchorActive",n.OverallImage="obf-OverallImage",n.OverallText="obf-OverallText",n.SingleLayout="obf-SingleLayout",n.ShowRightBorder="obf-ShowRightBorder",n.SlideLeft="obf-slideLeft",n.TextAlignLeft="obf-TextAlignLeft",n.FormContainer="obf-FormContainer",n.FormWideContainer="obf-FormWideContainer",n.ThanksPanelTitle="obf-ThanksPanelTitle",n.ThanksPanelMessage="obf-ThanksPanelMessage",n.FormQuestionMiddleText="obf-FormQuestionMiddleText",n.FormMiddleText="obf-FormMiddleText",n.FormCategoriesDropdown="obf-FormCategoriesDropdown",n.FormComment="obf-FormComment",n.FormRatingContainer="obf-FormRatingContainer",n.FormRatingLabel="obf-FormRatingLabel",n.FormRating="obf-FormRating",n.FormEmailContainer="obf-FormEmailContainer",n.FormEmailInput="obf-FormEmailInput",n.FormEmailTextBox="obf-FormEmailTextBox",n.FormEmailCheckBox="obf-FormEmailCheckBox",n.FormEmailLabel="obf-FormEmailLabel",n.FormBottomContainer="obf-FormBottomContainer",n.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",n.FormScreenshotContainer="obf-FormScreenshotContainer",n.FormScreenshotLabel="obf-FormScreenshotLabel",n.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",n.FormScreenshotPreview="obf-FormScreenshotPreview",n.TFormEmailCheckbox="obf-TFormEmailCheckbox",n.TFormEmailLabel="obf-TFormEmailLabel ",n.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",n.Toast="obf-Toast",n.ToastZoom="obf-ToastZoom",n}()),e=function(){function n(){}return n.CloseButton="obf-CloseButton",n.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",n.OverallAnchorsContainer="obf-OverallAnchorsContainer",n.OverallFrownAnchor="obf-OverallFrownAnchor",n.OverallFrownDiv="obf-OverallFrownDiv",n.OverallFrownImage="obf-OverallFrownImage",n.OverallFrownText="obf-OverallFrownText",n.OverallSmileAnchor="obf-OverallSmileAnchor",n.OverallSmileDiv="obf-OverallSmileDiv",n.OverallSmileImage="obf-OverallSmileImage",n.OverallSmileText="obf-OverallSmileText",n.OverallIdeaAnchor="obf-OverallIdeaAnchor",n.OverallIdeaDiv="obf-OverallIdeaDiv",n.OverallIdeaImage="obf-OverallIdeaImage",n.OverallIdeaText="obf-OverallIdeaText",n.OverallBugAnchor="obf-OverallBugAnchor",n.OverallBugDiv="obf-OverallBugDiv",n.OverallBugImage="obf-OverallBugImage",n.OverallBugText="obf-OverallBugText",n.QuestionLeftText="obf-QuestionLeftText",n.LeftFormContainer="obf-LeftFormContainer",n.LeftPanelContainer="obf-LeftPanelContainer",n.MainContainer="obf-MainContainer",n.MainContentHolder="obf-MainContentHolder",n.MiddleFormContainer="obf-MiddleFormContainer",n.OverlayBackground="obf-OverlayBackground",n.PrivacyStatementLink="obf-PrivacyStatementLink",n.FirstTabbable="obf-FirstTabbable",n.LastTabbable="obf-LastTabbable",n.EmailCheckBox="obf-EmailCheckBox",n.SingleFormContainer="obf-SingleFormContainer",n.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",n.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",n.SingleFormComment="obf-SingleFormComment",n.SingleFormEmailInput="obf-SingleFormEmailInput",n.SingleFormRating="obf-SingleFormRating",n.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",n.SingleFormScreenshotPreview="obf-SingleFormScreenshotPreview",n.SingleFormSubmitButton="obf-SingleFormSubmitButton",n.SingleFormCancelButton="obf-SingleFormCancelButton",n.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",n.BasicFormContainer="obf-BasicFormContainer",n.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",n.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",n.BasicFormComment="obf-BasicFormComment",n.BasicFormEmailInput="obf-BasicFormEmailInput",n.BasicFormRating="obf-BasicFormRating",n.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",n.BasicFormScreenshotPreview="obf-BasicFormScreenshotPreview",n.BasicFormSubmitButton="obf-BasicFormSubmitButton",n.BasicFormCancelButton="obf-BasicFormCancelButton",n.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",n.ThanksPanelContainer="obf-ThanksPanelContainer",n.ThanksPanelCloseButton="obf-ThanksPanelCloseButton",n.ThanksPanelDiscussion="obf-ThanksPanelDiscussion",n.ThanksPanelVerticalContainer="obf-ThanksPanelVerticalContainer",n.ThanksPanelInnerContainer="obf-ThanksPanelInnerContainer",n.UserVoiceFormContainer="obf-UserVoiceFormContainer",n.UserVoiceFormGoButton="obf-UserVoiceFormGoButton",n.FeedbackPortalIdeaContainer="obf-FeedbackPortalIdeaContainer",n.OverallFeedbackPortalIdeaAnchor="obf-OverallFeedbackPortalIdeaAnchor",n.ToastContainer="obf-ToastContainer",n.ToastCancel="obf-ToastCancel",n.TPromptContainer="obf-TPromptContainer",n.TPromptTitle="obf-TPromptTitle",n.TPromptText="obf-TPromptText",n.TFormContainer="obf-TFormContainer",n.TFormTitle="obf-TFormTitle",n.TFormRating="obf-TFormRating",n.TFormRatingQuestion="obf-TFormRatingQuestion",n.TFormComment="obf-TFormComment",n.TFormEmailTextBox="obf-TFormEmailTextBox",n.TFormEmailCheckBox="obf-TFormEmailCheckBox",n.TFormEmailLabel="obf-TFormEmailLabel",n.TFormSubmitButton="obf-TFormSubmitButton",n.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",n.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer",n}(),o=function(){function n(){}return n.Esc=27,n.Tab=9,n}(),s=function(){function n(){}return n.Anchor="A",n.Button="button",n.Defs="defs",n.Div="div",n.FieldSet="fieldset",n.Form="form",n.Img="img",n.Input="input",n.Label="label",n.Legend="legend",n.Option="option",n.Polygon="polygon",n.Select="select",n.Span="span",n.Svg="svg",n.TextArea="textarea",n.Use="use",n}(),h=function(){function n(){}return n.Button="Button",n}(),c=function(){function n(){}return n.PrivacyStatementLink="https://go.microsoft.com/fwlink/?LinkId=521839",n}(),l=function(){function n(){}return n.No="1",n.Yes="2",n}()},function(n,t,i){"use strict";function s(){return e}function h(n){if(r.h(n,"feedbackType"),n===f.b[f.b.Smile])return f.b.Smile;if(n===f.b[f.b.Frown])return f.b.Frown;if(n===f.b[f.b.Bug])return f.b.Bug;throw"feedbackType should be one of Smile, Frown or Bug";}var e;i.d(t,"get",function(){return s});i.d(t,"validateFeedbackType",function(){return h});var r=i(4),f=i(7),o=i(50),u=i(13);i.d(t,"AgeGroup",function(){return u.a});i.d(t,"AuthenticationType",function(){return u.b});i.d(t,"CustomResources",function(){return u.c});i(47);e=new(function(){function n(){}return n.validateCategoryOptions=function(n){var i,u,t;if(!n)return{show:!1};if(r.d(n.show,"categories.show"),n.customCategories)for(r.c(n.customCategories,"categories.customCategories"),i=0,u=n.customCategories;i<u.length;i++)if(t=u[i],r.h(t,"custom category '"+t+"'"),t.length>20)throw"custom category '"+t+"' too long, max 20 characters.";return n},n.prototype.getCommonInitOptions=function(){return this.commonInitOptions},n.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions},n.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions},n.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions},n.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey},n.prototype.getSdkSessionId=function(){return this.sdkSessionId||(this.sdkSessionId=r.i()),this.sdkSessionId},n.prototype.getEventSampling=function(){return this.eventSampling},n.prototype.setCommonInitOptions=function(n){var t,i,f;if(r.g(n,"passedInitOptions"),t={appId:n.appId,applicationGroup:n.applicationGroup||{},build:n.build,cid:n.cid,environment:n.environment,intlFilename:n.intlFilename,intlUrl:n.intlUrl,webSurfacesResourceBaseUrl:n.webSurfacesResourceBaseUrl,locale:n.locale,onError:n.onError,originalLocale:n.locale,primaryColour:n.primaryColour,secondaryColour:n.secondaryColour,sessionId:n.sessionId,stylesUrl:n.stylesUrl,telemetryGroup:n.telemetryGroup||{},userEmail:n.userEmail,userEmailConsentDefault:n.userEmailConsentDefault,webGroup:n.webGroup||{},eventSampling:n.eventSampling,petrolTimeout:n.petrolTimeout,isCommercialHost:n.isCommercialHost,customResourcesSetExternally:n.customResourcesSetExternally,emailPolicyValue:n.emailPolicyValue,screenshotPolicyValue:n.screenshotPolicyValue,ageGroup:n.ageGroup,authenticationType:n.authenticationType,applicationSettings:n.applicationSettings,webSurfacesSettings:n.webSurfacesSettings},r.f(t.appId,"initOptions.appId"),!(t.appId%1==0&&t.appId>0))throw"initOptions.appId is not a positive integer: "+t.appId;if(i=u.c.Strings|u.c.Css,void 0===t.customResourcesSetExternally)t.customResourcesSetExternally=u.c.None;else if("number"!=typeof t.customResourcesSetExternally||(t.customResourcesSetExternally|i)!==i)throw"initOptions.customResourcesSetExternally has an invalid value: "+t.customResourcesSetExternally;if((t.customResourcesSetExternally&u.c.Css)!==u.c.Css&&r.h(t.stylesUrl,"initOptions.stylesUrl"),(t.customResourcesSetExternally&u.c.Strings)!==u.c.Strings&&r.h(t.intlUrl,"initOptions.intlUrl"),void 0!==t.intlFilename?r.h(t.intlFilename,"initOptions.intlFilename"):t.intlFilename="officebrowserfeedbackstrings.js",r.f(t.environment,"initOptions.environment"),1!==t.environment&&0!==t.environment)throw"initOptions.environment has a bad value: "+t.environment;if((void 0!==t.userEmail?r.h(t.userEmail,"initOptions.userEmail"):t.userEmail="",void 0!==t.userEmailConsentDefault&&r.d(t.userEmailConsentDefault,"initOptions.userEmailConsentDefault"),void 0!==t.sessionId?r.h(t.sessionId,"initOptions.sessionId"):t.sessionId="00000000-0000-0000-0000-000000000000",t.telemetryGroup.processSessionId=t.sessionId,void 0!==t.cid&&(r.h(t.cid,"initOptions.cid"),t.applicationGroup.extendedManifestData=JSON.stringify({cid:t.cid})),void 0!==t.build)?(r.h(t.build,"initOptions.build"),new RegExp("^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$").test(t.build)||(t.build="0.0.0.0")):t.build="0.0.0.0",t.telemetryGroup.officeBuild=t.build,f=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i"),void 0!==t.primaryColour&&(f.test(t.primaryColour)||(t.primaryColour=void 0)),void 0!==t.secondaryColour&&(f.test(t.secondaryColour)||(t.secondaryColour=void 0)),void 0!==t.locale?(r.h(t.locale,"initOptions.locale"),t.locale=o.a(t.locale)):t.locale="en",void 0===t.onError&&(t.onError=function(){}),void 0!==t.petrolTimeout&&r.f(t.petrolTimeout,"initOptions.petrolTimeout"),void 0!==t.authenticationType?r.e(t.authenticationType,u.b,"initOptions.authenticationType"):t.authenticationType=u.b.Unauthenticated,void 0!==t.ageGroup?r.e(t.ageGroup,u.a,"initOptions.ageGroup"):t.ageGroup=u.a.Undefined,this.eventSampling=this.parseEventSamplingOption(t.eventSampling),this.commonInitOptions=t,this.commonPolicyAllowAADC=this.determineAADCPolicy(t.authenticationType,t.ageGroup),void 0===t.isCommercialHost||null==t.isCommercialHost?t.isCommercialHost=!1:r.d(t.isCommercialHost,"initOptions.isCommercialHost"),void 0===t.emailPolicyValue)t.emailPolicyValue=0;else if("number"!=typeof t.emailPolicyValue||0!==t.emailPolicyValue&&1!==t.emailPolicyValue&&2!==t.emailPolicyValue)throw"initOptions.emailPolicyValue has an invalid value: "+t.emailPolicyValue;if(void 0===t.screenshotPolicyValue)t.screenshotPolicyValue=0;else if("number"!=typeof t.screenshotPolicyValue||0!==t.screenshotPolicyValue&&1!==t.screenshotPolicyValue&&2!==t.screenshotPolicyValue)throw"initOptions.screenshotPolicyValue has an invalid value: "+t.screenshotPolicyValue;},n.prototype.setInAppFeedbackInitOptions=function(n){r.g(n,"passedInitOptions");var t={bugForm:n.bugForm,onDismiss:n.onDismiss,screenshot:n.screenshot,showEmailAddress:n.showEmailAddress,userEmail:n.userEmail,userVoice:void 0!==n.userVoice?{url:n.userVoice.url}:void 0,transitionEnabled:n.transitionEnabled,isShowThanks:n.isShowThanks,sendFeedbackPolicyValue:n.sendFeedbackPolicyValue,feedbackForumUrl:void 0!==n.feedbackForumUrl?n.feedbackForumUrl:void 0};if(void 0===t.onDismiss&&(t.onDismiss=function(){}),void 0!==t.bugForm?r.d(t.bugForm,"initOptions.bugForm"):t.bugForm=!1,void 0!==t.userEmail&&r.h(t.userEmail,"initOptions.userEmail"),void 0!==t.screenshot?r.d(t.screenshot,"initOptions.screenshot"):t.screenshot=!0,void 0!==t.showEmailAddress?r.d(t.showEmailAddress,"initOptions.showEmailAddress"):t.showEmailAddress=!0,void 0!==t.userVoice&&(r.g(t.userVoice,"initOptions.userVoice"),r.h(t.userVoice.url,"initOptions.userVoice.url")),void 0!==t.feedbackForumUrl?r.h(t.feedbackForumUrl,"initOptions.feedbackForumUrl"):t.feedbackForumUrl=void 0,void 0!==t.isShowThanks?r.d(t.isShowThanks,"initOptions.isShowThanks"):t.isShowThanks=!1,void 0===t.transitionEnabled&&(t.transitionEnabled=!0),void 0===t.sendFeedbackPolicyValue)t.sendFeedbackPolicyValue=0;else if("number"!=typeof t.sendFeedbackPolicyValue||0!==t.sendFeedbackPolicyValue&&1!==t.sendFeedbackPolicyValue&&2!==t.sendFeedbackPolicyValue)throw"initOptions.sendFeedbackPolicyValue has an invalid value: "+t.sendFeedbackPolicyValue;this.inAppFeedbackInitOptions=t},n.prototype.setInAppFeedbackLaunchOptions=function(t){if(!this.commonInitOptions)throw"commonInitOptions not set";t||(t={});this.commonInitOptions.applicationGroup=r.m(t.applicationGroup,this.commonInitOptions.applicationGroup);this.commonInitOptions.telemetryGroup=r.m(t.telemetryGroup,this.commonInitOptions.telemetryGroup);this.commonInitOptions.webGroup=r.m(t.webGroup,this.commonInitOptions.webGroup);t.categories=n.validateCategoryOptions(t.categories);this.inAppFeedbackLaunchOptions=t},n.prototype.setFloodgateInitOptions=function(n){r.g(n,"passedInitOptions");var t={autoDismiss:n.autoDismiss,campaignDefinitions:n.campaignDefinitions,campaignFlights:n.campaignFlights,campaignQueryParameters:n.campaignQueryParameters,onDismiss:n.onDismiss,onSurveyActivatedCallback:n.onSurveyActivatedCallback,settingStorageCallback:n.settingStorageCallback,uIStringGetter:n.uIStringGetter,authTokenCallback:n.authTokenCallback,surveyEnabled:n.surveyEnabled,showEmailAddress:n.showEmailAddress,augLoopCallback:n.augLoopCallback,customerVoiceSurveyParams:n.customerVoiceSurveyParams,governanceServiceEnabled:n.governanceServiceEnabled,governanceServiceConfig:n.governanceServiceConfig,personalizerEnabled:n.personalizerEnabled};(void 0===t.autoDismiss&&(t.autoDismiss=0),void 0===t.onDismiss&&(t.onDismiss=function(){}),void 0===t.onSurveyActivatedCallback)&&(t.onSurveyActivatedCallback={onSurveyActivated:function(n){n.launch()}});void 0===t.uIStringGetter&&(t.uIStringGetter=function(n){return n});void 0===t.surveyEnabled?t.surveyEnabled=!0:r.d(t.surveyEnabled,"surveyEnabled");void 0!==t.showEmailAddress?r.d(t.showEmailAddress,"initOptionsFloodgate.showEmailAddress"):t.showEmailAddress=!0;void 0!==t.governanceServiceEnabled?r.d(t.governanceServiceEnabled,"initOptionsFloodgate.governanceServiceEnable"):t.governanceServiceEnabled=!1;t.governanceServiceEnabled&&(t.governanceServiceConfig=this.parseGovernanceServiceConfig(void 0!==t.governanceServiceConfig?t.governanceServiceConfig:{}));void 0===t.customerVoiceSurveyParams&&(t.customerVoiceSurveyParams={cvFlights:"",isCVSurveyEnabled:!1,productName:"",uiHost:""});void 0!==t.personalizerEnabled?r.d(t.personalizerEnabled,"initOptionsFloodgate.personalizerEnabled"):t.personalizerEnabled=!1;this.floodgateInitOptions=t},n.prototype.setFloodgateSurvey=function(n){this.floodgateSurvey=n},n.prototype.checkIfSurveysEnabled=function(){return(!this.floodgateInitOptions||this.floodgateInitOptions.surveyEnabled)&&this.commonPolicyAllowAADC},n.prototype.isFeedbackSurveyEnabledByAADC=function(){return this.commonPolicyAllowAADC},n.prototype.getCVSurveyFlights=function(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.cvFlights:""},n.prototype.isCVSurveyEnabled=function(){return!(!this.floodgateInitOptions||!this.floodgateInitOptions.customerVoiceSurveyParams)&&this.floodgateInitOptions.customerVoiceSurveyParams.isCVSurveyEnabled},n.prototype.getProductName=function(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.productName:""},n.prototype.getUIHost=function(){return this.floodgateInitOptions&&this.floodgateInitOptions.customerVoiceSurveyParams?this.floodgateInitOptions.customerVoiceSurveyParams.uiHost:""},n.prototype.determineAADCPolicy=function(n,t){return n===u.b.Unauthenticated||n===u.b.AAD||t!==u.a.MinorWithParentalConsent&&t!==u.a.MinorWithoutParentalConsent},n.prototype.getUserConsentGroup=function(){var n=this.commonInitOptions.authenticationType;if(n===u.b.Unauthenticated||n===u.b.AAD)return 1;switch(this.commonInitOptions.ageGroup){case u.a.Undefined:return 1;case u.a.MinorWithoutParentalConsent:case u.a.MinorWithParentalConsent:return 3;case u.a.Adult:return 1;case u.a.NotAdult:return 2;case u.a.MinorNoParentalConsentRequired:return 1;default:return 3}return 3},n.prototype.parseEventSamplingOption=function(n){var u={event:{}},t,i;if(void 0!==n)for(t in n)if(n.hasOwnProperty(t))switch(n[t].type){case"Event":if(i=n[t].sampleRate,r.f(i,"initOption.EventSampling.SampleRate"),r.h(n[t].name,"initOption.EventSampling.Name"),i<0||i>1)throw"initOption.EventSampling."+n[t].name+".SampleRate is out of range";u.event[n[t].name]=i;break;default:throw"initOption.EventSampling.Type value is not recognized";}return u},n.prototype.parseGovernanceServiceConfig=function(n){var t,i,r,u;return{forceServicelessSurveyDisplay:null!==(t=n.forceServicelessSurveyDisplay)&&void 0!==t&&t,retry:null!==(i=n.retry)&&void 0!==i?i:1,timeout:null!==(r=n.timeout)&&void 0!==r?r:1e3,simpleRequestEnabled:null!==(u=n.simpleRequestEnabled)&&void 0!==u&&u}},n}())},function(n,t,i){"use strict";function u(){return d.AWT}function ut(n,t,i,r,u){var o=n.telemetryGroup?n.telemetryGroup:{},v=n.webGroup?n.webGroup:{};f=new s(nt.create(h.getTenantToken(n.environment),"Office_Feedback",new c(t,i),new l(r),new a(n.appId.toString(),n.originalLocale,n.sessionId,n.build),new y(o.audienceGroup),new p(v.browser,v.browserVersion),new w(o.deviceId),new b(o.loggableUserId?o.loggableUserId:n.cid,o.tenantId)),u,n);e=n.environment}function ft(){return f}var s,h;i.d(t,"a",function(){return it});i.d(t,"c",function(){return ut});i.d(t,"b",function(){return ft});var c=function(){function n(n,t){if(!n)throw new Error("name must not be null");if(!t)throw new Error("version must not be null");this.name=n;this.version=t}return n.prototype.getName=function(){return this.name},n.prototype.getPlatform=function(){return n.PLATFORM},n.prototype.getVersion=function(){return this.version},n.PLATFORM="Web",n}(),l=function(){function n(n){if(!n)throw new Error("id must not be null");this.id=n}return n.prototype.getId=function(){return this.id},n}(),a=function(){function n(n,t,i,r){this.id=n;this.locale=t;this.sessionId=i;this.version=r}return n.prototype.getId=function(){return this.id},n.prototype.getLocale=function(){return this.locale},n.prototype.getSessionId=function(){return this.sessionId},n.prototype.getVersion=function(){return this.version},n}(),v=function(){function n(t,i,r,u){if(!t)throw new Error("name must not be null");if(!i)throw new Error("sessionId must not be null");if(!r&&0!==r||r<0)throw new Error("sequence must not be negative");this.name=t;this.id=i+n.ID_DELIMITER+r;this.sequence=r;this.sampleRate=u}return n.prototype.getName=function(){return this.name},n.prototype.getId=function(){return this.id},n.prototype.getSource=function(){return n.SOURCE},n.prototype.getSchemaVersion=function(){return n.SCHEMA_VERSION},n.prototype.getSequence=function(){return this.sequence},n.prototype.getSampleRate=function(){return this.sampleRate},n.ID_DELIMITER=".",n.SOURCE="MsoThin",n.SCHEMA_VERSION=1,n}(),y=function(){function n(n){this.audienceGroup=n}return n.prototype.getAudienceGroup=function(){return this.audienceGroup},n}(),p=function(){function n(n,t){this.name=n;this.version=t}return n.prototype.getName=function(){return this.name},n.prototype.getVersion=function(){return this.version},n}(),w=function(){function n(n){this.id=n}return n.prototype.getId=function(){return this.id},n}(),b=function(){function n(n,t){this.tenantId=t;this.primaryIdentityHash=n?n.trim():n;this.primaryIdentitySpace=this.generatePrimaryIdentitySpace()}return n.prototype.getTenantId=function(){return this.tenantId},n.prototype.getPrimaryIdentityHash=function(){return this.primaryIdentityHash},n.prototype.getPrimaryIdentitySpace=function(){return this.primaryIdentitySpace},n.prototype.generatePrimaryIdentitySpace=function(){if(this.primaryIdentityHash){if(this.primaryIdentityHash.startsWith("a:"))return"UserObjectId";if(this.primaryIdentityHash.startsWith("p:"))return"MsaPuid";if(this.primaryIdentityHash.startsWith("ap:"))return"OrgIdPuid"}},n}(),k=i(4),d=i(78);var f,e,g=function(){function n(n,t,i,r,f,e,o,s,h){if(!n)throw new Error("tenantToken must not be null");if(!t)throw new Error("namespace must not be null");if(!i)throw new Error("app must not be null");if(!r)throw new Error("session must not be null");u().initialize(n);this.namespace=t;this.oesApp=i;this.oesSession=r;this.oesHost=f;this.oesRelease=e;this.oesBrowser=o;this.oesDevice=s;this.oesUser=h;this.sequence=1}return n.setApp=function(n,t){n["App.Name"]=t.getName();n["App.Platform"]=t.getPlatform();n["App.Version"]=t.getVersion()},n.setSession=function(n,t){n["Session.Id"]=t.getId()},n.setHost=function(n,t){t&&(n["Host.Id"]=t.getId(),n["Host.SessionId2"]=t.getSessionId(),n["Host.Version"]=t.getVersion(),n["Host.Locale"]=t.getLocale())},n.setEvent=function(n,t){n["Event.Name"]=t.getName();n["Event.Id"]=t.getId();n["Event.Source"]=t.getSource();n["Event.SchemaVersion"]=t.getSchemaVersion();n["Event.Sequence"]=t.getSequence();n["Event.SampleRate"]=t.getSampleRate()},n.setRelease=function(n,t){t&&(n["Release.AudienceGroup"]=t.getAudienceGroup())},n.setBrowser=function(n,t){t&&(n["Browser.Name"]=t.getName(),n["Browser.Version"]=t.getVersion())},n.setDevice=function(n,t){t&&(n["Device.Id"]=t.getId())},n.setUser=function(n,t){t&&(n["User.PrimaryIdentityHash"]=t.getPrimaryIdentityHash(),n["User.PrimaryIdentitySpace"]=t.getPrimaryIdentitySpace(),n["User.TenantId"]=t.getTenantId())},n.prototype.logEvent=function(t,i,r){var o,f,e;if(void 0===r&&(r=1),!t)throw new Error("eventName must not be null");if(o=new v(this.namespace+n.EVENT_NAME_DELIMITER+t,this.oesSession.getId(),this.sequence,r),f={},null!=i)for(e in i)i.hasOwnProperty(e)&&(f[n.CUSTOM_PROPERTIES_FIELD_PREFIX+e]=i[e]);n.setApp(f,this.oesApp);n.setSession(f,this.oesSession);n.setHost(f,this.oesHost);n.setRelease(f,this.oesRelease);n.setEvent(f,o);n.setBrowser(f,this.oesBrowser);n.setDevice(f,this.oesDevice);n.setUser(f,this.oesUser);u().logEvent({name:o.getName(),properties:f});this.sequence++},n.EVENT_NAME_DELIMITER="_",n.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.",n}(),nt=function(){function n(){}return n.create=function(n,t,i,r,u,f,e,o,s){return new g(n,t,i,r,u,f,e,o,s)},n}(),o=i(15),tt=i(14),it=function(){function n(){}var v,i,y,p,r,w,b,u,f,k,d,e,o,g,nt,tt,it,rt,ut,s,h,ft,et,ot,st,t,c,ht,ct,lt,at,vt,yt,l,pt,wt,bt,kt,a,dt,gt;return n.InApp=((v=function(){}).UI=((i=function(){}).Picker=((y=function(){}).Shown=((p=function(){}).VALUE={name:"InApp_UI_Picker_Shown"},p),y),i.Form=((r=function(){}).Shown=((w=function(){}).VALUE={name:"InApp_UI_Form_Shown"},w),r.Submit=((b=function(){}).VALUE={name:"InApp_UI_Form_Submit"},b),r),i),v),n.SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED={name:"Survey_Floodgate_CampaignLoad_Failed"},n.SURVEY_FLOODGATE_FILEREAD_FAILED={name:"Survey_Floodgate_FileRead_Failed"},n.SURVEY_FLOODGATE_FILEWRITE_FAILED={name:"Survey_Floodgate_FileWrite_Failed"},n.SURVEY_FLOODGATE_TRIGGERMET={name:"Survey_Floodgate_TriggerMet"},n.SURVEY_FLOODGATE_USERSELECTED={name:"Survey_Floodgate_UserSelected"},n.SURVEY_UI_FORM_SHOWN={name:"Survey_UI_Form_Shown"},n.SURVEY_UI_FORM_SUBMIT={name:"Survey_UI_Form_Submit"},n.SURVEY_UI_FORM_SECONDARY_SUBMIT={name:"Survey_UI_Form_Secondary_Submit"},n.SURVEY_UI_FORM_SUBMIT_ERROR={name:"Survey_UI_Form_Submit_Error"},n.SURVEY_UI_FORM_USERCLOSED={name:"Survey_UI_Form_UserClosed"},n.SURVEY_UI_FORM_NO_RETURN_TYPE={name:"Survey_UI_Form_No_Return_Type"},n.SURVEY_UI_PROMPT_AUTODISMISSED={name:"Survey_UI_Prompt_AutoDismissed"},n.SURVEY_UI_PROMPT_SHOWN={name:"Survey_UI_Prompt_Shown"},n.SURVEY_UI_PROMPT_USERCLOSED={name:"Survey_UI_Prompt_UserClosed"},n.SURVEY_UI_PROMPT_CLICKED={name:"Survey_UI_Prompt_Clicked"},n.SURVEY_UI_REDIRECTIONFAILURE={name:"Survey_UI_RedirectionFailure"},n.GOVERNANCE_SERVICEFAILURE={name:"Gorvenance_ServiceFailure"},n.GOVERNANCE_SERVICERESULT={name:"Gorvenance_ServiceResult"},n.DYNAMICTRANSPORT_POST_ERROR={name:"DynamicTransport_Post_Error"},n.FEEDBACK_SURVEYSDISABLED_AADC={name:"Feedback_SurveysDisabled_AADC"},n.SURVEY_UI_DISABLED_AADC={name:"Survey_UI_Prevented_AADC"},n.PERSONALIZER_SERVICEREWARDRESULT={name:"Personalizer_ServiceRewardResult"},n.PERSONALIZER_CLIENTFAILURE={name:"Personalizer_ClientFailure"},n.Shared=((u=function(){}).Upload=((f=function(){}).Failed=((k=function(){}).VALUE={name:"Shared_Upload_Failed"},k),f.Prevented=((d=function(){}).VALUE={name:"Shared_Upload_Prevented_AADC"},d),f),u.Screenshot=((e=function(){}).Render=((o=function(){}).Failed=((g=function(){}).VALUE={name:"Shared_Screenshot_Render_Failed"},g),o.Success=((nt=function(){}).VALUE={name:"Shared_Screenshot_Render_Success"},nt),o),e.GetContent=((tt=function(){}).Failed=((it=function(){}).DefaultImage=((rt=function(){}).Returned=((ut=function(){}).VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},ut),rt),it),tt),e),u),n.WebSurfaces=((s=function(){}).Common=((h=function(){}).Error=((ft=function(){}).VALUE={name:"WebSurfaces_Common_Error"},ft),h.Info=((et=function(){}).VALUE={name:"WebSurfaces_Common_Info"},et),h),s.Messaging=((ot=function(){}).Requests=((st=function(){}).VALUE={name:"WebSurfaces_Messaging_Requests"},st),ot),s),n.UserFacts=((t=function(){}).Common=((c=function(){}).Error=((ht=function(){}).VALUE={name:"UserFacts_Common_Error"},ht),c.Info=((ct=function(){}).VALUE={name:"UserFacts_Common_Info"},ct),c),t.LocalFact=((lt=function(){}).Error=((at=function(){}).VALUE={name:"UserFacts_LocalFact_Error"},at),lt),t.Messaging=((vt=function(){}).Requests=((yt=function(){}).VALUE={name:"UserFacts_Messaging_Requests"},yt),vt),t.AugLoop=((l=function(){}).Requests=((pt=function(){}).VALUE={name:"UserFacts_AugLoop_Requests"},pt),l.Error=((wt=function(){}).VALUE={name:"UserFacts_AugLoop_Error"},wt),l),t.Provider=((bt=function(){}).Info=((kt=function(){}).VALUE={name:"UserFacts_Provider_Summary"},kt),bt),t),n.Common=((a=function(){}).Error=((dt=function(){}).VALUE={name:"Common_Error"},dt),a.Info=((gt=function(){}).VALUE={name:"Common_Info"},gt),a),n}(),rt=i(12),r=k.l;s=function(){function n(n,t,i){if(this.SAMPLING_RESULT=Math.random(),!n)throw new Error("telemetryLogger must not be null");this.telemetryLogger=n;this.eventSampling=t;this.initOptionsCommon=i}return n.prototype.logEvent=function(t,i,u,f){if(!t)throw new Error("eventId must not be null");var o=n.DEFAULT_SAMPLE_RATE;return(this.isEventSampled(t.name)?o=this.getEventSamplingRate(t.name):void 0!==f&&(o=f),r(i)||0===i)?(0===e&&(this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",n.EVENT_NAME,"logSeverity must not be null or none"),this.telemetryLogger.logEvent(n.EVENT_NAME,{ErrorMessage:"logSeverity must not be null or none"},o)),!1):((u=u||{})[n.EVENT_ID]=t.name,(this.isLoggingEnabled(i,o)||this.isEventTelemetryEnabled(t.name))&&this.telemetryLogger.logEvent(n.EVENT_NAME,u,o),this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",n.EVENT_NAME,i,u),!0)},n.prototype.logLocal=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this.isLoggingEnabled(n)&&this.isConsoleLogEnabled&&console&&console.log("LPP FG: ",n,i)},n.prototype.getUserSamplingRate=function(){return this.SAMPLING_RESULT},n.prototype.isEventTelemetryEnabled=function(n){var i,r,u,f;try{if(!this.dynamicLogSettings)return!1;var e=null===(r=null===(i=this.initOptionsCommon)||void 0===i?void 0:i.appId)||void 0===r?void 0:r.toString(),o=null===(f=null===(u=this.initOptionsCommon)||void 0===u?void 0:u.originalLocale)||void 0===f?void 0:f.toLowerCase(),t="content_"+n,s=this.dynamicLogSettings[t+"_"+e+"_"+o]||this.dynamicLogSettings[t+"_"+e]||this.dynamicLogSettings[t+"_"+o]||this.dynamicLogSettings[t];return null==s?void 0:s.isEnabled}catch(n){this.isConsoleLogEnabled&&console.log("FG: Error checking for dynamic log settings: ",n)}return!1},n.prototype.isLoggingEnabled=function(n,t){if(void 0===t&&(t=1),r(this.logLevel)){var i=this.getCurrentLogLevel();this.logLevel=r(i)?2:i}return n<=this.logLevel&&this.SAMPLING_RESULT<=t&&0!==t},n.prototype.getCurrentLogLevel=function(){var t,f,e,s,i,n,u,h,c;try{if(t="undefined"!=typeof URLSearchParams&&new URLSearchParams(window.location.search)||void 0,f=t&&t.get("obfconsolelog"),f||(e="undefined"!=typeof document&&document.referrer,f=e&&-1!==e.indexOf("obfconsolelog")),f&&(this.isConsoleLogEnabled=!0),s=t&&t.get("obfloglevel"),!r(s))return this.isConsoleLogEnabled=!0,parseInt(s,10);if(o.a.isStorageAvailable()&&(i=(new o.a).read(tt.FileType.LogLevelSettings),i||(i=Object(rt.a)("LogLevelSettings","")),n=i&&this.parseObject(i),n&&(this.dynamicLogSettings=n,u=n.content,this.initOptionsCommon&&(h=this.initOptionsCommon.appId&&this.initOptionsCommon.appId.toString(),c=this.initOptionsCommon.originalLocale&&this.initOptionsCommon.originalLocale.toLowerCase(),u=n["content_"+h+"_"+c]||n["content_"+h]||n["content_"+c]||n.content),u)))return u.consoleLog&&(this.isConsoleLogEnabled=!0),u.logLevel}catch(t){return void(this.isConsoleLogEnabled&&console.log("Error while getting the current log level: ",t))}return null},n.prototype.parseObject=function(n){try{return JSON.parse(n)}catch(n){return this.isConsoleLogEnabled&&console.log("Error while parsing the json string for log level: ",n),null}},n.prototype.getEventSamplingRate=function(n){var t=1;return this.eventSampling.event&&n in this.eventSampling.event&&(t=this.eventSampling.event[n]),t},n.prototype.isEventSampled=function(n){return!(!this.eventSampling.event||!(n in this.eventSampling.event))},n.EVENT_NAME="SDK",n.EVENT_ID="EventId",n.DEFAULT_SAMPLE_RATE=1,n}();h=function(){function n(){}return n.getTenantToken=function(t){return 0===t?n.TENANT_TOKEN_PRODUCTION:n.TENANT_TOKEN_PRE_PRODUCTION},n.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",n.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736",n}()},function(n,t,i){"use strict";function f(n,t){s(n,t?r.c.Hidden:r.c.Visible,t?r.c.Visible:r.c.Hidden)}function l(n){var t=document.getElementById(n);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)}function o(n,t){var i=document.getElementById(n);i&&(i.className.match(new RegExp("\\b"+t+"\\b"))||(i.className=i.className+" "+t))}function s(n,t,i){!function(n,t){var i=document.getElementById(n);i&&(i.className=i.className.split(new RegExp("\\b"+t+"\\b","i")).join(" "),i.className=i.className.split(/\s+/).join(" "))}(n,t);o(n,i)}function a(n,t,i){var r=document.getElementById(n);r&&r.setAttribute(t,i)}function e(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)}function h(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)}function v(n,t,i){var r=document.getElementById(n);r&&e(r,t,i)}function y(n,t,i){n&&e(n,t,i)}function p(n,t,i){var r=document.getElementById(n);r&&h(r,t,i)}function w(){var n=-1,t=window.navigator.userAgent;return t.indexOf("Trident")>-1&&null!=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})").exec(t)&&(n=parseFloat(RegExp.$1),n+=4),n}function b(){return"rtl"===getComputedStyle(document.documentElement).direction}function k(n,t){var r=document.getElementById(n),e=r&&r.checked,o=document.getElementById(t),i;e?(f(t,!0),i=performance.now(),c.a(document.body).then(function(n){var t=performance.now();u.b().logEvent(u.a.Shared.Screenshot.Render.Success.VALUE,1,{TimeMilliseconds:t-i});o.src=n.toDataURL()}).catch(function(n){var t=performance.now();u.b().logEvent(u.a.Shared.Screenshot.Render.Failed.VALUE,2,{ErrorMessage:n,TimeMilliseconds:t-i})})):f(t,!1)}i.d(t,"l",function(){return f});i.d(t,"d",function(){return l});i.d(t,"b",function(){return o});i.d(t,"j",function(){return s});i.d(t,"k",function(){return a});i.d(t,"c",function(){return e});i.d(t,"i",function(){return h});i.d(t,"g",function(){return v});i.d(t,"h",function(){return y});i.d(t,"m",function(){return p});i.d(t,"e",function(){return w});i.d(t,"f",function(){return b});i.d(t,"a",function(){return k});var r=i(0),c=i(25),u=i(2)},function(n,t,i){"use strict";function e(n){return"number"==typeof n}function a(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n}function v(n,t){if(!c(n))throw t+" is not an object: "+n;}function y(n,t){if(!e(n))throw t+" is not a number: "+n;}function p(n,t){if(!h(n))throw t+" is not a string: "+n;}function w(n,t){if(!f(n))throw t+" is not a boolean: "+n;}function b(n,t){if(!Array.isArray(n))throw t+" is not an array: "+n;}function k(n,t,i){if(!e(n)||!l(n,t))throw i+" is not an enum: "+n;}function d(n,t){var i=new Promise(function(t,i){var r=setTimeout(function(){clearTimeout(r);i("Timed out in "+n+"ms.")},n)});return Promise.race([t,i])}function g(n){var t,r,i,f;try{for(t=0;t<document.styleSheets.length;t++)for(r=document.styleSheets[t],i=0;i<r.rules.length;i++)if(f=r.rules[i],!u(f.selectorText)&&f.selectorText.includes(n))return!0}catch(n){}return!1}i.d(t,"i",function(){return o});i.d(t,"m",function(){return s});i.d(t,"l",function(){return u});i.d(t,"j",function(){return f});i.d(t,"k",function(){return a});i.d(t,"g",function(){return v});i.d(t,"f",function(){return y});i.d(t,"h",function(){return p});i.d(t,"d",function(){return w});i.d(t,"c",function(){return b});i.d(t,"e",function(){return k});i.d(t,"b",function(){return d});i.d(t,"a",function(){return g});var r=i(9),o=r.Utils.guid,s=r.Utils.overrideValues,u=r.Utils.isNOU,f=r.Utils.isBoolean,h=r.Utils.isString,c=r.Utils.isObject,l=r.Utils.isEnumValue},function(n,t,i){"use strict";function u(n){r=n}function f(){return r}var r;i.d(t,"b",function(){return u});i.d(t,"a",function(){return f})},function(n,t,i){"use strict";function f(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function e(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){var t;n.done?u(n.value):(t=n.value,t instanceof i?t:new i(function(n){n(t)})).then(o,s)}e((r=r.apply(n,t||[])).next())})}function o(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==e[0]&&2!==e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e}var r,u;i.d(t,"c",function(){return f});i.d(t,"a",function(){return u});i.d(t,"b",function(){return e});i.d(t,"d",function(){return o});r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)};u=function(){return(u=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n}).apply(this,arguments)}},function(n,t,i){"use strict";var r,u,f,e,o;i.d(t,"d",function(){return u});i.d(t,"e",function(){return f});i.d(t,"b",function(){return r});i.d(t,"a",function(){return e});i.d(t,"c",function(){return o});u="customervoice";f="Customer Voice Survey UX";!function(n){n[n.Smile=0]="Smile";n[n.Frown=1]="Frown";n[n.Idea=2]="Idea";n[n.Bug=3]="Bug";n[n.IdeaRedirect=4]="IdeaRedirect"}(r||(r={}));e=function(){function n(){}return n.WebSurfacesIntLink="https://content.growth.office.net/mirrored/resources/programmablesurfaces/int/officewebsurfaces.core.min.js",n.WebSurfacesProdLink="https://content.growth.office.net/mirrored/resources/programmablesurfaces/prod/officewebsurfaces.core.min.js",n}();o=function(){function n(){}return n.TMSAppID="4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed",n.TULIPSAppID="05c88d91-956e-46b4-91b0-77a33cc21a4d",n}()},function(n,t,i){"use strict";function e(){return f}function o(){return f}function s(n){r.setUiStrings=n}function h(n){r.singleFeedback=n}function c(n){r.multiFeedback=n}function l(n){r.getFeedbackStatus=n}function a(n){r.createScreenshot=n}function v(n){r.isFeedbackSurveyEnabledByAADC=n}function y(n){u.showSurvey=n}function p(n){u.showCustomSurvey=n}function w(n){u.initialize=n}function b(n){u.start=n}function k(n){u.stop=n}function d(n){u.getEngine=n}function g(n){u.getSettingIdMap=n}i.d(t,"a",function(){return e});i.d(t,"b",function(){return o});i.d(t,"n",function(){return s});i.d(t,"o",function(){return h});i.d(t,"m",function(){return c});i.d(t,"e",function(){return l});i.d(t,"d",function(){return a});i.d(t,"l",function(){return v});i.d(t,"i",function(){return y});i.d(t,"h",function(){return p});i.d(t,"g",function(){return w});i.d(t,"j",function(){return b});i.d(t,"k",function(){return k});i.d(t,"f",function(){return d});i.d(t,"c",function(){return g});var f=window,r=f.OfficeBrowserFeedback=f.OfficeBrowserFeedback||{},u=r.floodgate=r.floodgate||{}},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.Utils=t.Api=void 0;r=i(11);t.Api=r;u=i(10);t.Utils=u;f=i(20);Object.defineProperty(t,"FloodgateEngine",{enumerable:!0,get:function(){return f.FloodgateEngine}})},function(n,t){"use strict";function u(n){return"[object Date]"===Object.prototype.toString.call(n)&&!isNaN(n.getTime())}function f(n){return null==n}function r(n){return"string"==typeof n}function e(n,i){if(!n)return null;if(i<0)return i=-i,this.addSecondsWithoutOverflow(n,i);var r=n.getTime()-1e3*i;return r>t.MIN_DATE_MILLISECONDS?new Date(r):new Date(t.MIN_DATE_MILLISECONDS)}function o(n){if(!n)return null;var t=n.match("^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$");return!t||t.length<1||!f(t[4])?null:t[0]}function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}Object.defineProperty(t,"__esModule",{value:!0});t.safeParseObject=t.isValidUserId=t.fyShuffle=t.dateToShortUtcString=t.isUtcDatetimeString=t.overrideValues=t.stringToDate=t.makeArrayFromObjectValuesSortedByKeyString=t.guid=t.extractLanguageSubtag=t.isValidLanguageSubTag=t.subtractSecondsWithoutOverflow=t.addSecondsWithoutOverflow=t.MIN_DATE_MILLISECONDS=t.MAX_DATE_MILLISECONDS=t.getDistantFuture=t.getDistantPast=t.isBoolean=t.isString=t.isArray=t.isFunction=t.isObject=t.isNOU=t.isNumber=t.isEnumValue=t.isDate=t.timeAdd=void 0;t.timeAdd=function(n,t,i){switch(t.toLowerCase()){case"h":case"hour":return new Date(n.getTime()+36e5*i);case"m":case"minute":return new Date(n.getTime()+6e4*i);case"s":case"second":return new Date(n.getTime()+1e3*i);default:throw new Error("Invalid interval value of "+t);}};t.isDate=u;t.isEnumValue=function(n,t){return n in t};t.isNumber=function(n){return null!==n&&!isNaN(n)&&isFinite(n)};t.isNOU=f;t.isObject=function(n){return null!=n&&"object"==typeof n};t.isFunction=function(n){return null!=n&&"function"==typeof n};t.isArray=function(n){return null!=n&&Array.isArray(n)};t.isString=r;t.isBoolean=function(n){return"boolean"==typeof n};t.getDistantPast=function(){return new Date(-116444736e5)};t.getDistantFuture=function(){return new Date(640922112e5)};t.MAX_DATE_MILLISECONDS=864e13;t.MIN_DATE_MILLISECONDS=-864e13;t.addSecondsWithoutOverflow=function(n,i){if(!n)return null;if(i<0)return e(n,-1*i);var r=n.getTime()+1e3*i;return r<t.MAX_DATE_MILLISECONDS?new Date(r):new Date(t.MAX_DATE_MILLISECONDS)};t.subtractSecondsWithoutOverflow=e;t.isValidLanguageSubTag=function(n){if(!n)return!1;var t=o(n);return!!t&&t===n};t.extractLanguageSubtag=o;t.guid=function(){return(i()+i()+"-"+i()+"-4"+i().substr(0,3)+"-"+i()+"-"+i()+i()+i()).toLowerCase()};t.makeArrayFromObjectValuesSortedByKeyString=function(n){var t=Object.keys(n),i,r,u;t.sort();i=[];for(r in t)t.hasOwnProperty(r)&&(u=t[r],i.push(n[u]));return i};t.stringToDate=function(n){if(!r(n))return null;var t=n?new Date(n):null;return u(t)?t:null};t.overrideValues=function(n,t){var r,i;if(!t)return t;if(r=t,n)for(i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);return r};t.isUtcDatetimeString=function(n){return!!r(n)&&/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/.test(n)};t.dateToShortUtcString=function(n){function t(n){return n<10?"0"+n:n.toString()}return u(n)?n.getUTCFullYear()+"-"+t(n.getUTCMonth()+1)+"-"+t(n.getUTCDate())+"T"+t(n.getUTCHours())+":"+t(n.getUTCMinutes())+":"+t(n.getUTCSeconds())+"Z":null};t.fyShuffle=function(n){var t,i,r;if(!f(n)){if(0===n.length||1===n.length)return n;for(t=n.length-1;t>0;)i=Math.floor(Math.random()*(t+1)),r=n[t],n[t]=n[i],n[i]=r,t--;return n}};t.isValidUserId=function(n){return!!r(n)&&/^([a-z]{1,2}):\w+/.test(n)};t.safeParseObject=function(n,t){try{var i=!n||"{"!==n[0]&&"["!==n[0]?void 0:JSON.parse(n);return null!=i?i:t}catch(n){}return t}},function(n,t,i){"use strict";var r,u,f,e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});t.ISurveyInfo=t.ISurveyComponent=t.ISurvey=t.IFloodgateSettingIdMap=t.IFloodgateStorageProvider=t.IActivityListener=void 0;r=i(35);t.ISurveyInfo=r;u=i(56);t.IActivityListener=u;f=i(57);t.IFloodgateSettingIdMap=f;e=i(14);t.IFloodgateStorageProvider=e;o=i(18);t.ISurvey=o;s=i(19);t.ISurveyComponent=s;h=i(21);Object.defineProperty(t,"CampaignDefinition",{enumerable:!0,get:function(){return h.CampaignDefinition}})},function(n,t,i){"use strict";function h(n,t){var e,i,h;try{if(!r&&o.a.isStorageAvailable()&&(r=new s.a(["DynamicSettings"])),!r)return t;if(e=r.getItemContent("DynamicSettings"),!f(e)&&e.hasOwnProperty(n)&&!f(e[n]))return(i=e[n],"number"==typeof t&&"number"!=typeof i)?"string"==typeof i?(h=-1===i.indexOf(".")?parseInt(i,10):parseFloat(i),isNaN(h)?t:h):t:i}catch(t){u.b().logEvent(u.a.Common.Error.VALUE,2,{ErrorMessage:"Error reading dynamic setting "+(t&&t.message),Type:n})}return t}i.d(t,"a",function(){return h});var e=i(4),o=i(15),s=i(33),u=i(2),f=e.l,r=null},function(n,t,i){"use strict";var r,u,f;i.d(t,"c",function(){return r});i.d(t,"a",function(){return u});i.d(t,"b",function(){return f}),function(n){n[n.None=0]="None";n[n.Css=1]="Css";n[n.Strings=2]="Strings"}(r||(r={})),function(n){n[n.Undefined=0]="Undefined";n[n.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent";n[n.MinorWithParentalConsent=2]="MinorWithParentalConsent";n[n.NotAdult=3]="NotAdult";n[n.Adult=4]="Adult";n[n.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(u||(u={})),function(n){n[n.MSA=0]="MSA";n[n.AAD=1]="AAD";n[n.Unauthenticated=2]="Unauthenticated"}(f||(f={}))},function(n){"use strict";var t;!function(n){!function(n){n[n.FloodgateSettings=0]="FloodgateSettings";n[n.SurveyActivationStats=1]="SurveyActivationStats";n[n.SurveyEventActivityStats=2]="SurveyEventActivityStats";n[n.CampaignDefinitions=3]="CampaignDefinitions";n[n.CampaignStates=4]="CampaignStates";n[n.GovernedChannelStates=5]="GovernedChannelStates";n[n.TmsCache_MessageMetadata=6]="TmsCache_MessageMetadata";n[n.TmsCache_UserGovernance=7]="TmsCache_UserGovernance";n[n.TmsCache_CampaignContent=8]="TmsCache_CampaignContent";n[n.Tms_DynamicSettings=9]="Tms_DynamicSettings";n[n.LogLevelSettings=10]="LogLevelSettings";n[n.UserFacts=11]="UserFacts";n[n.DebugOverrides=12]="DebugOverrides"}(n.FileType||(n.FileType={}))}(t||(t={}));n.exports=t},function(n,t,i){"use strict";var u,s=i(11),f=i(8),e=i(2),r=s.IFloodgateStorageProvider.FileType,o=((u={})[r.CampaignDefinitions]="obf-CampaignDefinitions",u[r.CampaignStates]="obf-CampaignStates",u[r.FloodgateSettings]="obf-FloodgateSettings",u[r.GovernedChannelStates]="obf-GovernedChannelStates",u[r.SurveyActivationStats]="obf-SurveyActivationStats",u[r.SurveyEventActivityStats]="obf-SurveyEventActivityStats",u[r.TmsCache_CampaignContent]="obf-TmsCampaignContent",u[r.TmsCache_MessageMetadata]="obf-TmsMessageMetadata",u[r.TmsCache_UserGovernance]="obf-TmsUserGovernance",u[r.Tms_DynamicSettings]="obf-TmsDynamicSettings",u[r.LogLevelSettings]="obf-LogLevelSettings",u[r.UserFacts]="obf-UserFacts",u[r.DebugOverrides]="obf-DebugOverrides",u),h=function(){function n(){}return n.isStorageAvailable=function(){try{var n="__storage_test__";return f.b().localStorage.setItem(n,n),f.b().localStorage.removeItem(n),!0}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&0!==f.b().localStorage.length}},n.safeReadObject=function(n,t){if(void 0===t&&(t=void 0),!(n in r))return t;try{var e=o[n],i=f.b().localStorage.getItem(e),u=!i||"{"!==i[0]&&"["!==i[0]?i:JSON.parse(i);return null!=u?u:t}catch(n){}return t},n.prototype.fileLock=function(){},n.prototype.fileUnlock=function(){},n.prototype.read=function(n){if(!(n in r))return"";var t,i=o[n];try{t=f.b().localStorage.getItem(i)}catch(n){return e.b().logEvent(e.a.SURVEY_FLOODGATE_FILEREAD_FAILED,2,{ErrorMessage:n.toString(),FileName:i}),""}return t},n.prototype.write=function(n,t){if(n in r){var i=o[n];try{f.b().localStorage.setItem(i,t)}catch(n){return void e.b().logEvent(e.a.SURVEY_FLOODGATE_FILEWRITE_FAILED,2,{ErrorMessage:n.toString(),FileName:i})}}},n}();t.a=h},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TelemetryEvent=void 0;var i=function(){function n(){}var a,v,y,p,w,b,i,k,u,d,g,f,t,nt,tt,it,e,r,o,rt,ut,ft,et,ot,st,s,ht,ct,lt,at,h,vt,yt,c,l,pt;return n.CampaignState=((a=function(){}).Deserialize=((v=function(){}).Failed="FloodgateCore_CampaignState_Deserialize_Failed",v),a),n.FileBasedCampaignStateProvider=((y=function(){}).Load=((p=function(){}).Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",p),y),n.HostBasedCampaignStateProvider=((w=function(){}).GetStatesFromHost=((b=function(){}).Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",b),w),n.Floodgate=((i=function(){}).Initialize=((k=function(){}).Failed="FloodgateCore_Floodgate_Initialize_Failed",k),i.Start=((u=function(){}).Failed="FloodgateCore_Floodgate_Start_Failed",u.Warning="FloodgateCore_Floodgate_Start_Warning",u.SurveysDisabled="FloodgateCore_Floodgate_Start_SurveysDisabled",u),i.UserFactsLoad=((d=function(){}).Failed="FloodgateCore_Floodgate_UserFactsLoad_Failed",d),i.UserFactsSpecDeserialization=((g=function(){}).Failed="FloodgateCore_Floodgate_UserFactsSpecDeserialization_Failed",g),i.UserFactsSpecIsAMatch=((f=function(){}).Failed="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Failed",f.Mismatch="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Mismatch",f.Summary="FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Summary",f),i),n.FloodgateEngine=((t=function(){}).Make=((nt=function(){}).Failed="FloodgateCore_FloodgateEngine_Make_Failed",nt),t.Common=((tt=function(){}).Error="FloodgateCore_FloodgateEngine_Common_Error",tt),t.Start=((it=function(){}).Failed="FloodgateCore_FloodgateEngine_Start_Failed",it),t.StartAsync=((e=function(){}).Failed="FloodgateCore_FloodgateEngine_StartAsync_Failed",e.Stopped="FloodgateCore_FloodgateEngine_StartAsync_Stopped",e),t.OnSurveyActivated=((r=function(){}).ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",r.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",r.SurveyNotDefined="FloodgateCore_FloodgateEngine_OnSurveyActivated_SurveyNotDefined",r.SessionSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_SessionSuppressedSurvey",r.Error="FloodgateCore_FloodgateEngine_OnSurveyActivated_Error",r),t.CheckGovernanceServiceAndActivateSurvey=((o=function(){}).GovernanceServiceForceToDisplay="FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceForceToDisplay",o.GovernanceServiceClientCompleted="FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceClientCompleted",o),t),n.GovernedChannelState=((rt=function(){}).Deserialize=((ut=function(){}).Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",ut),rt),n.FileBasedGovernedChannelStateProvider=((ft=function(){}).Load=((et=function(){}).Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",et),ft),n.HostBasedGovernedChannelStateProvider=((ot=function(){}).GetStatesFromHost=((st=function(){}).Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",st),ot),n.SurveyStatCollectionActivation=((s=function(){}).FromJson=((ht=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",ht),s.ToJson=((ct=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",ct),s),n.HostBasedSurveyActivationStatsProvider=((lt=function(){}).GetSurveyStatsFromHost=((at=function(){}).Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",at),lt),n.SurveyStatCollectionEventActivity=((h=function(){}).FromJson=((vt=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",vt),h.ToJson=((yt=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",yt),h),n.SurveyActivity=((c=function(){}).LogActivity=((l=function(){}).EventsReprocessed="FloodgateCore_SurveyActivity_LogActivity_EventsReprocessed",l.SurveysReprocessed="FloodgateCore_SurveyActivity_LogActivity_SurveysReprocessed",l),c.SetActivityTrackingContracts=((pt=function(){}).DuplicateSurveyID="FloodgateCore_SurveyActivity_SetActivityTrackingContracts_DuplicateSurveyID",pt),c),n}();t.TelemetryEvent=i},function(n,t,i){"use strict";var u,r,f;Object.defineProperty(t,"__esModule",{value:!0});t.GovernedChannel=t.GovernedChannelType=void 0;r=i(10);!function(n){n[n.Standard=0]="Standard";n[n.Urgent=1]="Urgent";n[n.Banner=2]="Banner";n[n.TeachingMessage=3]="TeachingMessage"}(t.GovernedChannelType||(t.GovernedChannelType={})),function(n){n.getDefault=function(){return n.Standard}}(u=t.GovernedChannelType||(t.GovernedChannelType={}));f=function(){function n(n,t,i,f){if(!r.isEnumValue(n,u))throw new Error("type is not a valid GovernedChannelType");if(!t)throw new Error("name must not be null or empty");if(i<0)throw new Error("cooldownSeconds must not be negative");this.type=n;this.name=t;this.cooldownSeconds=i;this.setCooldownStartTime(f)}return n.prototype.setCooldownStartTime=function(n){this.cooldownStartTime=n;this.cooldownEndTime=r.isNOU(this.cooldownStartTime)?r.getDistantPast():r.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds)},n.prototype.isOpen=function(){return this.isOpenAtDate(new Date)},n.prototype.isOpenAtDate=function(n){return!!n&&n>this.cooldownEndTime},n.prototype.getType=function(){return this.type},n.prototype.getName=function(){return this.name},n.prototype.getCooldownSeconds=function(){return this.cooldownSeconds},n.prototype.getCooldownStartTime=function(){return this.cooldownStartTime},n.prototype.getCooldownEndTime=function(){return this.cooldownEndTime},n}();t.GovernedChannel=f},function(n){"use strict";var t;!function(n){!function(n){n[n.Feedback=0]="Feedback";n[n.Nps=1]="Nps";n[n.Psat=2]="Psat";n[n.Bps=3]="Bps";n[n.Fps=4]="Fps";n[n.Nlqs=5]="Nlqs";n[n.Intercept=6]="Intercept";n[n.GenericMessagingSurface=12]="GenericMessagingSurface"}(n.Type||(n.Type={}));n.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey";n.DOM_NPS_TAGNAME="Nps";n.DOM_PSAT_TAGNAME="Psat";n.DOM_BPS_TAGNAME="Bps";n.DOM_FPS_TAGNAME="Fps";n.DOM_NLQS_TAGNAME="Nlqs";n.DOM_INTERCEPT_TAGNAME="Intercept";n.LAUNCHER_TYPE_DEFAULT="survey"}(t||(t={}));n.exports=t},function(n){"use strict";var t;!function(n){n.DOM_PROMPT_TAGNAME="Prompt";n.DOM_COMMENT_TAGNAME="Comment";n.DOM_RATING_TAGNAME="Rating";n.DOM_CVSURVEY_TAGNAME="CVSurvey";n.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice";n.DOM_INTERCEPT_TAGNAME="Intercept";n.JSON_INTERCEPT_KEYNAME="intercept";n.JSON_INTERCEPTURL_KEYNAME="url";n.JSON_PROMPT_KEYNAME="prompt";n.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText";n.JSON_PROMPTNOTEXT_KEYNAME="noButtonText";n.JSON_COMMENT_KEYNAME="comment";n.JSON_RATING_KEYNAME="rating";n.JSON_CVSURVEY_KEYNAME="cvSurvey";n.JSON_CVSURVEYFORMID_KEYNAME="formId";n.JSON_CVSURVEYTHEME_KEYNAME="theme";n.JSON_RATINGOPTIONS_KEYNAME="options";n.JSON_CVSURVEYPRODUCTNAME_KEYNAME="productName";n.JSON_CVSURVEYUIHOST_KEYNAME="uiHost";n.JSON_CVSURVEYPLATFORM_KEYNAME="platform";n.JSON_TITLE_KEYNAME="title";n.JSON_QUESTION_KEYNAME="question";n.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice";n.JSON_APPLICATION_KEYNAME="application";n.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData";n.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings";n.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData"}(t||(t={}));n.exports=t},function(n,t,i){"use strict";var v=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){var t;n.done?u(n.value):(t=n.value,t instanceof i?t:new i(function(n){n(t)})).then(o,s)}e((r=r.apply(n,t||[])).next())})},y=this&&this.__generator||function(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==e[0]&&2!==e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};Object.defineProperty(t,"__esModule",{value:!0});t.FloodgateEngine=void 0;var p=i(14),w=i(21),b=i(58),k=i(41),r=i(16),l=i(71),d=i(17),g=i(45),a=i(32),h=i(40),c=i(42),e=i(46),u=p.FileType,nt=i(74),f=i(75),o=i(10),tt=function(){function n(){}return n.prototype.log_TriggerMet=function(){},n.prototype.log_UserSelected=function(){},n.prototype.log_CampaignLoad_Failed=function(){},n.prototype.log_Error=function(){},n.prototype.log_Event=function(){},n.prototype.log_LocalError=function(){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},n}(),it={run:function(){},shouldAcceptActivity:function(){return!0}},s={},rt=function(){function n(t,i,r,u,f,e,o,s,h){if(this.initializationStatus=0,this.candidateSurveys={},this.launchedSurveys={},this.launchedLaunchers=[],this.surveyEventSent=[],this.staleTriggeredSurveysQueue=[],!t)throw new Error("surveyClient must not be null");if(!i)throw new Error("activityListener must not be null");if(!r)throw new Error("launcherFactory must not be null");if(!u)throw new Error("onSurveyActivatedCallback must not be null");if(!f)throw new Error("storage must not be null");if(!e)throw new Error("governor must not be null");if(!s)throw new Error("transporterFactory must not be null");this.surveyClient=t;this.activityListener=i;this.launcherFactory=r;this.onSurveyActivatedCallback=u;this.storage=f;this.governor=e;this.surveyActivationStatsProvider=o;this.governanceServiceClient=h;n.transporterFactory=s;this.loggedFirstStart=!1;this.setPendingSurveys(null);this.activityListener.clearSurveys();var c=this;this.activityListener.setCallback({run:function(n,t){c.onSurveyActivated(n,t)},shouldAcceptActivity:function(n){return c.shouldAcceptActivity(n)}})}return n.setTelemetryLogger=function(t){if(!t)throw new Error("telemetryLogger must not be null");n.telemetryLogger=t},n.getTelemetryLogger=function(){return n.telemetryLogger},n.getTransportFactory=function(){return n.transporterFactory},n.make=function(t,i,u,f,e,o,s,l,v,y,p){try{var d=g.GovernedChannelStateProviderFactory.make(f,e),nt=c.SurveyActivationStatsProviderFactory.make(f,e),tt=k.CampaignStateProviderFactory.make(f,e);return v.push(new w.FileSystemCampaignDefinitionProvider(f)),new n(new b.CampaignManager(tt,v,o,s,t,new Date,y),new h(it,this.getTelemetryLogger),i,u,f,new a.Governor(d),nt,l,p)}catch(n){this.telemetryLogger.log_Event(r.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:n&&n.toString(),ErrorDetails:n&&n.stack})}},n.prototype.mergeAndSave=function(){this.saveSettings();this.saveSurveyActivationHistory();this.saveSurveyEventActivityHistory();this.surveyClient.saveCurrentState();this.governor.saveChannelStates()},n.prototype.start=function(){if(2!==this.initializationStatus&&3!==this.initializationStatus)try{this.setInitializationStatus(2);this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes();this.surveyClient.refreshSurveyDefinitions(t);this.setPendingSurveysAndStartFloodgate();this.setInitializationStatus(3)}catch(t){this.setInitializationStatus(1);n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:t&&t.toString(),ErrorDetails:t&&t.stack})}},n.prototype.startAsync=function(){if(2===this.initializationStatus||3===this.initializationStatus)return Promise.resolve();try{this.setInitializationStatus(2);this.loadSettingsAndPriorEventCounts();var i=this.getAvailableChannelTypes(),t=this;return new Promise(function(u,f){t.surveyClient.refreshSurveyDefinitionsAsync(i).then(function(){4===t.initializationStatus?(t.setInitializationStatus(3),t.stop(),n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.StartAsync.Stopped,{ErrorMessage:"Stopped because of a pending stop() call"})):t.setPendingSurveysAndStartFloodgate();u()}).catch(function(i){t.setInitializationStatus(1);n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:"Survey refresh error "+(i&&i.message)});f(i)})})}catch(i){return this.setInitializationStatus(1),n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:i&&i.toString(),ErrorDetails:i&&i.stack}),Promise.resolve()}},n.prototype.stop=function(){3===this.initializationStatus&&(this.mergeAndSave(),this.setPendingSurveys(null),this.updateActivityListenerWithCurrentSurveyDefinitions());this.setInitializationStatus(4)},n.prototype.getActivityListener=function(){return this.activityListener},n.prototype.setInitializationStatus=function(n){this.initializationStatus=n},n.prototype.saveSettings=function(){this.storage.fileLock(u.FloodgateSettings);try{this.writeString(u.FloodgateSettings,l.FloodgateSettings.toJson(this.floodgateSettings))}finally{this.storage.fileUnlock(u.FloodgateSettings)}},n.prototype.loadSettingsAndPriorEventCounts=function(){var t,i;try{this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load();this.previousSurveyEventActivityStats=e.SurveyStatCollectionEventActivity.fromJson(this.readString(u.SurveyEventActivityStats));t=this.previousSurveyEventActivityStats.getStats();for(i in t)t.hasOwnProperty(i)&&this.surveyEventSent.push(i);this.floodgateSettings=l.FloodgateSettings.fromJson(this.readString(u.FloodgateSettings))}catch(t){n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.Common.Error,{ErrorMessage:"Error loading prior settings/events "+(t&&t.toString())})}},n.prototype.getAvailableChannelTypes=function(){var t=this.governor.getAvailableChannelData(),n=[];return t.forEach(function(t){t&&n.push(t.getType())}),n},n.prototype.setPendingSurveysAndStartFloodgate=function(){this.setPendingSurveys(this.surveyClient.getAppSurveys());this.updateActivityListenerWithCurrentSurveyDefinitions();this.setInitializationStatus(3);this.loggedFirstStart||(this.loggedFirstStart=!0,this.getActivityListener().logActivity(h.FloodgateStartActivityName))},n.prototype.updateSurveyActivationStats=function(n){var r=n.getSurveyInfo(),t=r.getId(),i=this.previousSurveyActivationStats.getStats()[t]||new c.SurveyActivationStats;i.Type=n.getType();i.ExpirationTimeUtc=r.getExpirationTimeUtc();i.ActivationTimeUtc=new Date;i.SurveyLaunchCount++;this.previousSurveyActivationStats.addStats(t,i);s.hasOwnProperty(t)||(s[t]=0);s[t]++},n.prototype.saveSurveyActivationHistory=function(){var t,i,f;this.storage.fileLock(u.SurveyActivationStats);try{var n=this.surveyActivationStatsProvider.load(),e=this.previousSurveyActivationStats.getStats(),r=new c.SurveyStatCollectionActivation;for(t in this.launchedSurveys)this.launchedSurveys.hasOwnProperty(t)&&(i=this.launchedSurveys[t].getSurveyInfo().getId(),f=e[i],r.addStats(i,f));n.accumulate(r);this.surveyActivationStatsProvider.save(n);this.previousSurveyActivationStats=n}finally{this.storage.fileUnlock(u.SurveyActivationStats)}},n.prototype.saveSurveyEventActivityHistory=function(){var r;this.storage.fileLock(u.SurveyEventActivityStats);try{var t=e.SurveyStatCollectionEventActivity.fromJson(this.readString(u.SurveyEventActivityStats)),f=new Date,i=new e.SurveyStatCollectionEventActivity,o=function(t){var u,r,o,h,c,a;if(n.candidateSurveys.hasOwnProperty(t)){if(u=new e.SurveyEventActivityStats,r=n.candidateSurveys[t],!r.getSurveyInfo().isActiveForDate(f))return"continue";u.ExpirationTimeUtc=r.getSurveyInfo().getExpirationTimeUtc();var v=r.getSurveyInfo().getActivationEvent().getTrackingSet(),s=[],l=[];for(v.getList().forEach(function(n){n&&(n.getIsAggregate()?s.push(n.getActivity()):l.push(n.getActivity()))}),u.Counts=new Array(s.length),o=0;o<s.length;o++)u.Counts[o]=n.activityListener.moveSessionCountIntoBaseCount(s[o],r.getSurveyInfo().getId());for(h=0,c=l;h<c.length;h++)a=c[h],n.activityListener.saveSessionTrackingActivity(a);i.addStats(r.getSurveyInfo().getId(),u)}},n=this;for(r in this.candidateSurveys)o(r);t.accumulate(i);this.writeString(u.SurveyEventActivityStats,e.SurveyStatCollectionEventActivity.toJson(t));this.previousSurveyEventActivityStats=t}finally{this.storage.fileUnlock(u.SurveyEventActivityStats)}},n.prototype.setPendingSurveys=function(n){var t,i;if(this.candidateSurveys={},n)for(t in n)n.hasOwnProperty(t)&&(i=n[t],this.launcherFactory.AcceptsSurvey(i)&&(this.candidateSurveys[t]=i))},n.prototype.getCurrentSurveyDefinitions=function(){var o=this,u=[],h=this.getAllCampaignDefinitionIDs(),c=this.getAllCandidateCampaignDefinitionIDs(),l=this.surveyClient.getCampaignDefinitions(),a=function(n){if(f.isBusinessCriticalSurvey(n))return!0;var t=o.previousSurveyActivationStats.getBySurveyId(n.getId());return!(!f.isMultiLaunchSurvey(n)||f.hasSurveyReachedMaxLaunches(n,t)||f.hasSurveyReachedMaxLaunchesPerSession(n,s))||!(t||!n.isActiveForDate(new Date))},i,r,t,e;for(i in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(i)){if(r=this.candidateSurveys[i],t=r.getSurveyInfo(),!l[null==t?void 0:t.getBackEndId()]||!a(t))continue;this.surveyEventSent.indexOf(i)<0&&(this.surveyEventSent.push(i),e=this.getAdditionalSurveyInfoForTelemetry(r,null,h,c),n.telemetryLogger.log_UserSelected(t.getBackEndId(),t.getId(),r.getType(),JSON.stringify(e)));u.push(r)}return u},n.prototype.getAdditionalSurveyInfoForTelemetry=function(n,t,i,r){var h,c,u,f,s=this.surveyClient.getCampaignDefinitions()[n.getCampaignId()],e;return h=s.nominationScheme.percentageNumerator,c=s.nominationScheme.percentageDenominator,u=s.nominationScheme.nominationPeriod.asTimeIntervalSeconds(),u=o.isNOU(u)?-1:u,f=s.nominationScheme.cooldownPeriod.asTimeIntervalSeconds(),f=o.isNOU(f)?-1:f,e=n.getSurveyInfo(),{allCampaignDefinitionIDs:i,allCandidateCampaignDefinitionIDs:r,channelType:e.getGovernedChannelType(),contextCount:t?t.length:void 0,cooldownPeriodNumber:f,nominationPeriodNumber:u,percentageDenominator:c,percentageNumerator:h,surveyLauncherType:n.getLauncherType(),businessLevel:e.getBusinessLevel(),maxLaunches:e.getMaxLaunches(),maxLaunchesPerSession:e.getMaxLaunchesPerSession()}},n.prototype.getAllCandidateCampaignDefinitionIDs=function(){var t=[],n,i;for(n in this.candidateSurveys)this.candidateSurveys.hasOwnProperty(n)&&(i=this.candidateSurveys[n],t.push(i.getSurveyInfo().getBackEndId()));return t},n.prototype.getAllCampaignDefinitionIDs=function(){var n=this.surveyClient.getCampaignDefinitions(),i=[],t,r;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r=n[t],i.push(r.campaignId));return i},n.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){for(var t,u,i=[],n=0,r=this.getCurrentSurveyDefinitions();n<r.length;n++)t=r[n].getSurveyInfo(),u=new nt.ActivityTrackingContract(t.getId(),t.getActivationEvent().getTrackingSet()),i.push(u);this.activityListener.SetActivityTrackingContracts(i,this.previousSurveyEventActivityStats)},n.prototype.setCriticalPendingSurveysAndUpdateActivityListener=function(){var t={},n,i;for(n in this.candidateSurveys)this.candidateSurveys.hasOwnProperty(n)&&(i=this.candidateSurveys[n],f.isCriticalSurvey(i.getSurveyInfo())&&(t[n]=i));Object.keys(t).length>0&&(this.setPendingSurveys(t),this.updateActivityListenerWithCurrentSurveyDefinitions())},n.prototype.shouldAcceptActivity=function(n){return 3===this.initializationStatus||n===h.FloodgateStartActivityName},n.prototype.onSurveyActivated=function(t,i){for(var u,h,l,c,e,f=0,s=this.getCurrentSurveyDefinitions();f<s.length;f++)if(h=s[f],h.getSurveyInfo().getId()===t){u=h;break}if(o.isNOU(u))n.getTelemetryLogger().log_Error(r.TelemetryEvent.FloodgateEngine.OnSurveyActivated.SurveyNotDefined,"Survey is not defined in the current survey definitions.");else{l=u.getSurveyInfo().getActivationEvent().getTrackingSet().getActivityTrackingInfo(this.activityListener,t);c=this.getAdditionalSurveyInfoForTelemetry(u,i,this.getAllCampaignDefinitionIDs(),this.getAllCandidateCampaignDefinitionIDs());c.governanceServiceClientState=this.governanceServiceClient.getClientState();n.telemetryLogger.log_TriggerMet(u.getSurveyInfo().getBackEndId(),u.getSurveyInfo().getId(),u.getType(),l,JSON.stringify(c));try{e=u.getSurveyInfo().getGovernedChannelType();this.governanceServiceClient.isEnabled(e)?(this.staleTriggeredSurveysQueue.push(u),1===this.staleTriggeredSurveysQueue.length&&this.checkGovernanceServiceAndActivateSurvey(u,e,i)):this.activateSurvey(u,e,i)}catch(t){n.telemetryLogger.log_Event(r.TelemetryEvent.FloodgateEngine.OnSurveyActivated.Error,{ErrorMessage:"Error activating survey "+(t&&t.toString()),ErrorDetails:t&&t.stack})}}},n.prototype.activateSurvey=function(t,i,u){var s=!1,h,e,c,l;this.candidateSurveys[t.getSurveyInfo().getId()]&&t.getSurveyInfo().isActiveForDate(new Date)&&((this.governor.refreshChannelData(),f.isCriticalSurvey(t.getSurveyInfo()))?s=!0:this.governor.isChannelOpen(i)?this.surveyActivationStatsProvider.load().getBySurveyId(t.getSurveyInfo().getId())?n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()}):0===Object.keys(this.launchedSurveys).length?s=!0:(h=Object.values(this.launchedSurveys)[0],o.isNOU(h)||n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.OnSurveyActivated.SessionSuppressedSurvey,{CampaignId:h.getSurveyInfo().getBackEndId(),SurveyId:h.getSurveyInfo().getId()})):n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:d.GovernedChannelType[i]}),s&&(this.launchedSurveys[t.getSurveyInfo().getId()]=t));(this.updateSurveyActivationStats(t),this.mergeAndSave(),this.activityListener.clearSurveys(),this.staleTriggeredSurveysQueue=[],s)&&(this.governor.startChannelCooldown(i),e=t.getSurveyInfo(),c=!0,f.isBusinessCriticalSurvey(e)?c=!1:f.isMultiLaunchSurvey(e)&&(l=this.previousSurveyActivationStats.getBySurveyId(e.getId()),c=f.hasSurveyReachedMaxLaunches(e,l)),this.surveyClient.onSurveyActivated(e,c),this.launchLauncher(t,u),this.setCriticalPendingSurveysAndUpdateActivityListener())},n.prototype.checkGovernanceServiceAndActivateSurvey=function(t,i,u){return v(this,void 0,void 0,function(){var o,s,h,f,e,c;return y(this,function(l){switch(l.label){case 0:return o=this.surveyClient.getCampaignDefinitions()[t.getCampaignId()],s=o.nominationScheme.cooldownPeriod.asTimeIntervalSeconds(),h=a.Governor.GetChannelCoolDown(i),[4,this.governanceServiceClient.checkGovernancePermitAsync(t,s,h,i)];case 1:return f=l.sent(),e=!1,n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceClientCompleted,{Message:JSON.stringify(this.createGorvernanceResponseTelemetry(f))}),3!==this.initializationStatus?[2]:(f.error?this.governanceServiceClient.shouldForceDisplay()&&(e=!0,n.getTelemetryLogger().log_Event(r.TelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceForceToDisplay,{ErrorMessage:f.errorMessage})):f.permission?e=!0:(c=f.lastTriggerSurvey,this.governor.startChannelCooldown(i,c.lastTriggerSurveyTime),this.clearSurveyWithChannel(i)),e?(this.activateSurvey(t,i,u),[2]):this.staleTriggeredSurveysQueue.length<=1?(this.staleTriggeredSurveysQueue=[],[2]):(this.staleTriggeredSurveysQueue.shift(),this.checkGovernanceServiceAndActivateSurvey(this.staleTriggeredSurveysQueue[0],i,u),[2]))}})})},n.prototype.readString=function(n){return this.storage.read(n)},n.prototype.writeString=function(n,t){this.storage.write(n,t)},n.prototype.launchLauncher=function(n,t){var i=this.launcherFactory.makeSurveyLauncher(n);i&&(this.launchedLaunchers.push(i),this.onSurveyActivatedCallback.onSurveyActivated(i,n,{contextInfo:t}))},n.prototype.clearSurveyWithChannel=function(n){var r={},t,i;for(t in this.candidateSurveys)this.candidateSurveys.hasOwnProperty(t)&&(i=this.candidateSurveys[t],i.getSurveyInfo().getGovernedChannelType()!==n&&(r[t]=i));this.candidateSurveys=r;this.activityListener.UpdateActivityTrackingContracts(this.candidateSurveys)},n.prototype.createGorvernanceResponseTelemetry=function(n){return{FloodgateEngineStatus:this.initializationStatus.toString(),GovernanceServiceResult:n,StaleTriggeredSurveysQueueCount:this.staleTriggeredSurveysQueue.length-1}},n.telemetryLogger=new tt,n}();t.FloodgateEngine=rt},function(n,t,i){"use strict";function si(n){var u=[],i,t,f,e;if(r(n))return{result:u,error:"Empty"};if(!Array.isArray(n))return{result:u,error:"Not an array"};for(i=[],t=0;t<n.length;t++)f=n[t],f?(e=ri.deserialize(f),e?u.push(e):i.push(t)):i.push(t);return{result:u,error:i.length>0?"Invalid campaign definitions at indexes: "+i.toString():void 0}}var d,u=this&&this.__extends||(d=function(n,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}d(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),nt,c,p,tt,it,rt,a,ut,ft,et,w,ot,b,st,s,k,ht,v,ct,lt,at,vt,yt,pt,wt,h,bt,kt,dt,gt,ni,ti,ii,ri,hi;Object.defineProperty(t,"__esModule",{value:!0});t.FileSystemCampaignDefinitionProvider=t.FilterValidCampaignDefinitions=t.CampaignDefinition=t.CampaignSurveyTemplateIntercept=t.CampaignSurveyTemplateGenericMessagingSurface=t.CampaignSurveyTemplateNps11PointStatic=t.CampaignSurveyTemplateNps5PointStatic=t.CampaignSurveyTemplateNps=t.CampaignSurveyTemplateNlqs=t.CampaignSurveyTemplateFps=t.CampaignSurveyTemplate=t.CampaignSurveyMetadata=t.CampaignSurveyContentComment=t.CampaignSurveyContentRating=t.CampaignSurveyContentIntercept=t.CampaignSurveyContentPrompt=t.CampaignSurveyContentCVSurvey=t.CampaignSurveyContentMultipleChoice=t.CampaignSurveyContent=t.CampaignSurveyEventCountedActivitySequence=t.CampaignSurveyEventCountedActivity=t.CampaignSurveyEvent=t.CampaignNominationSchemeRatioPercentage=t.CampaignNominationScheme=t.CampaignDistributionRamp=t.CampaignDistribution=t.CampaignAdditionalDataRequested=t.CampaignDurationSingleBuildChange=t.CampaignDurationTimeInterval=t.CampaignDuration=t.CampaignScopeUserFactAll=t.CampaignScopeUserFactAny=t.CampaignScopeEnvironmentCrossProduct=t.CampaignScopeAny=t.CampaignScope=t.CampaignLanguageRangeLanguageSubtag=t.CampaignLanguageRange=void 0;var ci=i(14),li=i(16),l=i(20),ai=i(17),o=i(10),y=i(76),ui=o.getDistantFuture,fi=o.isBoolean,r=o.isNOU,e=o.isNumber,f=o.isString,ei=o.isUtcDatetimeString,oi=o.stringToDate,g=function(){function n(){}return n.deserialize=function(n){var t;return n&&0===n.Type&&(t=nt.deserialize(n)),void 0===t?null:t},n.prototype.validate=function(){return!0},n}();t.CampaignLanguageRange=g;nt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return n&&(i.languageSubTag=n.Value),i.validate()?i:null},t.prototype.isInRange=function(n){if(r(n))return!1;var t=o.extractLanguageSubtag(n);return!r(t)&&t.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase()},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&!(r(this.languageSubTag)||!f(this.languageSubTag))&&!!o.isValidLanguageSubTag(this.languageSubTag)},t}(g);t.CampaignLanguageRangeLanguageSubtag=nt;c=function(){function n(){}return n.deserialize=function(n){var t;if(r(n))return null;switch(n.Type){case 0:t=p.deserialize(n);break;case 1:t=tt.deserialize(n);break;case 2:t=it.deserialize(n);break;case 3:t=rt.deserialize(n)}return void 0===t?null:t},n.prototype.validate=function(){return!0},n}();t.CampaignScope=c;p=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(){return new t},t.prototype.isInScope=function(){return!0},t.prototype.validate=function(){return!!n.prototype.validate.call(this)},t}(c);t.CampaignScopeAny=p;tt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var u=new t,i=[],f,e;if(r(n))return null;for(f in n.Languages)n.Languages.hasOwnProperty(f)&&(e=n.Languages[f],e&&i.push(g.deserialize(e)));return 0===i.length&&(i=null),u.languageRanges=i,u.validate()?u:null},t.prototype.setEnvironmentProvider=function(n){this.environmentProvider=n},t.prototype.isInScope=function(){var t,n;if(r(this.languageRanges))return!0;if(r(this.environmentProvider)||!this.environmentProvider.getLanguage())return!1;t=this.environmentProvider.getLanguage();for(n in this.languageRanges)if(this.languageRanges.hasOwnProperty(n)&&this.languageRanges[n].isInRange(t))return!0;return!1},t.prototype.validate=function(){if(!n.prototype.validate.call(this))return!1;if(this.languageRanges)for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&!this.languageRanges[t])return!1;return!0},t}(c);t.CampaignScopeEnvironmentCrossProduct=tt;it=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return i.userFacts=y.deserializeUserFacts(n),i.validate()?i:null},t.prototype.setUserFactsProvider=function(n){this.userFactsProvider=n},t.prototype.isInScope=function(){var n=this;return!!r(this.userFacts)||!!this.userFactsProvider&&this.userFacts.some(function(t){var i=n.userFactsProvider.getUserFact(t.getName());return t.isAMatch(i)})},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&y.validateUserFacts(this.userFacts)},t}(c);t.CampaignScopeUserFactAny=it;rt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return i.userFacts=y.deserializeUserFacts(n),i.validate()?i:null},t.prototype.setUserFactsProvider=function(n){this.userFactsProvider=n},t.prototype.isInScope=function(){var i=this,n,t;return r(this.userFacts)?!0:this.userFactsProvider?(n=this.userFacts.filter(function(n){var t=i.userFactsProvider.getUserFact(n.getName());return!n.isAMatch(t)}),n.length>0)?(t=n.map(function(n){return n.getName()}),l.FloodgateEngine.getTelemetryLogger().log_Event(li.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Summary,{Count:n.length,Message:t.toString()}),!1):!0:!1},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&y.validateUserFacts(this.userFacts)},t}(c);t.CampaignScopeUserFactAll=rt;a=function(){function n(){}return n.deserialize=function(n){var t;if(r(n))return null;switch(n.Type){case 0:t=ut.deserialize(n);break;case 1:t=ft.deserialize(n)}return void 0===t?null:t},n.prototype.validate=function(){return!0},n}();t.CampaignDuration=a;ut=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return n&&(i.intervalSeconds=n.IntervalSeconds),i.validate()?i:null},t.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&!!e(this.intervalSeconds)},t}(a);t.CampaignDurationTimeInterval=ut;ft=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(){return new t},t.prototype.asTimeIntervalSeconds=function(){return null},t}(a);t.CampaignDurationSingleBuildChange=ft;et=function(){function n(){}return n.deserialize=function(t){var i=new n,u,f;if(!r(t))for(i.additionalData=[],u=0,f=t;u<f.length;u++)"EmailAddress"===f[u]&&i.additionalData.push(0);return i.validate()?i:null},n.prototype.validate=function(){return!r(this.additionalData)},n}();t.CampaignAdditionalDataRequested=et;w=function(){function n(){}return n.deserialize=function(n){var t;return n&&0===n.Type&&(t=ot.deserialize(n)),void 0===t?null:t},n.prototype.validate=function(){return!0},n}();t.CampaignDistribution=w;ot=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return n&&(i.maxDelaySeconds=n.MaxDelaySeconds,i.chunks=n.Chunks),i.validate()?i:null},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&!(!e(this.maxDelaySeconds)||this.maxDelaySeconds<0)&&!(!e(this.chunks)||this.chunks<0)},t}(w);t.CampaignDistributionRamp=ot;b=function(){function n(){}return n.deserialize=function(n){var t;return n&&0===n.Type&&(t=st.deserialize(n)),void 0===t?null:t},n.prototype.getActiveSurveyTimeIntervalSeconds=function(){var n=this.nominationPeriod.asTimeIntervalSeconds();return e(n)?n:this.fallbackSurveyDurationSeconds},n.prototype.calculateSurveyStartTimeFromDate=function(n){return n||new Date},n.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(n){return n=n||new Date,o.addSecondsWithoutOverflow(n,this.getActiveSurveyTimeIntervalSeconds())},n.prototype.getCampaignCooldown=function(n){return n?this.cooldownPeriod:this.nominationPeriod},n.prototype.validate=function(){return!r(this.nominationPeriod)&&(r(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod),!(!e(this.nominationPeriod.asTimeIntervalSeconds())&&(!e(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0)))},n}();t.CampaignNominationScheme=b;st=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(n.DistributionModel&&(i.distributionModel=w.deserialize(n.DistributionModel)),n.CooldownPeriod&&(i.cooldownPeriod=a.deserialize(n.CooldownPeriod)),n.NominationPeriod&&(i.nominationPeriod=a.deserialize(n.NominationPeriod)),i.fallbackSurveyDurationSeconds=n.FallbackSurveyDurationSeconds,i.percentageDenominator=n.PercentageDenominator,i.percentageNumerator=n.PercentageNumerator,i.validate()?i:null)},t.prototype.evaluateNominationRules=function(){var n=Math.random();return Math.floor(n*this.percentageDenominator)<this.percentageNumerator},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&!(!e(this.percentageDenominator)||!e(this.percentageNumerator))&&!(this.percentageDenominator<=0||this.percentageNumerator<0)&&!(this.percentageNumerator>this.percentageDenominator)},t}(b);t.CampaignNominationSchemeRatioPercentage=st;s=function(){function n(){}return n.deserialize=function(n){var t;if(r(n))return null;switch(n.Type){case 0:t=k.deserialize(n);break;case 1:t=ht.deserialize(n)}return void 0===t?null:t},n.prototype.validate=function(){return!0},n}();t.CampaignSurveyEvent=s;k=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activity=n.Activity,i.count=n.Count,i.isAggregate=n.IsAggregate,i.validate()?i:null)},t.prototype.validate=function(){return!!n.prototype.validate.call(this)&&!(r(this.activity)||!f(this.activity))&&!(!e(this.count)||this.count<=0)&&!!fi(this.isAggregate)},t}(s);t.CampaignSurveyEventCountedActivity=k;ht=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var u=new t,i=[],f,e;if(r(n))return null;for(f in n.Sequence)n.Sequence.hasOwnProperty(f)&&(e=n.Sequence[f],e&&i.push(k.deserialize(e)));return 0===i.length&&(i=null),u.sequence=i,u.validate()?u:null},t.prototype.validate=function(){if(!n.prototype.validate.call(this)||r(this.sequence))return!1;for(var t in this.sequence)if(this.sequence.hasOwnProperty(t)&&!this.sequence[t])return!1;return!0},t}(s);t.CampaignSurveyEventCountedActivitySequence=ht;v=function(){function n(){}return n.deserialize=function(t,i){var u=new n;return r(t)?null:(u.prompt=at.deserialize(t.Prompt),u.rating=yt.deserialize(t.Rating),u.comment=pt.deserialize(t.Question),u.multipleChoice=ct.deserialize(t.MultipleChoice),u.intercept=vt.deserialize(t.Intercept),u.cvSurvey=lt.deserialize(t.CVSurveyParams),u.validate(i)?u:null)},n.prototype.validate=function(n){return!r(this.intercept)||!r(this.prompt)&&(n?!r(this.rating)||!r(this.multipleChoice)||!r(this.comment):!r(this.rating)&&!r(this.comment))},n}();t.CampaignSurveyContent=v;ct=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.question=t.Question,i.availableOptions=t.AvailableOptions,i.minNumberOfSelectedOptions=t.MinNumberOfSelectedOptions,i.maxNumberOfSelectedOptions=t.MaxNumberOfSelectedOptions,i.validate()?i:null)},n.prototype.validate=function(){if(r(this.question)||!f(this.question)||r(this.availableOptions)||!Array.isArray(this.availableOptions)||this.availableOptions.length<2||r(this.minNumberOfSelectedOptions)||!e(this.minNumberOfSelectedOptions)||r(this.maxNumberOfSelectedOptions)||!e(this.maxNumberOfSelectedOptions))return!1;for(var n in this.availableOptions)if(this.availableOptions.hasOwnProperty(n)&&!f(this.availableOptions[n]))return!1;return!0},n}();t.CampaignSurveyContentMultipleChoice=ct;lt=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.customerVoiceFormId=t.CustomerVoiceFormId,i.validate()?i:null)},n.prototype.validate=function(){return!r(this.customerVoiceFormId)&&f(this.customerVoiceFormId)},n}();t.CampaignSurveyContentCVSurvey=lt;at=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.title=t.Title,i.question=t.Question,i.yesLabel=t.YesLabel,i.noLabel=t.NoLabel,i.validate()?i:null)},n.prototype.validate=function(){return!(r(this.title)||!f(this.title)||r(this.question)||!f(this.question)||r(this.yesLabel)||!f(this.yesLabel)||r(this.noLabel)||!f(this.noLabel))},n}();t.CampaignSurveyContentPrompt=at;vt=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.title=t.Title,i.question=t.Question,i.url=t.Url,i.validate()?i:null)},n.prototype.validate=function(){return!(r(this.title)||!f(this.title)||r(this.question)||!f(this.question)||r(this.url)||!f(this.url))},n}();t.CampaignSurveyContentIntercept=vt;yt=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.isZeroBased=t.IsZeroBased,i.question=t.Question,i.ratingValuesAscending=t.RatingValuesAscending,i.validate()?i:null)},n.prototype.validate=function(){if(r(this.question)||!f(this.question)||r(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||this.ratingValuesAscending.length>11)return!1;if(r(this.isZeroBased))this.isZeroBased=!1;else if(!fi(this.isZeroBased))return!1;for(var n in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(n)&&!f(this.ratingValuesAscending[n]))return!1;return!0},n}();t.CampaignSurveyContentRating=yt;pt=function(){function n(){}return n.deserialize=function(t){var i=new n;return r(t)?null:(i.question=t.Question,i.validate()?i:null)},n.prototype.validate=function(){return!(r(this.question)||!f(this.question))},n}();t.CampaignSurveyContentComment=pt;wt=function(){function n(){}return n.deserialize=function(t){if(r(t))return null;var i=new n;return i.contentMetadata=t.ContentMetadata,i.validate()?i:null},n.prototype.validate=function(){return!(r(this.contentMetadata)||!o.isObject(this.contentMetadata))},n}();t.CampaignSurveyMetadata=wt;h=function(){function n(){}return n.deserialize=function(n){var t;if(r(n))return null;switch(n.Type){case 0:t=gt.deserialize(n);break;case 1:t=ni.deserialize(n);break;case 2:t=bt.deserialize(n);break;case 3:t=kt.deserialize(n);break;case 4:t=dt.deserialize(n);break;case 22:t=ti.deserialize(n);break;case 5:t=ii.deserialize(n)}return r(t)?null:t},n.prototype.validate=function(){return!r(this.activationEvent)},n}();t.CampaignSurveyTemplate=h;bt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.content=v.deserialize(n.Content,!0),i.validate()?i:null)},t.prototype.validate=function(){return!(!n.prototype.validate.call(this)||r(this.content))},t}(h);t.CampaignSurveyTemplateFps=bt;kt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.content=v.deserialize(n.Content),i.validate()?i:null)},t.prototype.validate=function(){return!(!n.prototype.validate.call(this)||r(this.content))},t}(h);t.CampaignSurveyTemplateNlqs=kt;dt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.content=v.deserialize(n.Content),i.validate()?i:null)},t.prototype.validate=function(){return!(!n.prototype.validate.call(this)||r(this.content))},t}(h);t.CampaignSurveyTemplateNps=dt;gt=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.validate()?i:null)},t.prototype.validate=function(){return!!n.prototype.validate.call(this)},t}(h);t.CampaignSurveyTemplateNps5PointStatic=gt;ni=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.validate()?i:null)},t.prototype.validate=function(){return!!n.prototype.validate.call(this)},t}(h);t.CampaignSurveyTemplateNps11PointStatic=ni;ti=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){if(r(n))return null;var i=new t;return i.activationEvent=s.deserialize(n.ActivationEvent),i.metadata=wt.deserialize(n.Metadata),i.maxLaunches=n.MaxLaunches,i.maxLaunchesPerSession=n.MaxLaunchesPerSession,i.preferredLaunchType=n.PreferredLaunchType,i.validate()?i:null},t.prototype.validate=function(){return!(!n.prototype.validate.call(this)||r(this.metadata))&&(!r(this.maxLaunches)&&(!e(this.maxLaunches)||this.maxLaunches<=0)||!r(this.maxLaunchesPerSession)&&(!e(this.maxLaunchesPerSession)||this.maxLaunchesPerSession<=0)?(l.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid Multi Launch settings",this.maxLaunches,this.maxLaunchesPerSession),!1):e(this.maxLaunches)&&e(this.maxLaunchesPerSession)&&this.maxLaunchesPerSession>this.maxLaunches?(l.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid Multi launch settings",this.maxLaunches,this.maxLaunchesPerSession),!1):!(!r(this.preferredLaunchType)&&!f(this.preferredLaunchType))||(l.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid launcher type",this.preferredLaunchType),!1))},t}(h);t.CampaignSurveyTemplateGenericMessagingSurface=ti;ii=function(n){function t(){return n.call(this)||this}return u(t,n),t.deserialize=function(n){var i=new t;return r(n)?null:(i.activationEvent=s.deserialize(n.ActivationEvent),i.content=v.deserialize(n.Content),i.validate()?i:null)},t.prototype.validate=function(){return!(!n.prototype.validate.call(this)||r(this.content))},t}(h);t.CampaignSurveyTemplateIntercept=ii;ri=function(){function n(){}return n.deserialize=function(t){var i=new n,u;return r(t)?null:(i.campaignId=t.CampaignId,i.governedChannelType=t.GovernedChannelType,i.startTime=t.StartTimeUtc,i.endTime=t.EndTimeUtc,i.launcherType=t.LauncherType,i.primaryPriority=t.PrimaryPriority,i.tags=t.Tags,u=et.deserialize(t.AdditionalDataRequested),i.additionalDataRequested=u?u.additionalData:[],t.SurveyTemplate&&(i.surveyTemplate=h.deserialize(t.SurveyTemplate)),t.NominationScheme&&(i.nominationScheme=b.deserialize(t.NominationScheme)),t.Scope&&(i.scope=c.deserialize(t.Scope)),r(t.BusinessLevel)||(i.businessLevel=t.BusinessLevel),i.validate()?i:(l.FloodgateEngine.getTelemetryLogger().log_LocalError("Invalid definition",t),null))},n.prototype.validate=function(){var n,t;if((r(this.scope)&&(this.scope=new p),r(this.campaignId)||!f(this.campaignId))||!e(this.governedChannelType)||!o.isEnumValue(this.governedChannelType,ai.GovernedChannelType)||r(this.nominationScheme)||r(this.surveyTemplate)||!r(this.launcherType)&&!f(this.launcherType)||"customervoice"===this.launcherType&&r(null===(t=null===(n=this.surveyTemplate.content)||void 0===n?void 0:n.cvSurvey)||void 0===t?void 0:t.customerVoiceFormId)||!r(this.primaryPriority)&&!e(this.primaryPriority)||this.tags&&!Array.isArray(this.tags))return!1;if(r(this.startTime))this.startTime=ui();else{if(!ei(this.startTime))return!1;this.startTime=oi(this.startTime)}if(r(this.endTime)||"string"==typeof this.endTime&&""===this.endTime)this.endTime=ui();else{if(!ei(this.endTime))return!1;this.endTime=oi(this.endTime)}return!0},n}();t.CampaignDefinition=ri;t.FilterValidCampaignDefinitions=si;hi=function(){function n(n){if(r(n))throw new Error("storage must not be null");this.storage=n}return n.prototype.load=function(){var n,t=this.storage.read(ci.FileType.CampaignDefinitions);if(r(t))return[];try{n=JSON.parse(t)}catch(n){return l.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(n.toString()),[]}return si(n).result},n.prototype.loadAsync=function(){var n=this.load();return new Promise(function(t){t(n)})},n}();t.FileSystemCampaignDefinitionProvider=hi},function(n,t,i){"use strict";function s(n,t,i,u){if(void 0===t)return Promise.reject(new Error("Manifest cannot be undefined"));var s,f,h,c,l,e,a,o=new FormData;return o.append("Manifest",t),i&&o.append("Screenshot",i),u&&o.append("Diagnostics",u),s="POST",f=n?"https://petrol.office.microsoft.com/v1/feedback":"https://petrol-int.office.microsoft.com/v1/feedback",h=o,c=2,l=function(n,t,i){200!==n.status&&i(new Error("Non-200 response with status code: "+n.status+", response: "+n.responseText));t()},e=function(n,t){return new Promise(function(i,r){var u=new XMLHttpRequest;u.open(s,f,!0);u.timeout=t;u.onload=function(){l(u,i,r)};u.ontimeout=function(){n>0?e(n-1,2*t).then(i,r):r(new Error("Request to '"+f+"' timed out. timeout: "+u.timeout))};u.onerror=function(){n>0?e(n-1,t).then(i,r):r(new Error("Request to '"+f+"' errored. "+u.status+" - "+u.statusText+" : "+u.responseText))};u.send(h)})},a=r.get().getCommonInitOptions().petrolTimeout?r.get().getCommonInitOptions().petrolTimeout:8e3,e(c,a)}function a(n){return"Survey"===n?n:c.b[n]}var o;i.d(t,"a",function(){return o});var f=i(6),e=i(4),u=i(2),r=i(1);var h=function(){function n(n){this.screenshot=n}return n.prototype.getContent=function(){var n;try{n=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(t){u.b().logEvent(u.a.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,2,{ErrorMessage:t.toString()});n="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var t=atob(n),r=[],i=0;i<t.length;i++)r.push(t.charCodeAt(i));return new Blob([new Uint8Array(r)],{type:"image/jpeg"})},n}(),c=i(7),l=function(){function n(n,t,i,r,u,f,e,o){this.manifestData={appId:t,application:f,clientFeedbackId:u,manifestType:n,source:"Client",submitTime:i,telemetry:e,type:a(r),web:o}}return n.prototype.getExtendedManifestData=function(){return this.manifestData.application.extendedManifestData},n.prototype.setComment=function(n){this.manifestData.comment=n},n.prototype.setEmail=function(n){this.manifestData.email=n},n.prototype.setCategory=function(n){this.manifestData.telemetry=this.manifestData.telemetry||{};this.manifestData.telemetry.featureArea=n},n.prototype.setAppData=function(n){this.manifestData.application=this.manifestData.application||{};this.manifestData.application.appData=n},n.prototype.setExtendedManifestData=function(n){this.manifestData.application=this.manifestData.application||{};this.manifestData.application.extendedManifestData=n},n.prototype.setClientFeedbackId=function(n){this.manifestData.clientFeedbackId=n},n.prototype.getClientFeedbackId=function(){return this.manifestData.clientFeedbackId},n.prototype.setComplianceInformation=function(n,t,i,r,u,f){this.manifestData.complianceChecks={authenticationType:n,ageGroup:t,policyAllowFeedback:i,policyAllowSurvey:r,policyAllowScreenshot:u,policyAllowContact:f}},n.prototype.setValues=function(n){if(n)for(var t in n)n.hasOwnProperty(t)&&(this.manifestData[t]=this.manifestData.hasOwnProperty(t)?e.m(n[t],this.manifestData[t]):n[t])},n.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})},n}();o=function(){function n(n,t,i,u,o,s,h){var c,a,v,y,p,w,b,k;this.clientFeedbackId=e.i();this.manifest=new l(t,i,(new Date).toISOString(),u,this.clientFeedbackId,Object(f.a)({},o),Object(f.a)({},s),Object(f.a)({},h));this.environment=n;this.manifest.setComplianceInformation(r.AuthenticationType[null!==(a=null===(c=r.get().getCommonInitOptions())||void 0===c?void 0:c.authenticationType)&&void 0!==a?a:r.AuthenticationType.Unauthenticated],r.AgeGroup[null!==(y=null===(v=r.get().getCommonInitOptions())||void 0===v?void 0:v.ageGroup)&&void 0!==y?y:r.AgeGroup.Undefined],this.ocpsEnumToString(null===(p=r.get().getInAppFeedbackInitOptions())||void 0===p?void 0:p.sendFeedbackPolicyValue),this.ocpsBooleanToString(null===(w=r.get().getFloodgateInitOptions())||void 0===w?void 0:w.surveyEnabled),this.ocpsEnumToString(null===(b=r.get().getCommonInitOptions())||void 0===b?void 0:b.screenshotPolicyValue),this.ocpsEnumToString(null===(k=r.get().getCommonInitOptions())||void 0===k?void 0:k.emailPolicyValue))}return n.prototype.getClientFeedbackId=function(){return this.clientFeedbackId},n.prototype.getExtendedManifestData=function(){return this.manifest.getExtendedManifestData()},n.prototype.setComment=function(n){this.manifest.setComment(n)},n.prototype.setEmail=function(n){this.manifest.setEmail(n)},n.prototype.setCategory=function(n){this.manifest.setCategory(n)},n.prototype.setAppData=function(n){this.manifest.setAppData(n)},n.prototype.setExtendedManifestData=function(n){this.manifest.setExtendedManifestData(n)},n.prototype.setScreenshot=function(n){this.screenshot=new h(n)},n.prototype.setClientFeedbackId=function(n){this.manifest.setClientFeedbackId(n)},n.prototype.getManifest=function(){return this.manifest},n.prototype.setManifestValues=function(n){this.manifest.setValues(n)},n.prototype.submit=function(){if(!r.get().isFeedbackSurveyEnabledByAADC())return u.b().logEvent(u.a.Shared.Upload.Prevented.VALUE,2,{Data:JSON.stringify({ageGroup:r.get().getCommonInitOptions().ageGroup,authenticationType:r.get().getCommonInitOptions().authenticationType})}),Promise.resolve();var i=this.manifest.getContent(),n=void 0,t=this.clientFeedbackId;return this.screenshot&&(n=this.screenshot.getContent()),s(0===this.environment,i,n).catch(function(n){r.get().getCommonInitOptions().onError("Payload submission failed: "+n.message+". ClientFeedbackId: "+t);u.b().logEvent(u.a.Shared.Upload.Failed.VALUE,2,{ErrorMessage:n.message,ClientFeedbackId:t})})},n.prototype.ocpsBooleanToString=function(n){return void 0===n?"Not Configured":n?"Enabled":"Disabled"},n.prototype.ocpsEnumToString=function(n){if(!n)return"Not Configured";switch(n){case 2:return"Disabled";case 1:return"Enabled";default:return"Not Configured"}},n}()},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GovernanceServiceClientState=t.GovernanceServiceSurveyType=void 0,function(n){n[n.Unknown=0]="Unknown";n[n.Feedback=1]="Feedback";n[n.Nps=2]="Nps";n[n.Psat=4]="Psat";n[n.Bps=6]="Bps";n[n.Fps=8]="Fps";n[n.Nlqs=18]="Nlqs";n[n.GenericMessagingSurface=22]="GenericMessagingSurface";n[n.Intercept=24]="Intercept"}(t.GovernanceServiceSurveyType||(t.GovernanceServiceSurveyType={})),function(n){n[n.Disabled=0]="Disabled";n[n.InitializationFailed=1]="InitializationFailed";n[n.Enabled=2]="Enabled"}(t.GovernanceServiceClientState||(t.GovernanceServiceClientState={}))},function(n,t,i){"use strict";var h=i(18),c=i(17),u=i(35),f=i(10),l=f.getDistantFuture,e=f.getDistantPast,r=f.isNOU,s=f.isDate,o=function(){function n(n){if(r(n))throw new Error("data must not be null");if(r(n.id)||""===n.id)throw new Error("data.id must not be null or empty");if(r(n.governedChannelType)&&(n.governedChannelType=c.GovernedChannelType.getDefault()),r(n.expirationTimeUtc)||""===n.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(r(n.activationEvent))throw new Error("data.activationEvent must not be null");(r(n.backEndIdentifier)||""===n.backEndIdentifier)&&(n.backEndIdentifier=n.id);r(n.launcherType)&&(n.launcherType=h.LAUNCHER_TYPE_DEFAULT);this.data=n}return n.prototype.getId=function(){return this.data.id},n.prototype.getBackEndId=function(){return this.data.backEndIdentifier},n.prototype.getGovernedChannelType=function(){return this.data.governedChannelType},n.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc},n.prototype.getStartTimeUtc=function(){if(r(this.data.startTimeUtc))return e();var n=new Date(this.data.startTimeUtc);return s(n)?n:l()},n.prototype.getExpirationTimeUtc=function(){if(r(this.data.expirationTimeUtc))return e();var n=new Date(this.data.expirationTimeUtc);return s(n)?n:e()},n.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc},n.prototype.isActiveForDate=function(n){return!r(n)&&n>=this.getStartTimeUtc()&&n<=this.getExpirationTimeUtc()},n.prototype.getActivationEvent=function(){return this.data.activationEvent},n.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType},n.prototype.isAdditionalDataRequested=function(n){if(r(this.data.additionalDataRequested))return!1;for(var t=0,i=this.data.additionalDataRequested;t<i.length;t++)if(i[t]===n)return!0;return!1},n.prototype.getLauncherType=function(){return this.data.launcherType},n.prototype.getMetadata=function(){return this.data.metadata},n.prototype.getBusinessLevel=function(){return this.data.businessLevel},n.prototype.getMaxLaunches=function(){return this.data.maxLaunches},n.prototype.getMaxLaunchesPerSession=function(){return this.data.maxLaunchesPerSession},n.prototype.getDomElements=function(n){var t,i;if(!n)throw new Error("Document must not be null");return t=n.createElement(u.DOM_TYPE_TAGNAME),t.appendChild(n.createTextNode(u.DOM_TYPE_VALUE)),i=n.createElement(u.DOM_ID_TAGNAME),i.appendChild(n.createTextNode(this.getBackEndId())),[t,i]},n.prototype.getJsonElements=function(){var t={},n;return t[u.JSON_ID_KEYNAME]=this.getBackEndId(),n={},n[u.JSON_SURVEY_KEYNAME]=t,n},n}();!function(n){var t=function(){this.preferredLaunchType="Default"};n.SurveyDataSourceData=t}(o||(o={}));n.exports=o},function(n,t,i){"use strict";function f(n,t){return u(n||document.body,Object(r.a)({background:"#ffffff"},t))}i.d(t,"a",function(){return f});var r=i(6),u=i(48)},function(n,t,i){"use strict";function s(){if(!e){if(!u.a().OfficeBrowserFeedback.initOptions)throw new Error("Window.OfficeBrowserFeedback.initOptions not set");u.a().OfficeBrowserFeedback.sdkVersion="1.7.4";r.get().setCommonInitOptions(u.a().OfficeBrowserFeedback.initOptions);o=r.get().isFeedbackSurveyEnabledByAADC();f.c(r.get().getCommonInitOptions(),"OfficeFeedbackSDK","1.7.4",r.get().getSdkSessionId(),r.get().getEventSampling());e=!0;o||f.b().logEvent(f.a.FEEDBACK_SURVEYSDISABLED_AADC,1,{Data:JSON.stringify({ageGroup:r.get().getCommonInitOptions().ageGroup,authenticationType:r.get().getCommonInitOptions().authenticationType})})}}function h(){e=!1}i.d(t,"a",function(){return s});i.d(t,"b",function(){return h});i(54);var r=i(1),u=i(8),f=i(2),e=!1,o=!1;u.l(function(){return o})},function(n,t,i){"use strict";function a(){return new Promise(function(n,t){var i,h,o;f?n():(i=u.get().getCommonInitOptions(),(i||t("initOptionsCommon is null"),(i.customResourcesSetExternally&u.CustomResources.Css)===u.CustomResources.Css)?(h="#"+r.d.TPromptTitle,Object(c.a)(h)||t("Expected custom Css to be set by host but "+h+" was not found to be set.")):Object(s.b)(i.stylesUrl),(function(n,t){void 0===n&&(n=void 0);void 0===t&&(t=void 0);n||(n="#0167B0");t||(t="#194789");var i=document.createElement("style");i.textContent="."+r.c.OverallAnchor+":focus { background-color: "+n+" } ."+r.c.OverallAnchor+":hover { background-color: "+t+" } ."+r.c.OverallAnchorActive+" { background-color: "+n+" } ."+r.c.SpinnerCircle+" { background-color: "+n+" } ."+r.c.ChoiceGroup+" input[type=radio]:checked+label>."+r.c.ChoiceGroupIcon+" { border-color: "+n+" } ."+r.c.ChoiceGroup+" input[type=radio]:hover+label>."+r.c.ChoiceGroupIcon+" { border-color: "+t+" } ."+r.c.ChoiceGroup+" input[type=radio]:checked+label>."+r.c.ChoiceGroupIcon+">span { background-color: "+n+" } ."+r.c.SubmitButton+" { background-color: "+n+" } ."+r.c.SubmitButton+":hover { background-color: "+t+" } ."+r.c.CancelButton+" { background-color: "+n+" } ."+r.c.CancelButton+":hover { background-color: "+t+" } ."+r.c.Link+" { color: "+n+" } ."+r.c.Link+":hover { color: "+t+" } ."+r.c.ThanksPanelTitle+" { color: "+n+" } #"+r.d.TPromptTitle+" { color: "+n+" } #"+r.d.TFormTitle+" { color: "+n+" } ";document.body.appendChild(i)}(i.primaryColour,i.secondaryColour),(i.customResourcesSetExternally&u.CustomResources.Strings)===u.CustomResources.Strings)?(e.a()||t("Expected custom strings to be set by host but UIStrings.getUIStrings() is null or undefined"),f=!0,n()):(o=i.intlUrl+i.locale.toLowerCase()+"/"+i.intlFilename,Object(s.a)(o).then(function(){e.a()?(f=!0,n()):t("UiStrings were not loaded from "+o)}).catch(function(n){t("Script load failed for "+o+". "+n)})))})}function v(){f=!1}i.d(t,"a",function(){return a});i.d(t,"b",function(){return v});var e=i(5),u=i(1),o=i(8),r=i(0),h=i(25),s=i(30),c=i(4),l=i(48),f=!1;o.n(function(n){e.b(n)});o.d(h.a);o.a().OfficeBrowserFeedback.html2canvas=l},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Survey=void 0;var r=i(18),u=i(20),f=i(10),e=function(){function n(){}return n.prototype.getCampaignId=function(){return this.getSurveyInfo().getBackEndId()},n.prototype.getLauncherType=function(){return this.getSurveyInfo().getLauncherType()},n.prototype.getClientFeedbackId=function(){return this.clientFeedbackId},n.prototype.submit=function(){var t=r.Type[this.getType()],n=u.FloodgateEngine.getTransportFactory().makeTransporter(t);n.setManifestValues(this.getJsonElements());this.clientFeedbackId=n.getClientFeedbackId();n.submit()},n.prototype.getPreGeneratedClientFeedbackId=function(){return this.clientFeedbackId?this.clientFeedbackId:this.clientFeedbackId=f.guid()},n}();t.Survey=e},function(n,t){"use strict";var r=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var u,r=0,f=t.length;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},i;Object.defineProperty(t,"__esModule",{value:!0});t.SchemaObject=void 0;i=function(){function n(t){n.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_SchemaObject"},n.getBaseTypes=function(){return[]},n.getTypeNameFor=function(n){if(n&&n.H_)return n.H_.T_},n.getBaseTypesFor=function(n){return n&&n.H_&&n.H_.B_?n.H_.B_:[]},n.getAllTypesFor=function(t){var i=n.getTypeNameFor(t);return i?r([i],n.getBaseTypesFor(t),!0):[]},n.matchesTypesFor=function(t,i){var u;if(!Array.isArray(i)||0===i.length)return!0;for(var e=n.getTypeNameFor(t),o=n.getBaseTypesFor(t),r=0,f=i;r<f.length;r++)if((u=f[r],u===e)||o.indexOf(u)>=0)return!0;return!1},n.assign=function(n,t,i){var r,u,f;if(i)for(r=0,u=Object.keys(i);r<u.length;r++)f=u[r],t[f]=i[f];return t.H_=n.H_,t},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.SchemaObject=i},function(n,t,i){"use strict";function r(n){var t=document.createElement("link"),i;t.rel="stylesheet";t.type="text/css";t.href=n;i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i)}function u(n,t){return void 0===t&&(t=window.origin),new Promise(function(i,r){var u=document.createElement("script"),f;u.async=!0;u.readyState?u.onreadystatechange=function(){"loaded"!==u.readyState&&"complete"!==u.readyState||(u.onreadystatechange=null,i())}:u.onload=function(){i()};u.onerror=function(){r()};u.src=n;t&&"null"!==t&&(u.crossOrigin="anonymous");f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(u,f)})}i.d(t,"b",function(){return r});i.d(t,"a",function(){return u})},function(n,t,i){"use strict";function u(n,t){var i,e,f,o,s,h;if(void 0===n.brs&&(n.brs=!0),!n.brs)return null;if(n.tag||(n.tag=r.h.Div),n.tag===r.h.Svg&&(t=!0),i=t?document.createElementNS("http://www.w3.org/2000/svg",n.tag):document.createElement(n.tag),n.attributes)for(e=void 0,f=0;f<n.attributes.length;f++)(e=n.attributes[f]).name===r.a.xlinkHref?i.setAttributeNS("http://www.w3.org/1999/xlink",r.a.HRef,e.value):i.setAttribute(e.name,e.value);if((n.id&&(i.id=n.id),n.classes)&&(o=n.classes.join(" "),t?i.setAttribute(r.a.Class,o):i.className=o),n.innerText&&!t&&(i.textContent=n.innerText),n.innerHTML&&!t&&(i.innerHTML=n.innerHTML),n.children)for(f=0;f<n.children.length;f++)s=n.children[f],s&&(h=u(s,t),h&&i.appendChild(h));return i}i.d(t,"a",function(){return u});var r=i(0)},function(n,t,i){"use strict";var u,e;Object.defineProperty(t,"__esModule",{value:!0});t.Governor=t.DEFAULT_TEACHING_MESSAGE_COOLDOWN=void 0;var r=i(17),o=i(45),f=i(10).isNOU;t.DEFAULT_TEACHING_MESSAGE_COOLDOWN=15;u=function(n,t){this.name=n;this.cooldownSeconds=t};e=function(){function n(n){if(this.channels=[],!n)throw new Error("channelStateProvider must not be null");this.channelStateProvider=n;this.loadChannels()}return n.GetChannelCoolDown=function(t){var i=n.defaultChannelData[t];return i?i.cooldownSeconds:0},n.SetDefaultChannelCoolDown=function(t,i){var r=n.defaultChannelData[t];r&&(r.cooldownSeconds=i)},n.prototype.refreshChannelData=function(){this.loadChannels()},n.prototype.getAvailableChannelData=function(){var i=[],n,t;for(n in this.channels)this.channels.hasOwnProperty(n)&&(t=this.channels[n],t.isOpen()&&i.push(t));return i},n.prototype.isChannelOpen=function(n){if(f(n))throw new Error("type must not be null");return this.channels[n].isOpen()},n.prototype.startChannelCooldown=function(n,t){if(f(n))throw new Error("type must not be null");t=t||new Date;this.channels[n].setCooldownStartTime(t);this.saveChannelStates()},n.prototype.saveChannelStates=function(){var i=[],n,t,r;for(n in this.channels)this.channels.hasOwnProperty(n)&&(t=this.channels[n],r=new o.GovernedChannelState(t.getType(),t.getCooldownStartTime()),i.push(r));this.channelStateProvider.save(i)},n.prototype.loadChannels=function(){var i,t,u,f;for(i in this.loadChannelStatesFromProvider(),r.GovernedChannelType)if(r.GovernedChannelType.hasOwnProperty(i)){if(t=Number(i),isNaN(t)||this.channels[t])continue;u=n.defaultChannelData[t];f=new r.GovernedChannel(t,u.name,u.cooldownSeconds,null);this.channels[t]=f}},n.prototype.loadChannelStatesFromProvider=function(){var t,i;this.channels=[];t=this.channelStateProvider.load();for(i in t)if(t.hasOwnProperty(i)){var u=t[i],f=u.getType(),e=n.defaultChannelData[f],o=new r.GovernedChannel(f,e.name,e.cooldownSeconds,u.getCooldownStartTime());this.channels[o.getType()]=o}},n.minute=60,n.hour=60*n.minute,n.day=24*n.hour,n.defaultChannelData=[new u(r.GovernedChannelType[r.GovernedChannelType.Standard],14*n.day),new u(r.GovernedChannelType[r.GovernedChannelType.Urgent],0),new u(r.GovernedChannelType[r.GovernedChannelType.Banner],15*n.day),new u(r.GovernedChannelType[r.GovernedChannelType.TeachingMessage],t.DEFAULT_TEACHING_MESSAGE_COOLDOWN*n.day)],n}();t.Governor=e},function(n,t,i){"use strict";i.d(t,"a",function(){return o});var f=i(15),e=i(4),r=i(14),u=e.l,o=function(){function n(n){this.useLocalStorage=!1;this.cachedItems={};this.initialize(n)}return n.prototype.setContentItem=function(n,t,i){var r=this.createItem(n,t,i);return this.setItem(r),r},n.prototype.getItemContent=function(n){var t=this.getItem(n);return t&&t.content},n.prototype.has=function(n){return n in this.cachedItems},n.prototype.isItemExpired=function(n){var t=this.getItem(n);return!t||!t.expiryDate||t.expiryDate<new Date},n.prototype.createItem=function(n,t,i){return{contentType:n,content:t,expiryDate:new Date(Date.now()+i),lastRetrievedDate:new Date}},n.prototype.setItem=function(n){this.cachedItems[n.contentType]=n;this.updateItemInLocalStorage(n)},n.prototype.getItem=function(n){return this.cachedItems[n]},n.prototype.initialize=function(n){this.cachedItems={};f.a.isStorageAvailable()&&(this.floodgateStorage=new f.a,this.useLocalStorage=!0,this.initCachedItemsFromLocalStorage(n))},n.prototype.initCachedItemsFromLocalStorage=function(n){var i,r,e,f,t;if(this.useLocalStorage&&!u(n))for(i=0,r=n;i<r.length;i++)e=r[i],f=this.floodgateStorage.read(this.mapContentTypeToFloodgateProviderKey(e)),u(f)||(t=this.parseObjectFromCache(f),u(t)||(t.expiryDate="string"==typeof t.expiryDate?new Date(t.expiryDate):t.expiryDate,this.cachedItems[t.contentType]=t))},n.prototype.updateItemInLocalStorage=function(n){this.useLocalStorage&&this.floodgateStorage.write(this.mapContentTypeToFloodgateProviderKey(n.contentType),JSON.stringify(n))},n.prototype.parseObjectFromCache=function(n){try{return JSON.parse(n)}catch(n){return null}},n.prototype.mapContentTypeToFloodgateProviderKey=function(n){switch(n){case"CampaignContent":return r.FileType.TmsCache_CampaignContent;case"MessageMetadata":return r.FileType.TmsCache_MessageMetadata;case"UserGovernance":return r.FileType.TmsCache_UserGovernance;case"DynamicSettings":return r.FileType.Tms_DynamicSettings;case"LogLevelSettings":return r.FileType.LogLevelSettings;case"UserFacts":return r.FileType.UserFacts;default:throw new Error("Unmapped ContentType in TmsCache");}},n}()},function(n,t,i){"use strict";function o(n){var i,t=(i=n.element,parseFloat(window.getComputedStyle(i).getPropertyValue("opacity"))-1/8);t<=0&&(t=1);u(n.element,t)}function u(n,t){n.style.opacity=t.toString()}function s(){var n=document.createElement("div");return n.classList.add(f.c.SpinnerCircle),n.style.width=n.style.height=34*.2+"px",n}i.d(t,"a",function(){return e});var f=i(0),r=i(3),e=function(){function n(n){this.circleObjects=[];this.spinnerId=n;this.spinner=document.getElementById(this.spinnerId);this.createCirclesAndArrange();this.initializeOpacities();this.start();r.l(n,!0)}return n.prototype.destroy=function(){r.l(this.spinnerId,!1);this.stop()},n.prototype.start=function(){var n=this;this.stop();this.interval=setInterval(function(){for(var t=n.circleObjects.length;t--;)o(n.circleObjects[t])},90)},n.prototype.stop=function(){clearInterval(this.interval)},n.prototype.createCirclesAndArrange=function(){for(var i,t=0,u=Math.PI/4,r=8;r--;){var n=s(),f=Math.round(17+13.6*Math.cos(t)-.5*n.clientWidth)-34*.2*.5,e=Math.round(17+13.6*Math.sin(t)-.5*n.clientHeight)-34*.2*.5;this.spinner.appendChild(n);n.style.left=f+"px";n.style.top=e+"px";t+=u;i={element:n,j:r};this.circleObjects.push(i)}},n.prototype.initializeOpacities=function(){for(var t,n=0,i=1;n<8;n++)t=1/8*i++,u(this.circleObjects[n].element,t)},n}()},function(n){"use strict";var t;!function(n){!function(n){n[n.None=0]="None";n[n.Critical=1]="Critical"}(n.BusinessLevel||(n.BusinessLevel={}));n.DOM_TYPE_TAGNAME="Type";n.DOM_TYPE_VALUE="Survey";n.DOM_ID_TAGNAME="SurveyID";n.JSON_SURVEY_KEYNAME="survey";n.JSON_ID_KEYNAME="surveyId"}(t||(t={}));n.exports=t},function(n,t,i){"use strict";var e,r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.MergeAndUpdateSurveyActivationStats=t.MergeAndUpdateCampaignStates=t.MergeAndUpdateGovernedChannelStates=t.makeSettingItemValue=t.extractSettingItemValueSubString=t.ItemCollection=void 0;e=i(42);r=function(){function n(){this.items={};this.itemCount=0}return n.prototype.add=function(n,t){this.items[n]||this.itemCount++;this.items[n]=t},n.prototype.find=function(n){return this.items[n]},n.prototype.remove=function(n){var t=this.items[n];return t&&(delete this.items[n],this.itemCount--),t},n.prototype.count=function(){return this.itemCount},n}();t.ItemCollection=r;t.extractSettingItemValueSubString=function(n){if(!n)return n;var t=n.indexOf(u)+u.length,i=n.indexOf(f);return t<0||i<0?n:n.substring(t,i)};t.makeSettingItemValue=function(n){return n?u+n+f:u+f};t.MergeAndUpdateGovernedChannelStates=function(n,t){var i=new r,u,f;return!n&&!t?i:n?t?(u=[],f=[],n&&n.forEach(function(n){for(var r,e=-1,i=0;i<t.length;i++)if((r=t[i]).getType()===n.getType()){e=i;break}if(-1===e)return u.push(n),void f.push(n);n.getCooldownStartTime()>r.getCooldownStartTime()?(u.push(n),f.push(n)):u.push(r);t.splice(e,1)}),t&&t.forEach(function(n){u.push(n)}),i.add(0,u),f.length>0&&i.add(1,f),i):(i.add(0,n),i.add(1,n),i):(i.add(0,t),i)};t.MergeAndUpdateCampaignStates=function(n,t){var i=new r,u,f;return!n&&!t?i:n?t?(u=[],f=[],n&&n.forEach(function(n){for(var i,o=new Date,r=-1,e=0;e<t.length;e++)if((i=t[e]).CampaignId===n.CampaignId){r=e;break}return-1===r?(u.push(n),void f.push(n)):i.LastCooldownEndTimeUtc>o?(u.push(i),void t.splice(r,1)):n.LastCooldownEndTimeUtc>o?(u.push(n),f.push(n),void t.splice(r,1)):(n.getCooldownStartDate()>i.getCooldownStartDate()||n.getCooldownStartDate()===i.getCooldownStartDate()&&n.LastNominationTimeUtc>i.LastNominationTimeUtc?(u.push(n),f.push(n)):u.push(i),void t.splice(r,1))}),t&&t.forEach(function(n){u.push(n)}),i.add(0,u),f.length>0&&i.add(1,f),i):(i.add(0,n),i.add(1,n),i):(i.add(0,t),i)};t.MergeAndUpdateSurveyActivationStats=function(n,t){var u=new r,c,i,l,a;if(!n&&!t)return u;if(!n)return u.add(0,t),u;if(!t)return u.add(0,n),u.add(1,n),u;var s=new e.SurveyStatCollectionActivation,h=new e.SurveyStatCollectionActivation,f=n.getStats(),o=t.getStats();for(i in f)if(f.hasOwnProperty(i)){if(c=o[i],!c){s.addStats(i,f[i]);h.addStats(i,f[i]);continue}f[i].ActivationTimeUtc>c.ActivationTimeUtc?(s.addStats(i,f[i]),h.addStats(i,f[i])):s.addStats(i,o[i]);delete o[i]}for(i in o)o.hasOwnProperty(i)&&s.addStats(i,o[i]);u.add(0,s);l=h.getStats();for(a in l)if(l.hasOwnProperty(a)){u.add(1,h);break}return u};u="<data>";f="<\/data>"},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.question)throw new Error("data.question must not be null or empty");this.data=n;this.userComment=""}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"Comment"},n.prototype.getQuestion=function(){return this.data.question},n.prototype.setSubmittedText=function(n){this.userComment=n},n.prototype.getSubmittedText=function(){return this.userComment},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");var t=n.createElement(r.DOM_COMMENT_TAGNAME);return t.appendChild(n.createTextNode(this.getSubmittedText())),[t]},n.prototype.getJsonElements=function(){var n={};return n[r.JSON_COMMENT_KEYNAME]=this.getSubmittedText(),n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),n},n}();!function(n){var t=function(){};n.CommentComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.question)throw new Error("data.question must not be null or empty");if(!n.title)throw new Error("data.title must not be null or empty");if(!n.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!n.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=n;this.selectedButton=0}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"Prompt"},n.prototype.getTitle=function(){return this.data.title},n.prototype.getQuestion=function(){return this.data.question},n.prototype.getYesButtonText=function(){return this.data.yesButtonLabel},n.prototype.getNoButtonText=function(){return this.data.noButtonLabel},n.prototype.setButtonSelected=function(n){n&&(this.selectedButton=n)},n.prototype.getButtonSelected=function(){return this.selectedButton},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");var t=n.createElement(r.DOM_PROMPT_TAGNAME);return t.appendChild(n.createTextNode(this.promptButtonToString(this.getButtonSelected()))),[t]},n.prototype.getJsonElements=function(){var n={};return n[r.JSON_PROMPT_KEYNAME]=this.promptButtonToString(this.getButtonSelected()),n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_TITLE_KEYNAME]=this.getTitle(),n[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),n[r.JSON_PROMPTYESTEXT_KEYNAME]=this.getYesButtonText(),n[r.JSON_PROMPTNOTEXT_KEYNAME]=this.getNoButtonText(),n},n.prototype.promptButtonToString=function(n){switch(n){case 0:return"Unselected";case 1:return"Yes";case 2:return"No";default:return"Unknown"}},n}();!function(n){var t=function(){};n.PromptComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.question)throw new Error("data.question must not be null or empty");if(!n.ratingValuesAscending||n.ratingValuesAscending.length<2)throw new Error("data.ratingValuesAscending must not be null or have less than two choices");n.ratingValuesAscending.forEach(function(n){if(!n)throw new Error("rating values must not contain null or empty");});this.data=n;this.selectedIndex=-1}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"Rating"},n.prototype.getQuestion=function(){return this.data.question},n.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending},n.prototype.getSelectedRating=function(){return this.isRatingIndexValid(this.selectedIndex)?this.data.ratingValuesAscending[this.selectedIndex]:""},n.prototype.setSelectedRatingIndex=function(n){this.selectedIndex=this.isRatingIndexValid(n)?n:-1},n.prototype.getSelectedRatingIndex=function(){return this.selectedIndex},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");var t=n.createElement(r.DOM_RATING_TAGNAME);return this.isRatingIndexValid(this.getSelectedRatingIndex())?t.appendChild(n.createTextNode(this.getNormalizedRatingScore().toFixed(6))):t.appendChild(n.createTextNode("Not rated")),[t]},n.prototype.getJsonElements=function(){var n={};return n[r.JSON_RATING_KEYNAME]=this.isRatingIndexValid(this.getSelectedRatingIndex())?this.getNormalizedRatingScore():"Not rated",n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),n[r.JSON_RATINGOPTIONS_KEYNAME]=this.getRatingValuesAscending(),n},n.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.getSelectedRatingIndex())?this.data.isZeroBased?this.selectedIndex/(this.data.ratingValuesAscending.length-1):(this.selectedIndex+1)/this.data.ratingValuesAscending.length:-1},n.prototype.isRatingIndexValid=function(n){return n>=0&&n<this.data.ratingValuesAscending.length},n}();!function(n){var t=function(){};n.RatingComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var s=i(72),o=i(16),h=i(73),c=i(46),e=i(10),r=[],u=0,f={},l=function(){function n(n,t){if(this.activityContext={},!n)throw new Error("callback must not be null");this.trackedActivityMap={};this.callback=n;this.loggerCallback=t}return n.resetSessionActivity=function(){f={}},n.prototype.logActivity=function(n,t,i){void 0===t&&(t=1);this.logActivity_private(n,0,t,null,i)},n.prototype.logActivityStartTime=function(n,t){this.logActivity_private(n,1,0,t,null)},n.prototype.logActivityStopTime=function(n,t){this.logActivity_private(n,2,0,t,null)},n.prototype.SetActivityTrackingContracts=function(n,t){var l,i,r,y,p,tt,it,w,b,rt,u,e,ut;if(void 0===t&&(t=new c.SurveyStatCollectionEventActivity),l=0,n&&0!==n.length&&t){for(var a={},ft=[],k=0,et=n;k<et.length;k++)if(i=et[k],r=i.trackingSet,-1===ft.indexOf(i.surveyId)){ft.push(i.surveyId);for(var d=t.getBySurveyId(i.surveyId),g=[r.getList().length],ot=new Array(r.getList().length),st=0,v=0,nt=0,ht=r.getList();nt<ht.length;nt++){if(y=ht[nt],g[v]=0,y.getIsAggregate()&&d&&st<d.Counts.length&&(g[v]=d.Counts[st++]),f[y.getActivity()])for(p=0,tt=f[y.getActivity()];p<tt.length;p++)if(it=tt[p],it.surveyId===i.surveyId){ot[v]=it;break}v++}for(w=new s(r),w.initCounts(g,ot,!1),b=0,rt=w.generateActivityIndexList();b<rt.length;b++)u=rt[b],e=new h.IndexedTracker,e.index=u.index,e.surveyId=i.surveyId,e.tracker=w,a[u.activity]||(a[u.activity]=[]),a[u.activity].push(e)}else l++;l>0&&(ut=this.loggerCallback&&this.loggerCallback(),ut&&ut.log_Error(o.TelemetryEvent.SurveyActivity.SetActivityTrackingContracts.DuplicateSurveyID,"Duplicate surveyId passed in activityTrackingContracts. Duplicate count: "+l));this.copyObject(this.trackedActivityMap,a)}},n.prototype.clearSurveys=function(){var n=this;Object.getOwnPropertyNames(this.trackedActivityMap).forEach(function(t){delete n.trackedActivityMap[t]})},n.prototype.saveSessionTrackingActivity=function(n){f[n]=this.trackedActivityMap[n]},n.prototype.getCount=function(n,t){var i=this.getIndexedTracker(n,t);return i?i.tracker.getCount(i.index):0},n.prototype.getSessionCount=function(n,t){var i=this.getIndexedTracker(n,t);return i?i.tracker.getSessionCount(i.index):0},n.prototype.moveSessionCountIntoBaseCount=function(n,t){var i=this.getIndexedTracker(n,t);return i?i.tracker.moveSessionCountIntoBaseCount(i.index):0},n.prototype.getSurveyIds=function(n){if(!e.isNOU(n)){var t=this.trackedActivityMap[n];if(t)return t.map(function(n){return n.surveyId})}},n.prototype.setCallback=function(n){this.callback=n},n.prototype.UpdateActivityTrackingContracts=function(n){var r,i,t;if(e.isNOU(n)||0===Object.keys(n).length)this.clearSurveys();else for(r in this.trackedActivityMap)if(this.trackedActivityMap.hasOwnProperty(r))for(i=this.trackedActivityMap[r],t=i.length-1;t>=0;--t)n.hasOwnProperty(i[t].surveyId)||i.splice(t,1)},n.prototype.getIndexedTracker=function(n,t){var f=this.trackedActivityMap[n],e,i,r,u;if(f){for(i=0,r=f;i<r.length;i++)if(u=r[i],u.surveyId===t){e=u;break}return e}},n.prototype.resetQueuedActivities=function(){r=[]},n.prototype.logActivity_private=function(t,i,f,e,s){var l=this,c,h;(this.callback&&!this.callback.shouldAcceptActivity(t)&&(u++,r.length<n.MaxPendingActivitiesQueueSize&&r.push({activityName:t,logType:i,increment:f,timestamp:e})),t===n.FloodgateStartActivityName)&&(u>0&&(c=r.slice(0,25).map(function(n){return n.activityName}),h=this.loggerCallback&&this.loggerCallback(),h&&h.log_Event(o.TelemetryEvent.SurveyActivity.LogActivity.EventsReprocessed,{ActivityNames:JSON.stringify(c),Count:r.length,Dropped:u-r.length},.05),r.map(function(n){return l.logActivity_core(n.activityName,n.logType,n.increment,n.timestamp,s)})),u=0,this.resetQueuedActivities());this.logActivity_core(t,i,f,e,s)},n.prototype.logActivity_core=function(n,t,i,r,u){var s=this.trackedActivityMap[n],o,h,c,a,f,l;if(s&&0!==s.length){if(o=[],s.length>1){for(o=new Array(s.length),h=0;h<o.length;h++)o[h]=h;o=e.fyShuffle(o)}else o.push(0);for(c=0,a=o;c<a.length;c++){f=s[a[c]];switch(t){case 1:f.tracker.startTime(f.index,r);continue;case 2:i=f.tracker.stopTime(f.index,r);case 0:break;default:continue}if(u&&(l=f.surveyId,this.activityContext[l]=this.activityContext[l]||[],this.activityContext[l].push({activityName:n,context:u})),2===f.tracker.incrementActivity(f.index,i)){this.executeCallback(f.surveyId);break}}}},n.prototype.executeCallback=function(n){this.callback.run(n,this.activityContext[n])},n.prototype.copyObject=function(n,t){Object.keys(t).forEach(function(i){n[i]=t[i]})},n.FloodgateStartActivityName="FloodgateFirstStart",n.MaxPendingActivitiesQueueSize=100,n}();n.exports=l},function(n,t,i){"use strict";var k,d,w,a;Object.defineProperty(t,"__esModule",{value:!0});t.FileBasedCampaignStateProvider=t.HostBasedCampaignStateProvider=t.CampaignStateProviderFactory=t.CampaignState=void 0;var g=i(14),v=i(16),y=i(20),h=i(36),r=i(10),f=g.FileType,c=r.getDistantPast,b=r.isBoolean,e=r.isDate,u=r.isNOU,l=r.isString,o=r.isUtcDatetimeString,s=r.stringToDate,p=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){if(this.CampaignId=n,this.LastNominationTimeUtc=t,this.LastNominationBuildNumber=i,this.DeleteAfterSecondsWhenStale=r,this.ForceCandidacy=u,this.IsCandidate=f,this.DidCandidateTriggerSurvey=e,this.LastSurveyActivatedTimeUtc=o,this.LastSurveyId=s,this.LastSurveyStartTimeUtc=h,this.LastSurveyExpirationTimeUtc=c,this.LastCooldownEndTimeUtc=l,!this.validate())throw new Error("Constructor arguments are not valid");}return n.deserialize=function(t){var i;if(!t)return null;try{i=new n(t.CampaignId,t.LastNominationTimeUtc,t.LastNominationBuildNumber,t.DeleteAfterSecondsWhenStale,!1,t.IsCandidate,t.DidCandidateTriggerSurvey,t.LastSurveyActivatedTimeUtc,t.LastSurveyId,t.LastSurveyStartTimeUtc,t.LastSurveyExpirationTimeUtc,t.LastCooldownEndTimeUtc)}catch(n){return y.FloodgateEngine.getTelemetryLogger().log_Event(v.TelemetryEvent.CampaignState.Deserialize.Failed,{ErrorMessage:n.toString()}),null}return i},n.prototype.validate=function(){if(!this.CampaignId||!l(this.CampaignId)||u(this.LastNominationBuildNumber)||!l(this.LastNominationBuildNumber)||!r.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0||!b(this.IsCandidate)||!b(this.DidCandidateTriggerSurvey)||this.IsCandidate&&(u(this.LastSurveyStartTimeUtc)||u(this.LastSurveyExpirationTimeUtc)||!l(this.LastSurveyId))||this.DidCandidateTriggerSurvey&&u(this.LastSurveyActivatedTimeUtc))return!1;if(u(this.LastSurveyId))this.LastSurveyId="";else if(!l(this.LastSurveyId))return!1;if(o(this.LastNominationTimeUtc))this.LastNominationTimeUtc=s(this.LastNominationTimeUtc);else if(!e(this.LastNominationTimeUtc))return!1;if(u(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=c();else if(o(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=s(this.LastSurveyActivatedTimeUtc);else if(!e(this.LastSurveyActivatedTimeUtc))return!1;if(u(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=c();else if(o(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=s(this.LastSurveyStartTimeUtc);else if(!e(this.LastSurveyStartTimeUtc))return!1;if(u(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=c();else if(o(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=s(this.LastSurveyExpirationTimeUtc);else if(!e(this.LastSurveyExpirationTimeUtc))return!1;if(u(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=c();else if(o(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=s(this.LastCooldownEndTimeUtc);else if(!e(this.LastCooldownEndTimeUtc))return!1;return!0},n.prototype.markCurrentSurveyTakenOnDate=function(n,t,i){this.DidCandidateTriggerSurvey=i;this.LastSurveyActivatedTimeUtc=null!=n?n:new Date;this.LastCooldownEndTimeUtc=r.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc,t)},n.prototype.getCooldownStartDate=function(){return this.IsCandidate?this.DidCandidateTriggerSurvey?this.LastSurveyActivatedTimeUtc:this.LastSurveyStartTimeUtc:this.LastNominationTimeUtc},n}();t.CampaignState=p;k=function(){function n(){}return n.make=function(n,t){return t?new w(n,t):new a(n)},n}();t.CampaignStateProviderFactory=k;d=function(){};w=function(){function n(n,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;n&&(this.fileBasedStateProvider=new a(n))}return n.prototype.load=function(){var n,t=this.getStatesFromHost();return this.fileBasedStateProvider&&(n=this.fileBasedStateProvider.load()),h.MergeAndUpdateCampaignStates(n,t).find(0)},n.prototype.save=function(n){var r=this;if(n){var u=this.getStatesFromHost(),t=h.MergeAndUpdateCampaignStates(n,u),i=t.find(1),e=t.find(0);i&&i.forEach(function(n){var t=h.makeSettingItemValue(JSON.stringify(n));r.hostBasedStorage.upsertSettingItem(f[f.CampaignStates],n.CampaignId,t)});this.fileBasedStateProvider&&this.fileBasedStateProvider.save(e)}},n.prototype.getStatesFromHost=function(){var n=[],t=this.hostBasedStorage.readSettingList(f[f.CampaignStates]),i,r;for(i in t)if(t.hasOwnProperty(i)){var o=t[i],u=h.extractSettingItemValueSubString(o),e={};try{e=JSON.parse(u);r=p.deserialize(e);r&&n.push(r)}catch(n){y.FloodgateEngine.getTelemetryLogger().log_Event(v.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+n.toString()+".  Input:"+u})}}return n},n}();t.HostBasedCampaignStateProvider=w;a=function(){function n(n){if(!n)throw new Error("storage must not be null");this.storage=n}return n.prototype.load=function(){var n,t=this.storage.read(f.CampaignStates),i;if(!t)return[];try{return n=JSON.parse(t),i=[],n&&n.CampaignStates&&n.CampaignStates.forEach(function(n){var t=p.deserialize(n);t&&i.push(t)}),i}catch(n){return y.FloodgateEngine.getTelemetryLogger().log_Event(v.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+n.toString()+".  Input:"+t}),[]}},n.prototype.save=function(n){var t,i;n&&(t=new d,t.CampaignStates=n,i=JSON.stringify(t),this.storage.write(f.CampaignStates,i))},n}();t.FileBasedCampaignStateProvider=a},function(n,t,i){"use strict";var l,p=this&&this.__extends||(l=function(n,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}l(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),y,v,h,c;Object.defineProperty(t,"__esModule",{value:!0});t.SurveyActivationStats=t.FileBasedSurveyActivationStatsProvider=t.HostBasedSurveyActivationStatsProvider=t.SurveyActivationStatsProviderFactory=t.SurveyStatCollectionActivation=void 0;var a=i(14),u=a.FileType,w=i(18),e=i(16),o=i(20),s=i(36),b=i(43),r=i(10),f=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return p(t,n),t.fromJson=function(n){var r,i=new t;if(!n)return o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),i;try{r=JSON.parse(n)}catch(n){return o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+n.toString()}),i}return i.deserialize(r)?i:new t},t.toJson=function(n){return n||(o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),n=new t),JSON.stringify(n)},t.prototype.accumulate=function(n){var t,i;if(n){t=n.getStats();for(i in t)t.hasOwnProperty(i)&&this.addStats(i,t[i])}},t.prototype.deserialize=function(n){var r=n.Surveys,u=new Date,t,i;for(t in r)r.hasOwnProperty(t)&&(i=new c,i.deserialize(r[t])&&i.ExpirationTimeUtc>u&&this.addStats(t,i));return this.validate()},t.prototype.validate=function(){return r.isObject(this.getStats())},t}(b.SurveyStatCollection);t.SurveyStatCollectionActivation=f;y=function(){function n(){}return n.make=function(n,t){return t?new v(n,t):new h(n)},n}();t.SurveyActivationStatsProviderFactory=y;v=function(){function n(n,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;n&&(this.fileBasedStorageProvider=new h(n))}return n.prototype.load=function(){var t=this.getSurveyStatsFromHost(),n=new f;return this.fileBasedStorageProvider&&(n=this.fileBasedStorageProvider.load()),s.MergeAndUpdateSurveyActivationStats(n,t).find(0)},n.prototype.save=function(n){var t,i,e;if(n){var o=this.getSurveyStatsFromHost(),r=s.MergeAndUpdateSurveyActivationStats(n,o),f=r.find(1),h=r.find(0);if(f){t=f.getStats();for(i in t)t.hasOwnProperty(i)&&(e=s.makeSettingItemValue(JSON.stringify(t[i])),this.hostBasedStorage.upsertSettingItem(u[u.SurveyActivationStats],i,e))}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(h)}},n.prototype.getSurveyStatsFromHost=function(){var i=new f,r=this.hostBasedStorage.readSettingList(u[u.SurveyActivationStats]),a=new Date,n,h,t,l;for(n in r)if(r.hasOwnProperty(n)){h=s.extractSettingItemValueSubString(r[n]);t=new c;try{l=JSON.parse(h);t.deserialize(l)}catch(i){o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+i.toString()+".  Input:"+h})}t.ExpirationTimeUtc<=a?this.hostBasedStorage.deleteSettingItem(u[u.SurveyActivationStats],n):i.addStats(n,t)}return i},n}();t.HostBasedSurveyActivationStatsProvider=v;h=function(){function n(n){if(!n)throw new Error("storage must not be null");this.storage=n}return n.prototype.load=function(){var n=this.storage.read(a.FileType.SurveyActivationStats);return n?f.fromJson(n):new f},n.prototype.save=function(n){if(n){var t=f.toJson(n);this.storage.write(a.FileType.SurveyActivationStats,t)}},n}();t.FileBasedSurveyActivationStatsProvider=h;c=function(){function n(){this.SurveyLaunchCount=0;this.SurveyLaunchCountPerSession=0}return n.prototype.deserialize=function(n){var t,i;return this.ActivationTimeUtc=n.ActivationTimeUtc,this.ExpirationTimeUtc=n.ExpirationTimeUtc,this.Type=n.Type,this.SurveyLaunchCount=null!==(t=n.SurveyLaunchCount)&&void 0!==t?t:0,this.SurveyLaunchCountPerSession=null!==(i=n.SurveyLaunchCountPerSession)&&void 0!==i?i:0,this.validate()},n.prototype.validate=function(){return!!r.isUtcDatetimeString(this.ActivationTimeUtc)&&(this.ActivationTimeUtc=r.stringToDate(this.ActivationTimeUtc),!!r.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=r.stringToDate(this.ExpirationTimeUtc),!(!r.isNumber(this.SurveyLaunchCount)||!r.isNumber(this.SurveyLaunchCountPerSession))&&r.isEnumValue(this.Type,w.Type)))},n}();t.SurveyActivationStats=c},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SurveyStatCollection=void 0;var i=function(){function n(){this.Surveys={};this.Surveys={}}return n.prototype.addStats=function(n,t){this.Surveys[n]=t},n.prototype.getBySurveyId=function(n){return this.Surveys[n]},n.prototype.getStats=function(){return this.Surveys},n}();t.SurveyStatCollection=i},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.customerVoiceFormId)throw new Error("data.formID must not be null or empty");this.data=n}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"CVSurvey"},n.prototype.getFormId=function(){return this.data.customerVoiceFormId},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");return[n.createElement(r.DOM_CVSURVEY_TAGNAME)]},n.prototype.getJsonElements=function(){var n={};return n[r.JSON_CVSURVEY_KEYNAME]=this.getFormId(),n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_CVSURVEYFORMID_KEYNAME]=this.getFormId(),n},n}();!function(n){var t=function(){};n.CVSurveyComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var l,a,c,e;Object.defineProperty(t,"__esModule",{value:!0});t.FileBasedGovernedChannelStateProvider=t.HostBasedGovernedChannelStateProvider=t.GovernedChannelStateProviderFactory=t.GovernedChannelState=void 0;var v=i(14),o=i(16),s=i(20),y=i(17),f=i(36),r=i(10),u=v.FileType,h=function(){function n(n,t){if(this.ChannelType=n,this.CooldownStartTimeUtc=t,!this.validate())throw new Error("Constructor arguments are not valid");}return n.deserialize=function(t){var i;if(!t)return null;try{i=new n(t.ChannelType,t.CooldownStartTimeUtc)}catch(n){return s.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.GovernedChannelState.Deserialize.Failed,{ErrorMessage:n.toString()}),null}return i},n.prototype.validate=function(){return!!r.isEnumValue(this.ChannelType,y.GovernedChannelType)&&(r.isUtcDatetimeString(this.CooldownStartTimeUtc)?this.CooldownStartTimeUtc=r.stringToDate(this.CooldownStartTimeUtc):!r.isNOU(this.CooldownStartTimeUtc)&&r.isDate(this.CooldownStartTimeUtc)||(this.CooldownStartTimeUtc=r.getDistantPast()),!0)},n.prototype.getType=function(){return this.ChannelType},n.prototype.getCooldownStartTime=function(){return this.CooldownStartTimeUtc},n}();t.GovernedChannelState=h;l=function(){function n(){}return n.make=function(n,t){return t?new c(n,t):new e(n)},n}();t.GovernedChannelStateProviderFactory=l;a=function(){};c=function(){function n(n,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;n&&(this.fileBasedStateProvider=new e(n))}return n.prototype.load=function(){var n,t=this.getStatesFromHost();return this.fileBasedStateProvider&&(n=this.fileBasedStateProvider.load()),f.MergeAndUpdateGovernedChannelStates(n,t).find(0)},n.prototype.save=function(n){var r=this;if(n){var e=this.getStatesFromHost(),t=f.MergeAndUpdateGovernedChannelStates(n,e),i=t.find(1),o=t.find(0);i&&i.forEach(function(n){var t=f.makeSettingItemValue(JSON.stringify(n));r.hostBasedStorage.upsertSettingItem(u[u.GovernedChannelStates],String(n.getType()),t)});this.fileBasedStateProvider&&this.fileBasedStateProvider.save(o)}},n.prototype.getStatesFromHost=function(){var n=[],t=this.hostBasedStorage.readSettingList(u[u.GovernedChannelStates]),i,r;for(i in t)if(t.hasOwnProperty(i)){var l=t[i],e=f.extractSettingItemValueSubString(l),c={};try{c=JSON.parse(e);r=h.deserialize(c);r&&n.push(r)}catch(n){s.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+n.toString()+".  Input:"+e})}}return n},n}();t.HostBasedGovernedChannelStateProvider=c;e=function(){function n(n){if(!n)throw new Error("storage must not be null");this.storage=n}return n.prototype.load=function(){var n,t=this.storage.read(u.GovernedChannelStates),i;if(!t)return[];try{return n=JSON.parse(t),i=[],n&&n.ChannelStates&&n.ChannelStates.forEach(function(n){var t=h.deserialize(n);t&&i.push(t)}),i}catch(n){return s.FloodgateEngine.getTelemetryLogger().log_Event(o.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+n.toString()+".  Input:"+t}),[]}},n.prototype.save=function(n){var t,i;n&&(t=new a,t.ChannelStates=n,i=JSON.stringify(t),this.storage.write(u.GovernedChannelStates,i))},n}();t.FileBasedGovernedChannelStateProvider=e},function(n,t,i){"use strict";var f,s=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u;Object.defineProperty(t,"__esModule",{value:!0});t.SurveyEventActivityStats=t.SurveyStatCollectionEventActivity=void 0;var e=i(16),o=i(20),h=i(43),r=i(10),c=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return s(t,n),t.fromJson=function(n){var r,i=new t;if(!n)return i;try{r=JSON.parse(n)}catch(n){return o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+n.toString()}),i}return i.deserialize(r)?i:new t},t.toJson=function(n){return n||(o.FloodgateEngine.getTelemetryLogger().log_Event(e.TelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),n=new t),JSON.stringify(n)},t.prototype.accumulate=function(n){var r,i,t,e,f;if(n){r=n.getStats();for(i in r)if(r.hasOwnProperty(i))for(t=this.getBySurveyId(i),(t||((t=new u).Counts=[],this.addStats(i,t)),t.ExpirationTimeUtc=r[i].ExpirationTimeUtc,t.Counts.length<r[i].Counts.length)&&(e=t.Counts.slice(),t.Counts=e),f=0;f<r[i].Counts.length;f++)t.Counts[f]||(t.Counts[f]=0),t.Counts[f]+=r[i].Counts[f]}},t.prototype.deserialize=function(n){var r=n.Surveys,f=new Date,t,i;for(t in r)r.hasOwnProperty(t)&&(i=new u,i.deserialize(r[t])&&i.ExpirationTimeUtc>f&&this.addStats(t,i));return this.validate()},t.prototype.validate=function(){return r.isObject(this.getStats())},t}(h.SurveyStatCollection);t.SurveyStatCollectionEventActivity=c;u=function(){function n(){}return n.prototype.deserialize=function(n){return this.ExpirationTimeUtc=n.ExpirationTimeUtc,this.Counts=n.Counts,this.validate()},n.prototype.validate=function(){var n,t;if(!this.Counts)return!1;for(n=0;n<this.Counts.length;n++){if(t=this.Counts[n],!r.isNumber(t))return!1;t<0&&(this.Counts[n]=0)}return!!r.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=r.stringToDate(this.ExpirationTimeUtc),!0)},n}();t.SurveyEventActivityStats=u},function(){},function(n){n.exports=function(){"use strict";function ct(n,t){function i(){this.constructor=n}pe(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function nt(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(n){f(n)}}function s(n){try{e(r.throw(n))}catch(n){f(n)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})}function d(n,t){function o(e){return function(o){return function(e){if(f)throw new TypeError("Generator is already executing.");for(;r;)try{if(f=1,u&&(i=2&e[0]?u.return:e[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==e[0]&&2!==e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(n){e=[6,n];u=0}finally{f=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var f,u,i,e,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e}function te(n,t,i){return i<0&&(i+=1),i>=1&&(i-=1),i<1/6?(t-n)*i*6+n:i<.5?t:i<2/3?6*(t-n)*(2/3-i)+n:n}for(var yi,ko,go,au,ns,ts,t,is,cr,rs,fi,us,pt,fs,es,lr,ss,bh,pe=function(n,t){return(pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},ef=function(){return(ef=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n}).apply(this,arguments)},bt=function(){function n(n,t,i,r){this.left=n;this.top=t;this.width=i;this.height=r}return n.prototype.add=function(t,i,r,u){return new n(this.left+t,this.top+i,this.width+r,this.height+u)},n.fromClientRect=function(t){return new n(t.left,t.top,t.width,t.height)},n}(),of=function(n){return bt.fromClientRect(n.getBoundingClientRect())},wr=function(n){for(var t,u,r=[],i=0,f=n.length;i<f;)t=n.charCodeAt(i++),t>=55296&&t<=56319&&i<f?(u=n.charCodeAt(i++),56320==(64512&u)?r.push(((1023&t)<<10)+(1023&u)+65536):(r.push(t),i--)):r.push(t);return r},s=function(){for(var u,n,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);if(u=t.length,!u)return"";for(var r=[],f=-1,e="";++f<u;)n=t[f],n<=65535?r.push(n):(n-=65536,r.push(55296+(n>>10),n%1024+56320)),(f+1===u||r.length>16384)&&(e+=String.fromCharCode.apply(String,r),r.length=0);return e},we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tr="undefined"==typeof Uint8Array?[]:new Uint8Array(256),br=0;br<we.length;br++)tr[we.charCodeAt(br)]=br;var n,be=function(n,t,i){return n.slice?n.slice(t,i):new Uint16Array(Array.prototype.slice.call(n,t,i))},kh=function(){function n(n,t,i,r,u,f){this.initialValue=n;this.errorValue=t;this.highStart=i;this.highValueIndex=r;this.index=u;this.data=f}return n.prototype.get=function(n){var t;if(n>=0){if(n<55296||n>56319&&n<=65535)return t=((t=this.index[n>>5])<<2)+(31&n),this.data[t];if(n<=65535)return t=((t=this.index[2048+(n-55296>>5)])<<2)+(31&n),this.data[t];if(n<this.highStart)return t=2080+(n>>11),t=this.index[t],t+=n>>5&63,t=((t=this.index[t])<<2)+(31&n),this.data[t];if(n<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),kt=10,sf=13,ir=15,kr=17,rr=18,ke=19,hf=20,cf=21,ur=22,si=24,g=25,fr=26,er=27,hi=28,ci=30,or=32,sr=33,lf=34,af=35,ei=37,vf=38,dr=39,gr=40,de=42,ge=function(n){var r,u,f,i=function(n){var t,s,f,e,h,r=.75*n.length,c=n.length,o=0,i,u;for("="===n[n.length-1]&&(r--,"="===n[n.length-2]&&r--),i="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(r):new Array(r),u=Array.isArray(i)?i:new Uint8Array(i),t=0;t<c;t+=4)s=tr[n.charCodeAt(t)],f=tr[n.charCodeAt(t+1)],e=tr[n.charCodeAt(t+2)],h=tr[n.charCodeAt(t+3)],u[o++]=s<<2|f>>4,u[o++]=(15&f)<<4|e>>2,u[o++]=(3&e)<<6|63&h;return i}(n),t=Array.isArray(i)?function(n){for(var r=n.length,i=[],t=0;t<r;t+=4)i.push(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]);return i}(i):new Uint32Array(i),e=Array.isArray(i)?function(n){for(var r=n.length,i=[],t=0;t<r;t+=2)i.push(n[t+1]<<8|n[t]);return i}(i):new Uint16Array(i),o=be(e,12,t[4]/2),s=2===t[5]?be(e,(24+t[4])/2):(r=t,u=Math.ceil((24+t[4])/4),r.slice?r.slice(u,f):new Uint32Array(Array.prototype.slice.call(r,u,f)));return new kh(t[0],t[1],t[2],t[3],o,s)}("KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"),et=[ci,36],yf=[1,2,3,5],no=[kt,8],to=[er,fr],dh=yf.concat(no),io=[vf,dr,gr,lf,af],gh=[ir,sf],pf=function(n,t,i,r){var o=r[i],u,f,s,e;if(Array.isArray(n)?-1!==n.indexOf(o):n===o)for(u=i;u<=r.length;){if((e=r[++u])===t)return!0;if(e!==kt)break}if(o===kt)for(u=i;u>0;){if(f=r[--u],Array.isArray(n)?-1!==n.indexOf(f):n===f)for(s=i;s<=r.length;){if((e=r[++s])===t)return!0;if(e!==kt)break}if(f!==kt)break}return!1},ro=function(n,t){for(var r,i=n;i>=0;){if(r=t[i],r!==kt)return r;i--}return 0},nc=function(n,t,i,r,u){var o,s,h,l,a;if(0===i[r]||(o=r-1,Array.isArray(u)&&!0===u[o]))return"×";var c=o-1,v=o+1,e=t[o],y=c>=0?t[c]:0,f=t[v];if(2===e&&3===f)return"×";if(-1!==yf.indexOf(e))return"!";if(-1!==yf.indexOf(f)||-1!==no.indexOf(f))return"×";if(8===ro(o,t))return"÷";if(11===ge.get(n[o])&&(f===ei||f===or||f===sr)||7===e||7===f||9===e||-1===[kt,sf,ir].indexOf(e)&&9===f||-1!==[kr,rr,ke,si,hi].indexOf(f)||ro(o,t)===ur||pf(23,ur,o,t)||pf([kr,rr],cf,o,t)||pf(12,12,o,t))return"×";if(e===kt)return"÷";if(23===e||23===f)return"×";if(16===f||16===e)return"÷";if(-1!==[sf,ir,cf].indexOf(f)||14===e||36===y&&-1!==gh.indexOf(e)||e===hi&&36===f||f===hf&&-1!==et.concat(hf,ke,g,ei,or,sr).indexOf(e)||-1!==et.indexOf(f)&&e===g||-1!==et.indexOf(e)&&f===g||e===er&&-1!==[ei,or,sr].indexOf(f)||-1!==[ei,or,sr].indexOf(e)&&f===fr||-1!==et.indexOf(e)&&-1!==to.indexOf(f)||-1!==to.indexOf(e)&&-1!==et.indexOf(f)||-1!==[er,fr].indexOf(e)&&(f===g||-1!==[ur,ir].indexOf(f)&&t[v+1]===g)||-1!==[ur,ir].indexOf(e)&&f===g||e===g&&-1!==[g,hi,si].indexOf(f))return"×";if(-1!==[g,hi,si,kr,rr].indexOf(f))for(s=o;s>=0;){if((h=t[s])===g)return"×";if(-1===[hi,si].indexOf(h))break;s--}if(-1!==[er,fr].indexOf(f))for(s=-1!==[kr,rr].indexOf(e)?c:o;s>=0;){if((h=t[s])===g)return"×";if(-1===[hi,si].indexOf(h))break;s--}if(vf===e&&-1!==[vf,dr,lf,af].indexOf(f)||-1!==[dr,lf].indexOf(e)&&-1!==[dr,gr].indexOf(f)||-1!==[gr,af].indexOf(e)&&f===gr||-1!==io.indexOf(e)&&-1!==[hf,fr].indexOf(f)||-1!==io.indexOf(f)&&e===er||-1!==et.indexOf(e)&&-1!==et.indexOf(f)||e===si&&-1!==et.indexOf(f)||-1!==et.concat(g).indexOf(e)&&f===ur||-1!==et.concat(g).indexOf(f)&&e===rr)return"×";if(41===e&&41===f){for(l=i[o],a=1;l>0&&41===t[--l];)a++;if(a%2!=0)return"×"}return e===or&&f===sr?"×":"÷"},tc=function(n,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var i=function(n,t){void 0===t&&(t="strict");var i=[],r=[],u=[];return n.forEach(function(n,f){var e=ge.get(n),o;return(e>50?(u.push(!0),e-=50):u.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(n))?(r.push(f),i.push(16)):4===e||11===e?0===f?(r.push(f),i.push(ci)):(o=i[f-1],-1===dh.indexOf(o)?(r.push(r[f-1]),i.push(o)):(r.push(f),i.push(ci))):(r.push(f),31===e?i.push("strict"===t?cf:ei):e===de||29===e?i.push(ci):43===e?n>=131072&&n<=196605||n>=196608&&n<=262141?i.push(ei):i.push(ci):void i.push(e))}),[r,i,u]}(n,t.lineBreak),u=i[0],r=i[1],f=i[2];return"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(r=r.map(function(n){return-1!==[g,ci,de].indexOf(n)?ei:n})),[u,r,"keep-all"===t.wordBreak?f.map(function(t,i){return t&&n[i]>=19968&&n[i]<=40959}):void 0]},ic=function(){function n(n,t,i,r){this.codePoints=n;this.required="!"===t;this.start=i;this.end=r}return n.prototype.slice=function(){return s.apply(void 0,this.codePoints.slice(this.start,this.end))},n}();!function(n){n[n.STRING_TOKEN=0]="STRING_TOKEN";n[n.BAD_STRING_TOKEN=1]="BAD_STRING_TOKEN";n[n.LEFT_PARENTHESIS_TOKEN=2]="LEFT_PARENTHESIS_TOKEN";n[n.RIGHT_PARENTHESIS_TOKEN=3]="RIGHT_PARENTHESIS_TOKEN";n[n.COMMA_TOKEN=4]="COMMA_TOKEN";n[n.HASH_TOKEN=5]="HASH_TOKEN";n[n.DELIM_TOKEN=6]="DELIM_TOKEN";n[n.AT_KEYWORD_TOKEN=7]="AT_KEYWORD_TOKEN";n[n.PREFIX_MATCH_TOKEN=8]="PREFIX_MATCH_TOKEN";n[n.DASH_MATCH_TOKEN=9]="DASH_MATCH_TOKEN";n[n.INCLUDE_MATCH_TOKEN=10]="INCLUDE_MATCH_TOKEN";n[n.LEFT_CURLY_BRACKET_TOKEN=11]="LEFT_CURLY_BRACKET_TOKEN";n[n.RIGHT_CURLY_BRACKET_TOKEN=12]="RIGHT_CURLY_BRACKET_TOKEN";n[n.SUFFIX_MATCH_TOKEN=13]="SUFFIX_MATCH_TOKEN";n[n.SUBSTRING_MATCH_TOKEN=14]="SUBSTRING_MATCH_TOKEN";n[n.DIMENSION_TOKEN=15]="DIMENSION_TOKEN";n[n.PERCENTAGE_TOKEN=16]="PERCENTAGE_TOKEN";n[n.NUMBER_TOKEN=17]="NUMBER_TOKEN";n[n.FUNCTION=18]="FUNCTION";n[n.FUNCTION_TOKEN=19]="FUNCTION_TOKEN";n[n.IDENT_TOKEN=20]="IDENT_TOKEN";n[n.COLUMN_TOKEN=21]="COLUMN_TOKEN";n[n.URL_TOKEN=22]="URL_TOKEN";n[n.BAD_URL_TOKEN=23]="BAD_URL_TOKEN";n[n.CDC_TOKEN=24]="CDC_TOKEN";n[n.CDO_TOKEN=25]="CDO_TOKEN";n[n.COLON_TOKEN=26]="COLON_TOKEN";n[n.SEMICOLON_TOKEN=27]="SEMICOLON_TOKEN";n[n.LEFT_SQUARE_BRACKET_TOKEN=28]="LEFT_SQUARE_BRACKET_TOKEN";n[n.RIGHT_SQUARE_BRACKET_TOKEN=29]="RIGHT_SQUARE_BRACKET_TOKEN";n[n.UNICODE_RANGE_TOKEN=30]="UNICODE_RANGE_TOKEN";n[n.WHITESPACE_TOKEN=31]="WHITESPACE_TOKEN";n[n.EOF_TOKEN=32]="EOF_TOKEN"}(n||(n={}));var w=function(n){return n>=48&&n<=57},li=function(n){return w(n)||n>=65&&n<=70||n>=97&&n<=102},nu=function(n){return 10===n||9===n||32===n},tu=function(n){return function(n){return function(n){return n>=97&&n<=122}(n)||function(n){return n>=65&&n<=90}(n)}(n)||function(n){return n>=128}(n)||95===n},uo=function(n){return tu(n)||w(n)||45===n},rc=function(n){return n>=0&&n<=8||11===n||n>=14&&n<=31||127===n},dt=function(n,t){return 92===n&&10!==t},iu=function(n,t,i){return 45===n?tu(t)||dt(t,i):!!tu(n)||!(92!==n||!dt(n,t))},wf=function(n,t,i){return 43===n||45===n?!!w(t)||46===t&&w(i):w(46===n?t:n)},uc=function(n){var t=0,o=1,i,h,r,f,c,e,u,l;for(43!==n[t]&&45!==n[t]||(45===n[t]&&(o=-1),t++),i=[];w(n[t]);)i.push(n[t++]);for(h=i.length?parseInt(s.apply(void 0,i),10):0,46===n[t]&&t++,r=[];w(n[t]);)r.push(n[t++]);for(f=r.length,c=f?parseInt(s.apply(void 0,r),10):0,69!==n[t]&&101!==n[t]||t++,e=1,43!==n[t]&&45!==n[t]||(45===n[t]&&(e=-1),t++),u=[];w(n[t]);)u.push(n[t++]);return l=u.length?parseInt(s.apply(void 0,u),10):0,o*(h+c*Math.pow(10,-f))*Math.pow(10,e*l)},fc={type:n.LEFT_PARENTHESIS_TOKEN},ec={type:n.RIGHT_PARENTHESIS_TOKEN},oc={type:n.COMMA_TOKEN},sc={type:n.SUFFIX_MATCH_TOKEN},hc={type:n.PREFIX_MATCH_TOKEN},cc={type:n.COLUMN_TOKEN},lc={type:n.DASH_MATCH_TOKEN},ac={type:n.INCLUDE_MATCH_TOKEN},vc={type:n.LEFT_CURLY_BRACKET_TOKEN},yc={type:n.RIGHT_CURLY_BRACKET_TOKEN},pc={type:n.SUBSTRING_MATCH_TOKEN},ru={type:n.BAD_URL_TOKEN},wc={type:n.BAD_STRING_TOKEN},bc={type:n.CDO_TOKEN},kc={type:n.CDC_TOKEN},dc={type:n.COLON_TOKEN},gc={type:n.SEMICOLON_TOKEN},nl={type:n.LEFT_SQUARE_BRACKET_TOKEN},tl={type:n.RIGHT_SQUARE_BRACKET_TOKEN},il={type:n.WHITESPACE_TOKEN},bf={type:n.EOF_TOKEN},fo=function(){function t(){this._value=[]}return t.prototype.write=function(n){this._value=this._value.concat(wr(n))},t.prototype.read=function(){for(var t=[],n=this.consumeToken();n!==bf;)t.push(n),n=this.consumeToken();return t},t.prototype.consumeToken=function(){var t=this.consumeCodePoint(),l,i,r,v,e;switch(t){case 34:return this.consumeStringToken(34);case 35:var o=this.peekCodePoint(0),h=this.peekCodePoint(1),c=this.peekCodePoint(2);if(uo(o)||dt(h,c))return l=iu(o,h,c)?2:1,i=this.consumeName(),{type:n.HASH_TOKEN,value:i,flags:l};break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),sc;break;case 39:return this.consumeStringToken(39);case 40:return fc;case 41:return ec;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),pc;break;case 43:if(wf(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 44:return oc;case 45:var a=t,u=this.peekCodePoint(0),f=this.peekCodePoint(1);if(wf(a,u,f))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(iu(a,u,f))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(45===u&&62===f)return this.consumeCodePoint(),this.consumeCodePoint(),kc;break;case 46:if(wf(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;)if((r=this.consumeCodePoint(),42===r&&47===(r=this.consumeCodePoint()))||-1===r)return this.consumeToken();break;case 58:return dc;case 59:return gc;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),bc;break;case 64:var y=this.peekCodePoint(0),p=this.peekCodePoint(1),b=this.peekCodePoint(2);if(iu(y,p,b))return i=this.consumeName(),{type:n.AT_KEYWORD_TOKEN,value:i};break;case 91:return nl;case 92:if(dt(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case 93:return tl;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),hc;break;case 123:return vc;case 125:return yc;case 117:case 85:return v=this.peekCodePoint(0),e=this.peekCodePoint(1),43!==v||!li(e)&&63!==e||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),lc;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),cc;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),ac;break;case-1:return bf}return nu(t)?(this.consumeWhiteSpace(),il):w(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):tu(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:n.DELIM_TOKEN,value:s(t)}},t.prototype.consumeCodePoint=function(){var n=this._value.shift();return void 0===n?-1:n},t.prototype.reconsumeCodePoint=function(n){this._value.unshift(n)},t.prototype.peekCodePoint=function(n){return n>=this._value.length?-1:this._value[n]},t.prototype.consumeUnicodeRangeToken=function(){for(var e,o,r,u,f,i=[],t=this.consumeCodePoint();li(t)&&i.length<6;)i.push(t),t=this.consumeCodePoint();for(e=!1;63===t&&i.length<6;)i.push(t),t=this.consumeCodePoint(),e=!0;if(e)return o=parseInt(s.apply(void 0,i.map(function(n){return 63===n?48:n})),16),r=parseInt(s.apply(void 0,i.map(function(n){return 63===n?70:n})),16),{type:n.UNICODE_RANGE_TOKEN,start:o,end:r};if(u=parseInt(s.apply(void 0,i),16),45===this.peekCodePoint(0)&&li(this.peekCodePoint(1))){for(this.consumeCodePoint(),t=this.consumeCodePoint(),f=[];li(t)&&f.length<6;)f.push(t),t=this.consumeCodePoint();return r=parseInt(s.apply(void 0,f),16),{type:n.UNICODE_RANGE_TOKEN,start:u,end:r}}return{type:n.UNICODE_RANGE_TOKEN,start:u,end:u}},t.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return"url"===t.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:n.FUNCTION_TOKEN,value:t}):{type:n.IDENT_TOKEN,value:t}},t.prototype.consumeUrlToken=function(){var i=[],r,u,t;if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:n.URL_TOKEN,value:""};if(r=this.peekCodePoint(0),39===r||34===r)return u=this.consumeStringToken(this.consumeCodePoint()),u.type===n.STRING_TOKEN&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:n.URL_TOKEN,value:u.value}):(this.consumeBadUrlRemnants(),ru);for(;;){if(t=this.consumeCodePoint(),-1===t||41===t)return{type:n.URL_TOKEN,value:s.apply(void 0,i)};if(nu(t))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:n.URL_TOKEN,value:s.apply(void 0,i)}):(this.consumeBadUrlRemnants(),ru);if(34===t||39===t||40===t||rc(t))return this.consumeBadUrlRemnants(),ru;if(92===t){if(!dt(t,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),ru;i.push(this.consumeEscapedCodePoint())}else i.push(t)}},t.prototype.consumeWhiteSpace=function(){for(;nu(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var n=this.consumeCodePoint();if(41===n||-1===n)return;dt(n,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(n){for(var i,t="";n>0;)i=Math.min(6e4,n),t+=s.apply(void 0,this._value.splice(0,i)),n-=i;return this._value.shift(),t},t.prototype.consumeStringToken=function(t){for(var r,f,u="",i=0;;){if(r=this._value[i],-1===r||void 0===r||r===t)return u+=this.consumeStringSlice(i),{type:n.STRING_TOKEN,value:u};if(10===r)return this._value.splice(0,i),wc;92===r&&(f=this._value[i+1],-1!==f&&void 0!==f&&(10===f?(u+=this.consumeStringSlice(i),i=-1,this._value.shift()):dt(r,f)&&(u+=this.consumeStringSlice(i),u+=s(this.consumeEscapedCodePoint()),i=-1)));i++}},t.prototype.consumeNumber=function(){var n=[],r=4,t=this.peekCodePoint(0),i,u;for(43!==t&&45!==t||n.push(this.consumeCodePoint());w(this.peekCodePoint(0));)n.push(this.consumeCodePoint());if(t=this.peekCodePoint(0),i=this.peekCodePoint(1),46===t&&w(i))for(n.push(this.consumeCodePoint(),this.consumeCodePoint()),r=8;w(this.peekCodePoint(0));)n.push(this.consumeCodePoint());if(t=this.peekCodePoint(0),i=this.peekCodePoint(1),u=this.peekCodePoint(2),(69===t||101===t)&&((43===i||45===i)&&w(u)||w(i)))for(n.push(this.consumeCodePoint(),this.consumeCodePoint()),r=8;w(this.peekCodePoint(0));)n.push(this.consumeCodePoint());return[uc(n),r]},t.prototype.consumeNumericToken=function(){var r=this.consumeNumber(),t=r[0],i=r[1],u=this.peekCodePoint(0),e=this.peekCodePoint(1),o=this.peekCodePoint(2),f;return iu(u,e,o)?(f=this.consumeName(),{type:n.DIMENSION_TOKEN,number:t,flags:i,unit:f}):37===u?(this.consumeCodePoint(),{type:n.PERCENTAGE_TOKEN,number:t,flags:i}):{type:n.NUMBER_TOKEN,number:t,flags:i}},t.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint(),i,n;if(li(t)){for(i=s(t);li(this.peekCodePoint(0))&&i.length<6;)i+=s(this.consumeCodePoint());return nu(this.peekCodePoint(0))&&this.consumeCodePoint(),n=parseInt(i,16),0===n||function(n){return n>=55296&&n<=57343}(n)||n>1114111?65533:n}return-1===t?65533:t},t.prototype.consumeName=function(){for(var n,t="";;)if(n=this.consumeCodePoint(),uo(n))t+=s(n);else{if(!dt(n,this.peekCodePoint(0)))return this.reconsumeCodePoint(n),t;t+=s(this.consumeEscapedCodePoint())}},t}(),kf=function(){function t(n){this._tokens=n}return t.create=function(n){var i=new fo;return i.write(n),new t(i.read())},t.parseValue=function(n){return t.create(n).parseComponentValue()},t.parseValues=function(n){return t.create(n).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var i,t=this.consumeToken();t.type===n.WHITESPACE_TOKEN;)t=this.consumeToken();if(t.type===n.EOF_TOKEN)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);i=this.consumeComponentValue();do t=this.consumeToken();while(t.type===n.WHITESPACE_TOKEN);if(t.type===n.EOF_TOKEN)return i;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one");},t.prototype.parseComponentValues=function(){for(var i,t=[];;){if(i=this.consumeComponentValue(),i.type===n.EOF_TOKEN)return t;t.push(i);t.push()}},t.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case n.LEFT_CURLY_BRACKET_TOKEN:case n.LEFT_SQUARE_BRACKET_TOKEN:case n.LEFT_PARENTHESIS_TOKEN:return this.consumeSimpleBlock(t.type);case n.FUNCTION_TOKEN:return this.consumeFunction(t)}return t},t.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},i=this.consumeToken();;){if(i.type===n.EOF_TOKEN||ul(i,t))return r;this.reconsumeToken(i);r.values.push(this.consumeComponentValue());i=this.consumeToken()}},t.prototype.consumeFunction=function(t){for(var i,r={name:t.value,values:[],type:n.FUNCTION};;){if(i=this.consumeToken(),i.type===n.EOF_TOKEN||i.type===n.RIGHT_PARENTHESIS_TOKEN)return r;this.reconsumeToken(i);r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var n=this._tokens.shift();return void 0===n?bf:n},t.prototype.reconsumeToken=function(n){this._tokens.unshift(n)},t}(),df=function(t){return t.type===n.DIMENSION_TOKEN},ai=function(t){return t.type===n.NUMBER_TOKEN},f=function(t){return t.type===n.IDENT_TOKEN},rl=function(t){return t.type===n.STRING_TOKEN},gf=function(n,t){return f(n)&&n.value===t},eo=function(t){return t.type!==n.WHITESPACE_TOKEN},vi=function(t){return t.type!==n.WHITESPACE_TOKEN&&t.type!==n.COMMA_TOKEN},ot=function(t){var r=[],i=[];return t.forEach(function(t){if(t.type===n.COMMA_TOKEN){if(0===i.length)throw new Error("Error parsing function args, zero tokens for arg");return r.push(i),void(i=[])}t.type!==n.WHITESPACE_TOKEN&&i.push(t)}),i.length&&r.push(i),r},ul=function(t,i){return i===n.LEFT_CURLY_BRACKET_TOKEN&&t.type===n.RIGHT_CURLY_BRACKET_TOKEN||i===n.LEFT_SQUARE_BRACKET_TOKEN&&t.type===n.RIGHT_SQUARE_BRACKET_TOKEN||i===n.LEFT_PARENTHESIS_TOKEN&&t.type===n.RIGHT_PARENTHESIS_TOKEN},gt=function(t){return t.type===n.NUMBER_TOKEN||t.type===n.DIMENSION_TOKEN},h=function(t){return t.type===n.PERCENTAGE_TOKEN||gt(t)},oo=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},a={type:n.NUMBER_TOKEN,number:0,flags:4},ne={type:n.PERCENTAGE_TOKEN,number:50,flags:4},ni={type:n.PERCENTAGE_TOKEN,number:100,flags:4},hr=function(n,t,i){var r=n[0],u=n[1];return[e(r,t),e(void 0!==u?u:r,i)]},e=function(t,i){if(t.type===n.PERCENTAGE_TOKEN)return t.number/100*i;if(df(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},uu=function(t){if(t.type===n.DIMENSION_TOKEN)switch(t.unit){case"deg":return Math.PI*t.number/180;case"grad":return Math.PI/200*t.number;case"rad":return t.number;case"turn":return 2*Math.PI*t.number}throw new Error("Unsupported angle type");},so=function(t){return t.type===n.DIMENSION_TOKEN&&("deg"===t.unit||"grad"===t.unit||"rad"===t.unit||"turn"===t.unit)},ho=function(n){switch(n.filter(f).map(function(n){return n.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[a,a];case"to top":case"bottom":return tt(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[a,ni];case"to right":case"left":return tt(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[ni,ni];case"to bottom":case"top":return tt(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[ni,a];case"to left":case"right":return tt(270)}return 0},tt=function(n){return Math.PI*n/180},lt=function(t){var e,f,o;if(t.type===n.FUNCTION){if(e=fl[t.name],void 0===e)throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return e(t.values)}if(t.type===n.HASH_TOKEN){if(3===t.value.length){var i=t.value.substring(0,1),r=t.value.substring(1,2),u=t.value.substring(2,3);return ii(parseInt(i+i,16),parseInt(r+r,16),parseInt(u+u,16),1)}if(4===t.value.length)return i=t.value.substring(0,1),r=t.value.substring(1,2),u=t.value.substring(2,3),f=t.value.substring(3,4),ii(parseInt(i+i,16),parseInt(r+r,16),parseInt(u+u,16),parseInt(f+f,16)/255);if(6===t.value.length)return i=t.value.substring(0,2),r=t.value.substring(2,4),u=t.value.substring(4,6),ii(parseInt(i,16),parseInt(r,16),parseInt(u,16),1);if(8===t.value.length)return i=t.value.substring(0,2),r=t.value.substring(2,4),u=t.value.substring(4,6),f=t.value.substring(6,8),ii(parseInt(i,16),parseInt(r,16),parseInt(u,16),parseInt(f,16)/255)}return t.type===n.IDENT_TOKEN&&(o=at[t.value.toUpperCase()],void 0!==o)?o:at.TRANSPARENT},ti=function(n){return 0==(255&n)},b=function(n){var t=255&n,i=255&n>>8,r=255&n>>16,u=255&n>>24;return t<255?"rgba("+u+","+r+","+i+","+t/255+")":"rgb("+u+","+r+","+i+")"},ii=function(n,t,i,r){return(n<<24|t<<16|i<<8|Math.round(255*r)<<0)>>>0},co=function(t,i){if(t.type===n.NUMBER_TOKEN)return t.number;if(t.type===n.PERCENTAGE_TOKEN){var r=3===i?1:255;return 3===i?t.number/100*r:Math.round(t.number/100*r)}return 0},lo=function(n){var i=n.filter(vi),t,o;if(3===i.length){var r=i.map(co),u=r[0],f=r[1],e=r[2];return ii(u,f,e,1)}return 4===i.length?(t=i.map(co),o=(u=t[0],f=t[1],e=t[2],t[3]),ii(u,f,e,o)):0};var u,ut,ao=function(t){var r=t.filter(vi),o=r[0],a=r[1],v=r[2],s=r[3],c=(o.type===n.NUMBER_TOKEN?tt(o.number):uu(o))/(2*Math.PI),u=h(a)?a.number/100:0,i=h(v)?v.number/100:0,y=void 0!==s&&h(s)?e(s,1):1;if(0===u)return ii(255*i,255*i,255*i,1);var f=i<=.5?i*(u+1):i+u-i*u,l=2*i-f,p=te(l,f,c+1/3),w=te(l,f,c),b=te(l,f,c-1/3);return ii(255*p,255*w,255*b,y)},fl={hsl:ao,hsla:ao,rgb:lo,rgba:lo},at={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199};(function(n){n[n.VALUE=0]="VALUE";n[n.LIST=1]="LIST";n[n.IDENT_VALUE=2]="IDENT_VALUE";n[n.TYPE_VALUE=3]="TYPE_VALUE";n[n.TOKEN_VALUE=4]="TOKEN_VALUE"})(u||(u={})),function(n){n[n.BORDER_BOX=0]="BORDER_BOX";n[n.PADDING_BOX=1]="PADDING_BOX";n[n.CONTENT_BOX=2]="CONTENT_BOX"}(ut||(ut={}));var k,v,y,el={name:"background-clip",initialValue:"border-box",prefix:!1,type:u.LIST,parse:function(n){return n.map(function(n){if(f(n))switch(n.value){case"padding-box":return ut.PADDING_BOX;case"content-box":return ut.CONTENT_BOX}return ut.BORDER_BOX})}},ol={name:"background-color",initialValue:"transparent",prefix:!1,type:u.TYPE_VALUE,format:"color"},fu=function(n){var i=lt(n[0]),t=n[1];return t&&h(t)?{color:i,stop:t}:{color:i,stop:null}},vo=function(n,t){var l=n[0],v=n[n.length-1],h,f,u,c;null===l.stop&&(l.stop=a);null===v.stop&&(v.stop=ni);for(var r=[],s=0,i=0;i<n.length;i++)h=n[i].stop,null!==h?(f=e(h,t),f>s?r.push(f):r.push(s),s=f):r.push(null);for(u=null,i=0;i<r.length;i++)if(c=r[i],null===c)null===u&&(u=i);else if(null!==u){for(var y=i-u,p=(c-r[u-1])/(y+1),o=1;o<=y;o++)r[u+o-1]=p*o;u=null}return n.map(function(n,i){return{color:n.color,stop:Math.max(Math.min(1,r[i]/t),0)}})},sl=function(n,t,i){var r="number"==typeof n?n:function(n,t,i){var r=t/2,u=i/2,f=e(n[0],t)-r,o=u-e(n[1],i);return(Math.atan2(o,f)+2*Math.PI)%(2*Math.PI)}(n,t,i),u=Math.abs(t*Math.sin(r))+Math.abs(i*Math.cos(r)),f=t/2,o=i/2,s=u/2,h=Math.sin(r-Math.PI/2)*s,c=Math.cos(r-Math.PI/2)*s;return[u,f-c,f+c,o-h,o+h]},ft=function(n,t){return Math.sqrt(n*n+t*t)},yo=function(n,t,i,r,u){return[[0,0],[0,t],[n,0],[n,t]].reduce(function(n,t){var e=t[0],o=t[1],f=ft(i-e,r-o);return(u?f<n.optimumDistance:f>n.optimumDistance)?{optimumCorner:t,optimumDistance:f}:n},{optimumDistance:u?1/0:-1/0,optimumCorner:null}).optimumCorner},eu=function(t){var i=tt(180),r=[];return ot(t).forEach(function(t,u){var f,e;if(0===u){if(f=t[0],f.type===n.IDENT_TOKEN&&-1!==["top","left","right","bottom"].indexOf(f.value))return void(i=ho(t));if(so(f))return void(i=(uu(f)+tt(270))%tt(360))}e=fu(t);r.push(e)}),{angle:i,stops:r,type:k.LINEAR_GRADIENT}},po=function(n){return 0===n[0]&&255===n[1]&&0===n[2]&&255===n[3]},ie=function(n,t,i,r,u){var o="http://www.w3.org/2000/svg",e=document.createElementNS(o,"svg"),f=document.createElementNS(o,"foreignObject");return e.setAttributeNS(null,"width",n.toString()),e.setAttributeNS(null,"height",t.toString()),f.setAttributeNS(null,"width","100%"),f.setAttributeNS(null,"height","100%"),f.setAttributeNS(null,"x",i.toString()),f.setAttributeNS(null,"y",r.toString()),f.setAttributeNS(null,"externalResourcesRequired","true"),e.appendChild(f),f.appendChild(u),e},wo=function(n){return new Promise(function(t,i){var r=new Image;r.onload=function(){return t(r)};r.onerror=i;r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(n))})},it={get SUPPORT_RANGE_BOUNDS(){var n=function(n){var i,t,r,u;return n.createRange&&(i=n.createRange(),i.getBoundingClientRect&&(t=n.createElement("boundtest"),t.style.height="123px",t.style.display="block",n.body.appendChild(t),i.selectNode(t),r=i.getBoundingClientRect(),u=Math.round(r.height),n.body.removeChild(t),123===u))?!0:!1}(document);return Object.defineProperty(it,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=function(n){var t=new Image,i=n.createElement("canvas"),r=i.getContext("2d");if(!r)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'><\/svg>";try{r.drawImage(t,0,0);i.toDataURL()}catch(n){return!1}return!0}(document);return Object.defineProperty(it,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n="function"==typeof Array.from&&"function"==typeof fetch?function(n){var i=n.createElement("canvas"),t,r,u,f;return(i.width=100,i.height=100,t=i.getContext("2d"),!t)?Promise.reject(!1):(t.fillStyle="rgb(0, 255, 0)",t.fillRect(0,0,100,100),r=new Image,u=i.toDataURL(),r.src=u,f=ie(100,100,0,0,r),t.fillStyle="red",t.fillRect(0,0,100,100),wo(f).then(function(i){var f,r;return t.drawImage(i,0,0),f=t.getImageData(0,0,100,100).data,t.fillStyle="red",t.fillRect(0,0,100,100),r=n.createElement("div"),r.style.backgroundImage="url("+u+")",r.style.height="100px",po(f)?wo(ie(100,100,0,0,r)):Promise.reject(!1)}).then(function(n){return t.drawImage(n,0,0),po(t.getImageData(0,0,100,100).data)}).catch(function(){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(it,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=void 0!==(new Image).crossOrigin;return Object.defineProperty(it,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(it,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(it,"SUPPORT_CORS_XHR",{value:n}),n}},c=function(){function n(n){var t=n.id,i=n.enabled;this.id=t;this.enabled=i;this.start=Date.now()}return n.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,[this.id,this.getTime()+"ms"].concat(t)):this.info.apply(this,t))},n.prototype.getTime=function(){return Date.now()-this.start},n.create=function(t){n.instances[t.id]=new n(t)},n.destroy=function(t){delete n.instances[t]},n.getInstance=function(t){var i=n.instances[t];if(void 0===i)throw new Error("No logger instance found with id "+t);return i},n.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,[this.id,this.getTime()+"ms"].concat(t))},n.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,[this.id,this.getTime()+"ms"].concat(t)):this.info.apply(this,t))},n.instances={},n}(),vt=function(){function n(){}return n.create=function(t,i){return n._caches[t]=new hl(t,i)},n.destroy=function(t){delete n._caches[t]},n.open=function(t){var i=n._caches[t];if(void 0!==i)return i;throw new Error('Cache with key "'+t+'" not found');},n.getOrigin=function(t){var i=n._link;return i?(i.href=t,i.href=i.href,i.protocol+i.hostname+i.port):"about:blank"},n.isSameOrigin=function(t){return n.getOrigin(t)===n._origin},n.setContext=function(t){n._link=t.document.createElement("a");n._origin=n.getOrigin(t.location.href)},n.getInstance=function(){var t=n._current;if(null===t)throw new Error("No cache instance attached");return t},n.attachInstance=function(t){n._current=t},n.detachInstance=function(){n._current=null},n._caches={},n._origin="about:blank",n._current=null,n}(),hl=function(){function n(n,t){this.id=n;this._options=t;this._cache={}}return n.prototype.addImage=function(n){var t=Promise.resolve();return this.has(n)?t:pl(n)||vl(n)?(this._cache[n]=this.loadImage(n),t):t},n.prototype.match=function(n){return this._cache[n]},n.prototype.loadImage=function(n){return nt(this,void 0,void 0,function(){var i,r,u,t,f=this;return d(this,function(e){switch(e.label){case 0:return i=vt.isSameOrigin(n),r=!re(n)&&!0===this._options.useCORS&&it.SUPPORT_CORS_IMAGES&&!i,u=!re(n)&&!i&&"string"==typeof this._options.proxy&&it.SUPPORT_CORS_XHR&&!r,i||!1!==this._options.allowTaint||re(n)||u||r?(t=n,u?[4,this.proxy(t)]:[3,2]):[2];case 1:t=e.sent();e.label=2;case 2:return c.getInstance(this.id).debug("Added image "+n.substring(0,256)),[4,new Promise(function(n,i){var u=new Image;u.onload=function(){return n(u)};u.onerror=i;(yl(t)||r)&&(u.crossOrigin="anonymous");u.src=t;!0===u.complete&&setTimeout(function(){return n(u)},500);f._options.imageTimeout>0&&setTimeout(function(){return i("Timed out ("+f._options.imageTimeout+"ms) loading image")},f._options.imageTimeout)})];case 3:return[2,e.sent()]}})})},n.prototype.has=function(n){return void 0!==this._cache[n]},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(n){var i=this,r=this._options.proxy,t;if(!r)throw new Error("No proxy defined");return t=n.substring(0,256),new Promise(function(u,f){var o=it.SUPPORT_RESPONSE_TYPE?"blob":"text",e=new XMLHttpRequest,s;(e.onload=function(){if(200===e.status)if("text"===o)u(e.response);else{var n=new FileReader;n.addEventListener("load",function(){return u(n.result)},!1);n.addEventListener("error",function(n){return f(n)},!1);n.readAsDataURL(e.response)}else f("Failed to proxy resource "+t+" with status code "+e.status)},e.onerror=f,e.open("GET",r+"?url="+encodeURIComponent(n)+"&responseType="+o),"text"!==o&&e instanceof XMLHttpRequest&&(e.responseType=o),i._options.imageTimeout)&&(s=i._options.imageTimeout,e.timeout=s,e.ontimeout=function(){return f("Timed out ("+s+"ms) proxying "+t)});e.send()})},n}(),cl=/^data:image\/svg\+xml/i,ll=/^data:image\/.*;base64,/i,al=/^data:image\/.*/i,vl=function(n){return it.SUPPORT_SVG_DRAWING||!wl(n)},re=function(n){return al.test(n)},yl=function(n){return ll.test(n)},pl=function(n){return"blob"===n.substr(0,4)},wl=function(n){return"svg"===n.substr(-3).toLowerCase()||cl.test(n)},ou=function(n){var r=v.CIRCLE,t=y.FARTHEST_CORNER,u=[],i=[];return ot(n).forEach(function(n,e){var o=!0,s;(0===e?o=n.reduce(function(n,t){if(f(t))switch(t.value){case"center":return i.push(ne),!1;case"top":case"left":return i.push(a),!1;case"right":case"bottom":return i.push(ni),!1}else if(h(t)||gt(t))return i.push(t),!1;return n},o):1===e&&(o=n.reduce(function(n,i){if(f(i))switch(i.value){case"circle":return r=v.CIRCLE,!1;case"ellipse":return r=v.ELLIPSE,!1;case"contain":case"closest-side":return t=y.CLOSEST_SIDE,!1;case"farthest-side":return t=y.FARTHEST_SIDE,!1;case"closest-corner":return t=y.CLOSEST_CORNER,!1;case"cover":case"farthest-corner":return t=y.FARTHEST_CORNER,!1}else if(gt(i)||h(i))return Array.isArray(t)||(t=[]),t.push(i),!1;return n},o)),o)&&(s=fu(n),u.push(s))}),{size:t,shape:r,stops:u,position:i,type:k.RADIAL_GRADIENT}};!function(n){n[n.URL=0]="URL";n[n.LINEAR_GRADIENT=1]="LINEAR_GRADIENT";n[n.RADIAL_GRADIENT=2]="RADIAL_GRADIENT"}(k||(k={})),function(n){n[n.CIRCLE=0]="CIRCLE";n[n.ELLIPSE=1]="ELLIPSE"}(v||(v={})),function(n){n[n.CLOSEST_SIDE=0]="CLOSEST_SIDE";n[n.FARTHEST_SIDE=1]="FARTHEST_SIDE";n[n.CLOSEST_CORNER=2]="CLOSEST_CORNER";n[n.FARTHEST_CORNER=3]="FARTHEST_CORNER"}(y||(y={}));var yt,ue=function(t){var r,i;if(t.type===n.URL_TOKEN)return r={url:t.value,type:k.URL},vt.getInstance().addImage(t.value),r;if(t.type===n.FUNCTION){if(i=bo[t.name],void 0===i)throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return i(t.values)}throw new Error("Unsupported image type");},bo={"linear-gradient":function(t){var i=tt(180),r=[];return ot(t).forEach(function(t,u){var f,e;if(0===u){if(f=t[0],f.type===n.IDENT_TOKEN&&"to"===f.value)return void(i=ho(t));if(so(f))return void(i=uu(f))}e=fu(t);r.push(e)}),{angle:i,stops:r,type:k.LINEAR_GRADIENT}},"-moz-linear-gradient":eu,"-ms-linear-gradient":eu,"-o-linear-gradient":eu,"-webkit-linear-gradient":eu,"radial-gradient":function(n){var r=v.CIRCLE,t=y.FARTHEST_CORNER,u=[],i=[];return ot(n).forEach(function(n,e){var o=!0,s,c;0===e&&(s=!1,o=n.reduce(function(n,u){if(s)if(f(u))switch(u.value){case"center":return i.push(ne),n;case"top":case"left":return i.push(a),n;case"right":case"bottom":return i.push(ni),n}else(h(u)||gt(u))&&i.push(u);else if(f(u))switch(u.value){case"circle":return r=v.CIRCLE,!1;case"ellipse":return r=v.ELLIPSE,!1;case"at":return s=!0,!1;case"closest-side":return t=y.CLOSEST_SIDE,!1;case"cover":case"farthest-side":return t=y.FARTHEST_SIDE,!1;case"contain":case"closest-corner":return t=y.CLOSEST_CORNER,!1;case"farthest-corner":return t=y.FARTHEST_CORNER,!1}else if(gt(u)||h(u))return Array.isArray(t)||(t=[]),t.push(u),!1;return n},o));o&&(c=fu(n),u.push(c))}),{size:t,shape:r,stops:u,position:i,type:k.RADIAL_GRADIENT}},"-moz-radial-gradient":ou,"-ms-radial-gradient":ou,"-o-radial-gradient":ou,"-webkit-radial-gradient":ou,"-webkit-gradient":function(t){var u=tt(180),i=[],r=k.LINEAR_GRADIENT,e=v.CIRCLE,o=y.FARTHEST_CORNER;return ot(t).forEach(function(t,u){var e=t[0],o,s,h;if(0===u){if(f(e)&&"linear"===e.value)return void(r=k.LINEAR_GRADIENT);if(f(e)&&"radial"===e.value)return void(r=k.RADIAL_GRADIENT)}e.type===n.FUNCTION&&("from"===e.name?(o=lt(e.values[0]),i.push({stop:a,color:o})):"to"===e.name?(o=lt(e.values[0]),i.push({stop:ni,color:o})):"color-stop"===e.name&&(s=e.values.filter(vi),2===s.length&&(o=lt(s[1]),h=s[0],ai(h)&&i.push({stop:{type:n.PERCENTAGE_TOKEN,number:100*h.number,flags:h.flags},color:o}))))}),r===k.LINEAR_GRADIENT?{angle:(u+tt(180))%tt(360),stops:i,type:r}:{size:o,shape:e,stops:i,position:[],type:r}}},bl={name:"background-image",initialValue:"none",type:u.LIST,prefix:!1,parse:function(t){if(0===t.length)return[];var i=t[0];return i.type===n.IDENT_TOKEN&&"none"===i.value?[]:t.filter(function(t){return vi(t)&&function(t){return t.type!==n.FUNCTION||bo[t.name]}(t)}).map(ue)}},kl={name:"background-origin",initialValue:"border-box",prefix:!1,type:u.LIST,parse:function(n){return n.map(function(n){if(f(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},dl={name:"background-position",initialValue:"0% 0%",type:u.LIST,prefix:!1,parse:function(n){return ot(n).map(function(n){return n.filter(h)}).map(oo)}};!function(n){n[n.REPEAT=0]="REPEAT";n[n.NO_REPEAT=1]="NO_REPEAT";n[n.REPEAT_X=2]="REPEAT_X";n[n.REPEAT_Y=3]="REPEAT_Y"}(yt||(yt={}));ko={name:"background-repeat",initialValue:"repeat",prefix:!1,type:u.LIST,parse:function(n){return ot(n).map(function(n){return n.filter(f).map(function(n){return n.value}).join(" ")}).map(go)}};go=function(n){switch(n){case"no-repeat":return yt.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return yt.REPEAT_X;case"repeat-y":case"no-repeat repeat":return yt.REPEAT_Y;case"repeat":default:return yt.REPEAT}};!function(n){n.AUTO="auto";n.CONTAIN="contain";n.COVER="cover"}(yi||(yi={}));var pi,gl={name:"background-size",initialValue:"0",prefix:!1,type:u.LIST,parse:function(n){return ot(n).map(function(n){return n.filter(na)})}},na=function(n){return f(n)||h(n)},su=function(n){return{name:"border-"+n+"-color",initialValue:"transparent",prefix:!1,type:u.TYPE_VALUE,format:"color"}},ta=su("top"),ia=su("right"),ra=su("bottom"),ua=su("left"),hu=function(n){return{name:"border-radius-"+n,initialValue:"0 0",prefix:!1,type:u.LIST,parse:function(n){return oo(n.filter(h))}}},fa=hu("top-left"),ea=hu("top-right"),oa=hu("bottom-right"),sa=hu("bottom-left");!function(n){n[n.NONE=0]="NONE";n[n.SOLID=1]="SOLID"}(pi||(pi={}));var ri,cu=function(n){return{name:"border-"+n+"-style",initialValue:"solid",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"none":return pi.NONE}return pi.SOLID}}},ha=cu("top"),ca=cu("right"),la=cu("bottom"),aa=cu("left"),lu=function(n){return{name:"border-"+n+"-width",initialValue:"0",type:u.VALUE,prefix:!1,parse:function(n){return df(n)?n.number:0}}},va=lu("top"),ya=lu("right"),pa=lu("bottom"),wa=lu("left"),ba={name:"color",initialValue:"transparent",prefix:!1,type:u.TYPE_VALUE,format:"color"},ka={name:"display",initialValue:"inline-block",prefix:!1,type:u.LIST,parse:function(n){return n.filter(f).reduce(function(n,t){return n|da(t.value)},0)}},da=function(n){switch(n){case"block":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0};!function(n){n[n.NONE=0]="NONE";n[n.LEFT=1]="LEFT";n[n.RIGHT=2]="RIGHT";n[n.INLINE_START=3]="INLINE_START";n[n.INLINE_END=4]="INLINE_END"}(ri||(ri={}));ns={name:"float",initialValue:"none",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"left":return ri.LEFT;case"right":return ri.RIGHT;case"inline-start":return ri.INLINE_START;case"inline-end":return ri.INLINE_END}return ri.NONE}};ts={name:"letter-spacing",initialValue:"0",prefix:!1,type:u.VALUE,parse:function(t){return t.type===n.IDENT_TOKEN&&"normal"===t.value?0:t.type===n.NUMBER_TOKEN||t.type===n.DIMENSION_TOKEN?t.number:0}};!function(n){n.NORMAL="normal";n.STRICT="strict"}(au||(au={}));var vu,ga={name:"line-break",initialValue:"normal",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"strict":return au.STRICT;case"normal":default:return au.NORMAL}}},nv={name:"line-height",initialValue:"normal",prefix:!1,type:u.TOKEN_VALUE},tv={name:"list-style-image",initialValue:"none",type:u.VALUE,prefix:!1,parse:function(t){return t.type===n.IDENT_TOKEN&&"none"===t.value?null:ue(t)}};!function(n){n[n.INSIDE=0]="INSIDE";n[n.OUTSIDE=1]="OUTSIDE"}(vu||(vu={}));is={name:"list-style-position",initialValue:"outside",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"inside":return vu.INSIDE;case"outside":default:return vu.OUTSIDE}}};!function(n){n[n.NONE=-1]="NONE";n[n.DISC=0]="DISC";n[n.CIRCLE=1]="CIRCLE";n[n.SQUARE=2]="SQUARE";n[n.DECIMAL=3]="DECIMAL";n[n.CJK_DECIMAL=4]="CJK_DECIMAL";n[n.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO";n[n.LOWER_ROMAN=6]="LOWER_ROMAN";n[n.UPPER_ROMAN=7]="UPPER_ROMAN";n[n.LOWER_GREEK=8]="LOWER_GREEK";n[n.LOWER_ALPHA=9]="LOWER_ALPHA";n[n.UPPER_ALPHA=10]="UPPER_ALPHA";n[n.ARABIC_INDIC=11]="ARABIC_INDIC";n[n.ARMENIAN=12]="ARMENIAN";n[n.BENGALI=13]="BENGALI";n[n.CAMBODIAN=14]="CAMBODIAN";n[n.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH";n[n.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM";n[n.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC";n[n.DEVANAGARI=18]="DEVANAGARI";n[n.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC";n[n.GEORGIAN=20]="GEORGIAN";n[n.GUJARATI=21]="GUJARATI";n[n.GURMUKHI=22]="GURMUKHI";n[n.HEBREW=22]="HEBREW";n[n.HIRAGANA=23]="HIRAGANA";n[n.HIRAGANA_IROHA=24]="HIRAGANA_IROHA";n[n.JAPANESE_FORMAL=25]="JAPANESE_FORMAL";n[n.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL";n[n.KANNADA=27]="KANNADA";n[n.KATAKANA=28]="KATAKANA";n[n.KATAKANA_IROHA=29]="KATAKANA_IROHA";n[n.KHMER=30]="KHMER";n[n.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL";n[n.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL";n[n.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL";n[n.LAO=34]="LAO";n[n.LOWER_ARMENIAN=35]="LOWER_ARMENIAN";n[n.MALAYALAM=36]="MALAYALAM";n[n.MONGOLIAN=37]="MONGOLIAN";n[n.MYANMAR=38]="MYANMAR";n[n.ORIYA=39]="ORIYA";n[n.PERSIAN=40]="PERSIAN";n[n.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL";n[n.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL";n[n.TAMIL=43]="TAMIL";n[n.TELUGU=44]="TELUGU";n[n.THAI=45]="THAI";n[n.TIBETAN=46]="TIBETAN";n[n.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL";n[n.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL";n[n.UPPER_ARMENIAN=49]="UPPER_ARMENIAN";n[n.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN";n[n.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED"}(t||(t={}));var ui,fe={name:"list-style-type",initialValue:"none",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"disc":return t.DISC;case"circle":return t.CIRCLE;case"square":return t.SQUARE;case"decimal":return t.DECIMAL;case"cjk-decimal":return t.CJK_DECIMAL;case"decimal-leading-zero":return t.DECIMAL_LEADING_ZERO;case"lower-roman":return t.LOWER_ROMAN;case"upper-roman":return t.UPPER_ROMAN;case"lower-greek":return t.LOWER_GREEK;case"lower-alpha":return t.LOWER_ALPHA;case"upper-alpha":return t.UPPER_ALPHA;case"arabic-indic":return t.ARABIC_INDIC;case"armenian":return t.ARMENIAN;case"bengali":return t.BENGALI;case"cambodian":return t.CAMBODIAN;case"cjk-earthly-branch":return t.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return t.CJK_HEAVENLY_STEM;case"cjk-ideographic":return t.CJK_IDEOGRAPHIC;case"devanagari":return t.DEVANAGARI;case"ethiopic-numeric":return t.ETHIOPIC_NUMERIC;case"georgian":return t.GEORGIAN;case"gujarati":return t.GUJARATI;case"gurmukhi":return t.GURMUKHI;case"hebrew":return t.HEBREW;case"hiragana":return t.HIRAGANA;case"hiragana-iroha":return t.HIRAGANA_IROHA;case"japanese-formal":return t.JAPANESE_FORMAL;case"japanese-informal":return t.JAPANESE_INFORMAL;case"kannada":return t.KANNADA;case"katakana":return t.KATAKANA;case"katakana-iroha":return t.KATAKANA_IROHA;case"khmer":return t.KHMER;case"korean-hangul-formal":return t.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return t.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return t.KOREAN_HANJA_INFORMAL;case"lao":return t.LAO;case"lower-armenian":return t.LOWER_ARMENIAN;case"malayalam":return t.MALAYALAM;case"mongolian":return t.MONGOLIAN;case"myanmar":return t.MYANMAR;case"oriya":return t.ORIYA;case"persian":return t.PERSIAN;case"simp-chinese-formal":return t.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return t.SIMP_CHINESE_INFORMAL;case"tamil":return t.TAMIL;case"telugu":return t.TELUGU;case"thai":return t.THAI;case"tibetan":return t.TIBETAN;case"trad-chinese-formal":return t.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return t.TRAD_CHINESE_INFORMAL;case"upper-armenian":return t.UPPER_ARMENIAN;case"disclosure-open":return t.DISCLOSURE_OPEN;case"disclosure-closed":return t.DISCLOSURE_CLOSED;case"none":default:return t.NONE}}},yu=function(n){return{name:"margin-"+n,initialValue:"0",prefix:!1,type:u.TOKEN_VALUE}},iv=yu("top"),rv=yu("right"),uv=yu("bottom"),fv=yu("left");!function(n){n[n.VISIBLE=0]="VISIBLE";n[n.HIDDEN=1]="HIDDEN";n[n.SCROLL=2]="SCROLL";n[n.AUTO=3]="AUTO"}(ui||(ui={}));rs={name:"overflow",initialValue:"visible",prefix:!1,type:u.LIST,parse:function(n){return n.filter(f).map(function(n){switch(n.value){case"hidden":return ui.HIDDEN;case"scroll":return ui.SCROLL;case"auto":return ui.AUTO;case"visible":default:return ui.VISIBLE}})}};!function(n){n.NORMAL="normal";n.BREAK_WORD="break-word"}(cr||(cr={}));var st,ev={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"break-word":return cr.BREAK_WORD;case"normal":default:return cr.NORMAL}}},pu=function(n){return{name:"padding-"+n,initialValue:"0",prefix:!1,type:u.TYPE_VALUE,format:"length-percentage"}},ov=pu("top"),sv=pu("right"),hv=pu("bottom"),cv=pu("left");!function(n){n[n.LEFT=0]="LEFT";n[n.CENTER=1]="CENTER";n[n.RIGHT=2]="RIGHT"}(st||(st={}));us={name:"text-align",initialValue:"left",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"right":return st.RIGHT;case"center":case"justify":return st.CENTER;case"left":default:return st.LEFT}}};!function(n){n[n.STATIC=0]="STATIC";n[n.RELATIVE=1]="RELATIVE";n[n.ABSOLUTE=2]="ABSOLUTE";n[n.FIXED=3]="FIXED";n[n.STICKY=4]="STICKY"}(fi||(fi={}));fs={name:"position",initialValue:"static",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"relative":return fi.RELATIVE;case"absolute":return fi.ABSOLUTE;case"fixed":return fi.FIXED;case"sticky":return fi.STICKY}return fi.STATIC}};es={name:"text-shadow",initialValue:"none",type:u.LIST,prefix:!1,parse:function(n){return 1===n.length&&gf(n[0],"none")?[]:ot(n).map(function(n){for(var t,i={color:at.TRANSPARENT,offsetX:a,offsetY:a,blur:a},r=0,u=0;u<n.length;u++)t=n[u],gt(t)?(0===r?i.offsetX=t:1===r?i.offsetY=t:i.blur=t,r++):i.color=lt(t);return i})}};!function(n){n[n.NONE=0]="NONE";n[n.LOWERCASE=1]="LOWERCASE";n[n.UPPERCASE=2]="UPPERCASE";n[n.CAPITALIZE=3]="CAPITALIZE"}(pt||(pt={}));var wi,lv={name:"text-transform",initialValue:"none",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"uppercase":return pt.UPPERCASE;case"lowercase":return pt.LOWERCASE;case"capitalize":return pt.CAPITALIZE}return pt.NONE}},av={name:"transform",initialValue:"none",prefix:!0,type:u.VALUE,parse:function(t){if(t.type===n.IDENT_TOKEN&&"none"===t.value)return null;if(t.type===n.FUNCTION){var i=vv[t.name];if(void 0===i)throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return i(t.values)}return null}},vv={matrix:function(t){var i=t.filter(function(t){return t.type===n.NUMBER_TOKEN}).map(function(n){return n.number});return 6===i.length?i:null},matrix3d:function(t){var i=t.filter(function(t){return t.type===n.NUMBER_TOKEN}).map(function(n){return n.number}),r=i[0],u=i[1],f=(i[2],i[3],i[4]),e=i[5],o=(i[6],i[7],i[8],i[9],i[10],i[11],i[12]),s=i[13];return i[14],i[15],16===i.length?[r,u,f,e,o,s]:null}},os={type:n.PERCENTAGE_TOKEN,number:50,flags:4},yv=[os,os],pv={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:u.LIST,parse:function(n){var t=n.filter(h);return 2!==t.length?yv:[t[0],t[1]]}};!function(n){n[n.VISIBLE=0]="VISIBLE";n[n.HIDDEN=1]="HIDDEN";n[n.COLLAPSE=2]="COLLAPSE"}(wi||(wi={}));ss={name:"visible",initialValue:"none",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"hidden":return wi.HIDDEN;case"collapse":return wi.COLLAPSE;case"visible":default:return wi.VISIBLE}}};!function(n){n.NORMAL="normal";n.BREAK_ALL="break-all";n.KEEP_ALL="keep-all"}(lr||(lr={}));var ar,wv={name:"word-break",initialValue:"normal",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"break-all":return lr.BREAK_ALL;case"keep-all":return lr.KEEP_ALL;case"normal":default:return lr.NORMAL}}},bv={name:"z-index",initialValue:"auto",prefix:!1,type:u.VALUE,parse:function(t){if(t.type===n.IDENT_TOKEN)return{auto:!0,order:0};if(ai(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed");}},kv={name:"opacity",initialValue:"1",type:u.VALUE,prefix:!1,parse:function(n){return ai(n)?n.number:1}},dv={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:u.TYPE_VALUE,format:"color"},gv={name:"text-decoration-line",initialValue:"none",prefix:!1,type:u.LIST,parse:function(n){return n.filter(f).map(function(n){switch(n.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(n){return 0!==n})}},ny={name:"font-family",initialValue:"",prefix:!1,type:u.LIST,parse:function(n){return n.filter(ty).map(function(n){return n.value})}},ty=function(t){return t.type===n.STRING_TOKEN||t.type===n.IDENT_TOKEN},iy={name:"font-size",initialValue:"0",prefix:!1,type:u.TYPE_VALUE,format:"length"},ry={name:"font-weight",initialValue:"normal",type:u.VALUE,prefix:!1,parse:function(n){if(ai(n))return n.number;if(f(n))switch(n.value){case"bold":return 700;case"normal":default:return 400}return 400}},uy={name:"font-variant",initialValue:"none",type:u.LIST,prefix:!1,parse:function(n){return n.filter(f).map(function(n){return n.value})}};!function(n){n.NORMAL="normal";n.ITALIC="italic";n.OBLIQUE="oblique"}(ar||(ar={}));var vr,fy={name:"font-style",initialValue:"normal",prefix:!1,type:u.IDENT_VALUE,parse:function(n){switch(n){case"oblique":return ar.OBLIQUE;case"italic":return ar.ITALIC;case"normal":default:return ar.NORMAL}}},p=function(n,t){return 0!=(n&t)},ey={name:"content",initialValue:"none",type:u.LIST,prefix:!1,parse:function(t){if(0===t.length)return[];var i=t[0];return i.type===n.IDENT_TOKEN&&"none"===i.value?[]:t}},oy={name:"counter-increment",initialValue:"none",prefix:!0,type:u.LIST,parse:function(t){var u,e,r,s;if(0===t.length||(u=t[0],u.type===n.IDENT_TOKEN&&"none"===u.value))return null;for(var o=[],f=t.filter(eo),i=0;i<f.length;i++)e=f[i],r=f[i+1],e.type===n.IDENT_TOKEN&&(s=r&&ai(r)?r.number:1,o.push({counter:e.value,increment:s}));return o}},sy={name:"counter-reset",initialValue:"none",prefix:!0,type:u.LIST,parse:function(n){var i,r,o;if(0===n.length)return[];for(var e=[],u=n.filter(eo),t=0;t<u.length;t++)i=u[t],r=u[t+1],f(i)&&"none"!==i.value&&(o=r&&ai(r)?r.number:0,e.push({counter:i.value,reset:o}));return e}},hy={name:"quotes",initialValue:"none",prefix:!0,type:u.LIST,parse:function(t){var u,f,i,r,e,o;if(0===t.length||(u=t[0],u.type===n.IDENT_TOKEN&&"none"===u.value)||(f=[],i=t.filter(rl),i.length%2!=0))return null;for(r=0;r<i.length;r+=2)e=i[r].value,o=i[r+1].value,f.push({open:e,close:o});return f}},hs=function(n,t,i){if(!n)return"";var r=n[Math.min(t,n.length-1)];return r?i?r.open:r.close:""},cy={name:"box-shadow",initialValue:"none",type:u.LIST,prefix:!1,parse:function(n){return 1===n.length&&gf(n[0],"none")?[]:ot(n).map(function(n){for(var t,i={color:255,offsetX:a,offsetY:a,blur:a,spread:a,inset:!1},r=0,u=0;u<n.length;u++)t=n[u],gf(t,"inset")?i.inset=!0:gt(t)?(0===r?i.offsetX=t:1===r?i.offsetY=t:2===r?i.blur=t:i.spread=t,r++):i.color=lt(t);return i})}},ly=function(){function n(n){this.backgroundClip=i(el,n.backgroundClip);this.backgroundColor=i(ol,n.backgroundColor);this.backgroundImage=i(bl,n.backgroundImage);this.backgroundOrigin=i(kl,n.backgroundOrigin);this.backgroundPosition=i(dl,n.backgroundPosition);this.backgroundRepeat=i(ko,n.backgroundRepeat);this.backgroundSize=i(gl,n.backgroundSize);this.borderTopColor=i(ta,n.borderTopColor);this.borderRightColor=i(ia,n.borderRightColor);this.borderBottomColor=i(ra,n.borderBottomColor);this.borderLeftColor=i(ua,n.borderLeftColor);this.borderTopLeftRadius=i(fa,n.borderTopLeftRadius);this.borderTopRightRadius=i(ea,n.borderTopRightRadius);this.borderBottomRightRadius=i(oa,n.borderBottomRightRadius);this.borderBottomLeftRadius=i(sa,n.borderBottomLeftRadius);this.borderTopStyle=i(ha,n.borderTopStyle);this.borderRightStyle=i(ca,n.borderRightStyle);this.borderBottomStyle=i(la,n.borderBottomStyle);this.borderLeftStyle=i(aa,n.borderLeftStyle);this.borderTopWidth=i(va,n.borderTopWidth);this.borderRightWidth=i(ya,n.borderRightWidth);this.borderBottomWidth=i(pa,n.borderBottomWidth);this.borderLeftWidth=i(wa,n.borderLeftWidth);this.boxShadow=i(cy,n.boxShadow);this.color=i(ba,n.color);this.display=i(ka,n.display);this.float=i(ns,n.cssFloat);this.fontFamily=i(ny,n.fontFamily);this.fontSize=i(iy,n.fontSize);this.fontStyle=i(fy,n.fontStyle);this.fontVariant=i(uy,n.fontVariant);this.fontWeight=i(ry,n.fontWeight);this.letterSpacing=i(ts,n.letterSpacing);this.lineBreak=i(ga,n.lineBreak);this.lineHeight=i(nv,n.lineHeight);this.listStyleImage=i(tv,n.listStyleImage);this.listStylePosition=i(is,n.listStylePosition);this.listStyleType=i(fe,n.listStyleType);this.marginTop=i(iv,n.marginTop);this.marginRight=i(rv,n.marginRight);this.marginBottom=i(uv,n.marginBottom);this.marginLeft=i(fv,n.marginLeft);this.opacity=i(kv,n.opacity);var t=i(rs,n.overflow);this.overflowX=t[0];this.overflowY=t[t.length>1?1:0];this.overflowWrap=i(ev,n.overflowWrap);this.paddingTop=i(ov,n.paddingTop);this.paddingRight=i(sv,n.paddingRight);this.paddingBottom=i(hv,n.paddingBottom);this.paddingLeft=i(cv,n.paddingLeft);this.position=i(fs,n.position);this.textAlign=i(us,n.textAlign);this.textDecorationColor=i(dv,n.textDecorationColor||n.color);this.textDecorationLine=i(gv,n.textDecorationLine);this.textShadow=i(es,n.textShadow);this.textTransform=i(lv,n.textTransform);this.transform=i(av,n.transform);this.transformOrigin=i(pv,n.transformOrigin);this.visibility=i(ss,n.visibility);this.wordBreak=i(wv,n.wordBreak);this.zIndex=i(bv,n.zIndex)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===wi.VISIBLE},n.prototype.isTransparent=function(){return ti(this.backgroundColor)},n.prototype.isTransformed=function(){return null!==this.transform},n.prototype.isPositioned=function(){return this.position!==fi.STATIC},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==ri.NONE},n.prototype.isInlineLevel=function(){return p(this.display,4)||p(this.display,33554432)||p(this.display,268435456)||p(this.display,536870912)||p(this.display,67108864)||p(this.display,134217728)},n}(),ay=function(n){this.content=i(ey,n.content);this.quotes=i(hy,n.quotes)},cs=function(n){this.counterIncrement=i(oy,n.counterIncrement);this.counterReset=i(sy,n.counterReset)},i=function(n,t){var s=new fo,c=null!=t?t.toString():n.initialValue,i,r,e,o;s.write(c);i=new kf(s.read());switch(n.type){case u.IDENT_VALUE:return r=i.parseComponentValue(),n.parse(f(r)?r.value:n.initialValue);case u.VALUE:return n.parse(i.parseComponentValue());case u.LIST:return n.parse(i.parseComponentValues());case u.TOKEN_VALUE:return i.parseComponentValue();case u.TYPE_VALUE:switch(n.format){case"angle":return uu(i.parseComponentValue());case"color":return lt(i.parseComponentValue());case"image":return ue(i.parseComponentValue());case"length":return e=i.parseComponentValue(),gt(e)?e:a;case"length-percentage":return o=i.parseComponentValue(),h(o)?o:a}}throw new Error("Attempting to parse unsupported css format type "+n.format);},ht=function(n){this.styles=new ly(window.getComputedStyle(n,null));this.textNodes=[];this.elements=[];null!==this.styles.transform&&ih(n)&&(n.style.transform="none");this.bounds=of(n);this.flags=0},wu=function(n,t){this.text=n;this.bounds=t},vy=function(n){var r=n.ownerDocument,t,i,u;return r&&(t=r.createElement("html2canvaswrapper"),t.appendChild(n.cloneNode(!0)),i=n.parentNode,i)?(i.replaceChild(t,n),u=of(t),t.firstChild&&i.replaceChild(t.firstChild,t),u):new bt(0,0,0,0)},yy=function(n,t,i){var u=n.ownerDocument,r;if(!u)throw new Error("Node has no owner document");return r=u.createRange(),r.setStart(n,t),r.setEnd(n,t+i),bt.fromClientRect(r.getBoundingClientRect())},py=function(n,t){return 0!==t.letterSpacing?wr(n).map(function(n){return s(n)}):wy(n,t)},wy=function(n,t){for(var i,u=function(n,t){var r=wr(n),u=tc(r,t),o=u[0],s=u[1],h=u[2],f=r.length,e=0,i=0;return{next:function(){var n,t;if(i>=f)return{done:!0,value:null};for(n="×";i<f&&"×"===(n=nc(r,s,o,++i,h)););return"×"!==n||i===f?(t=new ic(r,n,e,i),e=i,{value:t,done:!1}):{done:!0,value:null}}}}(n,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap===cr.BREAK_WORD?"break-word":t.wordBreak}),r=[];!(i=u.next()).done;)i.value&&r.push(i.value.slice());return r},by=function(n,t){this.text=ky(n.data,t.textTransform);this.textBounds=function(n,t,i){var f=py(n,t),r=[],u=0;return f.forEach(function(n){if(t.textDecorationLine.length||n.trim().length>0)if(it.SUPPORT_RANGE_BOUNDS)r.push(new wu(n,yy(i,u,n.length)));else{var f=i.splitText(n.length);r.push(new wu(n,vy(i)));i=f}else it.SUPPORT_RANGE_BOUNDS||(i=i.splitText(n.length));u+=n.length}),r}(this.text,t,n)},ky=function(n,t){switch(t){case pt.LOWERCASE:return n.toLowerCase();case pt.CAPITALIZE:return n.replace(dy,gy);case pt.UPPERCASE:return n.toUpperCase();default:return n}},dy=/(^|\s|:|-|\(|\))([a-z])/g,gy=function(n,t,i){return n.length>0?t+i.toUpperCase():n},ls=function(n){function t(t){var i=n.call(this,t)||this;return i.src=t.currentSrc||t.src,i.intrinsicWidth=t.naturalWidth,i.intrinsicHeight=t.naturalHeight,vt.getInstance().addImage(i.src),i}return ct(t,n),t}(ht),as=function(n){function t(t){var i=n.call(this,t)||this;return i.canvas=t,i.intrinsicWidth=t.width,i.intrinsicHeight=t.height,i}return ct(t,n),t}(ht),vs=function(n){function t(t){var i=n.call(this,t)||this,r=new XMLSerializer;return i.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(t)),i.intrinsicWidth=t.width.baseVal.value,i.intrinsicHeight=t.height.baseVal.value,vt.getInstance().addImage(i.svg),i}return ct(t,n),t}(ht),ys=function(n){function t(t){var i=n.call(this,t)||this;return i.value=t.value,i}return ct(t,n),t}(ht),ee=function(n){function t(t){var i=n.call(this,t)||this;return i.start=t.start,i.reversed="boolean"==typeof t.reversed&&!0===t.reversed,i}return ct(t,n),t}(ht),np=[{type:n.DIMENSION_TOKEN,flags:0,unit:"px",number:3}],tp=[{type:n.PERCENTAGE_TOKEN,flags:0,number:50}],ip="password",oe=function(n){function t(t){var u,f,r,i=n.call(this,t)||this;switch(i.type=t.type.toLowerCase(),i.checked=t.checked,i.value=0===(f=(u=t).type===ip?new Array(u.value.length+1).join("•"):u.value).length?u.placeholder||"":f,"checkbox"!==i.type&&"radio"!==i.type||(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=pi.SOLID,i.styles.backgroundClip=[ut.BORDER_BOX],i.styles.backgroundOrigin=[0],i.bounds=(r=i.bounds).width>r.height?new bt(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new bt(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r),i.type){case"checkbox":i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=np;break;case"radio":i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=tp}return i}return ct(t,n),t}(ht),ps=function(n){function t(t){var i=n.call(this,t)||this,r=t.options[t.selectedIndex||0];return i.value=r&&r.text||"",i}return ct(t,n),t}(ht),ws=function(n){function t(t){var i=n.call(this,t)||this;return i.value=t.value,i}return ct(t,n),t}(ht),bs=function(n){return lt(kf.create(n).parseComponentValue())},ks=function(n){function t(t){var i=n.call(this,t)||this,r,u;i.src=t.src;i.width=parseInt(t.width,10)||0;i.height=parseInt(t.height,10)||0;i.backgroundColor=i.styles.backgroundColor;try{t.contentWindow&&t.contentWindow.document&&t.contentWindow.document.documentElement&&(i.tree=nh(t.contentWindow.document.documentElement),r=t.contentWindow.document.documentElement?bs(getComputedStyle(t.contentWindow.document.documentElement).backgroundColor):at.TRANSPARENT,u=t.contentWindow.document.body?bs(getComputedStyle(t.contentWindow.document.body).backgroundColor):at.TRANSPARENT,i.backgroundColor=ti(r)?ti(u)?i.styles.backgroundColor:u:r)}catch(n){}return i}return ct(t,n),t}(ht),rp=["OL","UL","MENU"],ds=function(n,t,i){for(var u,r=n.firstChild,f=void 0;r;r=f)(f=r.nextSibling,th(r)&&r.data.trim().length>0)?t.textNodes.push(new by(r,t.styles)):se(r)&&(u=gs(r),u.styles.isVisible()&&(up(r,u,i)?u.flags|=4:fp(u.styles)&&(u.flags|=2),-1!==rp.indexOf(r.tagName)&&(u.flags|=8),t.elements.push(u),bu(r)||rh(r)||ku(r)||ds(r,u,i)))},gs=function(n){return hp(n)?new ls(n):uh(n)?new as(n):rh(n)?new vs(n):ep(n)?new ys(n):op(n)?new ee(n):sp(n)?new oe(n):ku(n)?new ps(n):bu(n)?new ws(n):fh(n)?new ks(n):new ht(n)},nh=function(n){var t=gs(n);return t.flags|=4,ds(n,t,t),t},up=function(n,t,i){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||he(n)&&i.styles.isTransparent()},fp=function(n){return n.isPositioned()||n.isFloating()},th=function(n){return n.nodeType===Node.TEXT_NODE},se=function(n){return n.nodeType===Node.ELEMENT_NODE},ih=function(n){return void 0!==n.style},ep=function(n){return"LI"===n.tagName},op=function(n){return"OL"===n.tagName},sp=function(n){return"INPUT"===n.tagName},rh=function(n){return"svg"===n.tagName},he=function(n){return"BODY"===n.tagName},uh=function(n){return"CANVAS"===n.tagName},hp=function(n){return"IMG"===n.tagName},fh=function(n){return"IFRAME"===n.tagName},eh=function(n){return"STYLE"===n.tagName},cp=function(n){return"SCRIPT"===n.tagName},bu=function(n){return"TEXTAREA"===n.tagName},ku=function(n){return"SELECT"===n.tagName},lp=function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(n){var t=this.counters[n];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(n){var t=this.counters[n];return t||[]},n.prototype.pop=function(n){var t=this;n.forEach(function(n){return t.counters[n].pop()})},n.prototype.parse=function(n){var t=this,r=n.counterIncrement,f=n.counterReset,u=!0,i;return null!==r&&r.forEach(function(n){var i=t.counters[n.counter];i&&0!==n.increment&&(u=!1,i[Math.max(0,i.length-1)]+=n.increment)}),i=[],u&&f.forEach(function(n){var r=t.counters[n.counter];i.push(n.counter);r||(r=t.counters[n.counter]=[]);r.push(n.reset)}),i},n}(),oh={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},sh={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},ap={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},vp={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},bi=function(n,t,i,r,u,f){return n<t||n>i?yr(n,u,f.length>0):r.integers.reduce(function(t,i,u){for(;n>=i;)n-=i,t+=r.values[u];return t},"")+f},hh=function(n,t,i,r){var u="";do i||n--,u=r(n)+u,n/=t;while(n*t>=t);return u},o=function(n,t,i,r,u){var f=i-t+1;return(n<0?"-":"")+(hh(Math.abs(n),f,r,function(n){return s(Math.floor(n%f)+t)})+u)},oi=function(n,t,i){void 0===i&&(i=". ");var r=t.length;return hh(Math.abs(n),r,!1,function(n){return t[Math.floor(n%r)]})+i},wt=function(n,i,r,u,f,e){var c,s,o,h;if(n<-9999||n>9999)return yr(n,t.CJK_DECIMAL,f.length>0);if(c=Math.abs(n),s=f,0===c)return i[0]+s;for(o=0;c>0&&o<=4;o++)h=c%10,0===h&&p(e,1)&&""!==s?s=i[h]+s:h>1||1===h&&0===o||1===h&&1===o&&p(e,2)||1===h&&1===o&&p(e,4)&&n>100||1===h&&o>1&&p(e,8)?s=i[h]+(o>0?r[o-1]:"")+s:1===h&&o>0&&(s=r[o-1]+s),c=Math.floor(c/10);return(n<0?u:"")+s},yr=function(n,i,r){var u=r?". ":"",f=r?"、":"",s=r?", ":"",h=r?" ":"",e;switch(i){case t.DISC:return"•"+h;case t.CIRCLE:return"◦"+h;case t.SQUARE:return"◾"+h;case t.DECIMAL_LEADING_ZERO:return e=o(n,48,57,!0,u),e.length<4?"0"+e:e;case t.CJK_DECIMAL:return oi(n,"〇一二三四五六七八九",f);case t.LOWER_ROMAN:return bi(n,1,3999,oh,t.DECIMAL,u).toLowerCase();case t.UPPER_ROMAN:return bi(n,1,3999,oh,t.DECIMAL,u);case t.LOWER_GREEK:return o(n,945,969,!1,u);case t.LOWER_ALPHA:return o(n,97,122,!1,u);case t.UPPER_ALPHA:return o(n,65,90,!1,u);case t.ARABIC_INDIC:return o(n,1632,1641,!0,u);case t.ARMENIAN:case t.UPPER_ARMENIAN:return bi(n,1,9999,sh,t.DECIMAL,u);case t.LOWER_ARMENIAN:return bi(n,1,9999,sh,t.DECIMAL,u).toLowerCase();case t.BENGALI:return o(n,2534,2543,!0,u);case t.CAMBODIAN:case t.KHMER:return o(n,6112,6121,!0,u);case t.CJK_EARTHLY_BRANCH:return oi(n,"子丑寅卯辰巳午未申酉戌亥",f);case t.CJK_HEAVENLY_STEM:return oi(n,"甲乙丙丁戊己庚辛壬癸",f);case t.CJK_IDEOGRAPHIC:case t.TRAD_CHINESE_INFORMAL:return wt(n,"零一二三四五六七八九","十百千萬","負",f,14);case t.TRAD_CHINESE_FORMAL:return wt(n,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",f,15);case t.SIMP_CHINESE_INFORMAL:return wt(n,"零一二三四五六七八九","十百千萬","负",f,14);case t.SIMP_CHINESE_FORMAL:return wt(n,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",f,15);case t.JAPANESE_INFORMAL:return wt(n,"〇一二三四五六七八九","十百千万","マイナス",f,0);case t.JAPANESE_FORMAL:return wt(n,"零壱弐参四伍六七八九","拾百千万","マイナス",f,7);case t.KOREAN_HANGUL_FORMAL:return wt(n,"영일이삼사오육칠팔구","십백천만","마이너스",s,7);case t.KOREAN_HANJA_INFORMAL:return wt(n,"零一二三四五六七八九","十百千萬","마이너스",s,0);case t.KOREAN_HANJA_FORMAL:return wt(n,"零壹貳參四五六七八九","拾百千","마이너스",s,7);case t.DEVANAGARI:return o(n,2406,2415,!0,u);case t.GEORGIAN:return bi(n,1,19999,vp,t.DECIMAL,u);case t.GUJARATI:return o(n,2790,2799,!0,u);case t.GURMUKHI:return o(n,2662,2671,!0,u);case t.HEBREW:return bi(n,1,10999,ap,t.DECIMAL,u);case t.HIRAGANA:return oi(n,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case t.HIRAGANA_IROHA:return oi(n,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case t.KANNADA:return o(n,3302,3311,!0,u);case t.KATAKANA:return oi(n,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",f);case t.KATAKANA_IROHA:return oi(n,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",f);case t.LAO:return o(n,3792,3801,!0,u);case t.MONGOLIAN:return o(n,6160,6169,!0,u);case t.MYANMAR:return o(n,4160,4169,!0,u);case t.ORIYA:return o(n,2918,2927,!0,u);case t.PERSIAN:return o(n,1776,1785,!0,u);case t.TAMIL:return o(n,3046,3055,!0,u);case t.TELUGU:return o(n,3174,3183,!0,u);case t.THAI:return o(n,3664,3673,!0,u);case t.TIBETAN:return o(n,3872,3881,!0,u);case t.DECIMAL:default:return o(n,48,57,!0,u)}},ch=function(){function i(n,t){if(this.options=t,this.scrolledElements=[],this.referenceElement=n,this.counters=new lp,this.quoteDepth=0,!n.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(n.ownerDocument.documentElement)}return i.prototype.toIFrame=function(n,t){var f=this,r=yp(n,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var e=n.defaultView.pageXOffset,o=n.defaultView.pageYOffset,u=r.contentWindow,i=u.document,s=pp(r).then(function(){return nt(f,void 0,void 0,function(){var n;return d(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(kp),u&&(u.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||u.scrollY===t.top&&u.scrollX===t.left||(i.documentElement.style.top=-t.top+"px",i.documentElement.style.left=-t.left+"px",i.documentElement.style.position="absolute")),n=this.options.onclone,void 0===this.clonedReferenceElement?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:i.fonts&&i.fonts.ready?[4,i.fonts.ready]:[3,2];case 1:f.sent();f.label=2;case 2:return"function"==typeof n?[2,Promise.resolve().then(function(){return n(i)}).then(function(){return r})]:[2,r]}})})});return i.open(),i.write(wp(document.doctype)+"<html><\/html>"),bp(this.referenceElement.ownerDocument,e,o),i.replaceChild(i.adoptNode(this.documentElement),i.documentElement),i.close(),s},i.prototype.createElementClone=function(n){return uh(n)?this.createCanvasClone(n):eh(n)?this.createStyleClone(n):n.cloneNode(!1)},i.prototype.createStyleClone=function(n){var t,r,i;try{if(t=n.sheet,t&&t.cssRules)return r=[].slice.call(t.cssRules,0).reduce(function(n,t){return t&&"string"==typeof t.cssText?n+t.cssText:n},""),i=n.cloneNode(!1),i.textContent=r,i}catch(n){if(c.getInstance(this.options.id).error("Unable to access cssRules property",n),"SecurityError"!==n.name)throw n;}return n.cloneNode(!1)},i.prototype.createCanvasClone=function(n){var r,t,u,i;if(this.options.inlineImages&&n.ownerDocument){r=n.ownerDocument.createElement("img");try{return r.src=n.toDataURL(),r}catch(n){c.getInstance(this.options.id).info("Unable to clone canvas contents, canvas is tainted")}}t=n.cloneNode(!1);try{return t.width=n.width,t.height=n.height,u=n.getContext("2d"),i=t.getContext("2d"),i&&(u?i.putImageData(u.getImageData(0,0,n.width,n.height),0,0):i.drawImage(n,0,0)),t}catch(n){}return t},i.prototype.cloneNode=function(n){var r,f;if(th(n))return document.createTextNode(n.data);if(!n.ownerDocument)return n.cloneNode(!1);if(r=n.ownerDocument.defaultView,ih(n)&&r){var t=this.createElementClone(n),u=r.getComputedStyle(n),o=r.getComputedStyle(n,":before"),s=r.getComputedStyle(n,":after");this.referenceElement===n&&(this.clonedReferenceElement=t);he(t)&&dp(t);for(var h=this.counters.parse(new cs(u)),e=this.resolvePseudoContent(n,t,o,vr.BEFORE),i=n.firstChild;i;i=i.nextSibling)se(i)&&(cp(i)||i.hasAttribute("data-html2canvas-ignore")||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(i))||this.options.copyStyles&&se(i)&&eh(i)||t.appendChild(this.cloneNode(i));return e&&t.insertBefore(e,t.firstChild),f=this.resolvePseudoContent(n,t,s,vr.AFTER),f&&t.appendChild(f),this.counters.pop(h),u&&this.options.copyStyles&&!fh(n)&&lh(u,t),0===n.scrollTop&&0===n.scrollLeft||this.scrolledElements.push([t,n.scrollLeft,n.scrollTop]),(bu(n)||ku(n))&&(bu(t)||ku(t))&&(t.value=n.value),t}return n.cloneNode(!1)},i.prototype.resolvePseudoContent=function(i,r,u,e){var h=this,c,s,l,o;if(u&&(c=u.content,s=r.ownerDocument,s&&c&&"none"!==c&&"-moz-alt-content"!==c&&"none"!==u.display))return this.counters.parse(new cs(u)),l=new ay(u),o=s.createElement("html2canvaspseudoelement"),lh(u,o),l.content.forEach(function(r){var c,y,w,b,a,v;if(r.type===n.STRING_TOKEN)o.appendChild(s.createTextNode(r.value));else if(r.type===n.URL_TOKEN)c=s.createElement("img"),c.src=r.value,c.style.opacity="1",o.appendChild(c);else if(r.type===n.FUNCTION){if("attr"===r.name)y=r.values.filter(f),y.length&&o.appendChild(s.createTextNode(i.getAttribute(y[0].value)||""));else if("counter"===r.name){var p=r.values.filter(vi),u=p[0],e=p[1];u&&f(u)&&(w=h.counters.getCounterValue(u.value),b=e&&f(e)?fe.parse(e.value):t.DECIMAL,o.appendChild(s.createTextNode(yr(w,b,!1))))}else if("counters"===r.name&&(a=r.values.filter(vi),v=(u=a[0],a[1]),e=a[2],u&&f(u))){var k=h.counters.getCounterValues(u.value),d=e&&f(e)?fe.parse(e.value):t.DECIMAL,g=v&&v.type===n.STRING_TOKEN?v.value:"",nt=k.map(function(n){return yr(n,d,!1)}).join(g);o.appendChild(s.createTextNode(nt))}}else if(r.type===n.IDENT_TOKEN)switch(r.value){case"open-quote":o.appendChild(s.createTextNode(hs(l.quotes,h.quoteDepth++,!0)));break;case"close-quote":o.appendChild(s.createTextNode(hs(l.quotes,--h.quoteDepth,!1)));break;default:o.appendChild(s.createTextNode(r.value))}}),o.className=ce+" "+le,r.className+=e===vr.BEFORE?" "+ce:" "+le,o},i.destroy=function(n){return!!n.parentNode&&(n.parentNode.removeChild(n),!0)},i}();!function(n){n[n.BEFORE=0]="BEFORE";n[n.AFTER=1]="AFTER"}(vr||(vr={}));var pr,yp=function(n,t){var i=n.createElement("iframe");return i.className="html2canvas-container",i.style.visibility="hidden",i.style.position="fixed",i.style.left="-10000px",i.style.top="0px",i.style.border="0",i.width=t.width.toString(),i.height=t.height.toString(),i.scrolling="no",i.setAttribute("data-html2canvas-ignore","true"),n.body.appendChild(i),i},pp=function(n){return new Promise(function(t,i){var u=n.contentWindow,r;if(!u)return i("No window assigned for iframe");r=u.document;u.onload=n.onload=r.onreadystatechange=function(){u.onload=n.onload=r.onreadystatechange=null;var i=setInterval(function(){r.body.childNodes.length>0&&"complete"===r.readyState&&(clearInterval(i),t(n))},50)}})},lh=function(n,t){for(var r,i=n.length-1;i>=0;i--)r=n.item(i),"content"!==r&&t.style.setProperty(r,n.getPropertyValue(r));return t},wp=function(n){var t="";return n&&(t+="<!DOCTYPE ",n.name&&(t+=n.name),n.internalSubset&&(t+=n.internalSubset),n.publicId&&(t+='"'+n.publicId+'"'),n.systemId&&(t+='"'+n.systemId+'"'),t+=">"),t},bp=function(n,t,i){n&&n.defaultView&&(t!==n.defaultView.pageXOffset||i!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(t,i)},kp=function(n){var t=n[0],i=n[1],r=n[2];t.scrollLeft=i;t.scrollTop=r},ce="___html2canvas___pseudoelement_before",le="___html2canvas___pseudoelement_after",dp=function(n){gp(n,"."+ce+':before{\n    content: "" !important;\n    display: none !important;\n}\n         .'+le+':after{\n    content: "" !important;\n    display: none !important;\n}')},gp=function(n,t){var r=n.ownerDocument,i;r&&(i=r.createElement("style"),i.textContent=t,n.appendChild(i))};!function(n){n[n.VECTOR=0]="VECTOR";n[n.BEZIER_CURVE=1]="BEZIER_CURVE"}(pr||(pr={}));var l,ah=function(n,t){return n.length===t.length&&n.some(function(n,i){return n===t[i]})},r=function(){function n(n,t){this.type=pr.VECTOR;this.x=n;this.y=t}return n.prototype.add=function(t,i){return new n(this.x+t,this.y+i)},n}(),ki=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i)},du=function(){function n(n,t,i,r){this.type=pr.BEZIER_CURVE;this.start=n;this.startControl=t;this.endControl=i;this.end=r}return n.prototype.subdivide=function(t,i){var r=ki(this.start,this.startControl,t),u=ki(this.startControl,this.endControl,t),f=ki(this.endControl,this.end,t),e=ki(r,u,t),o=ki(u,f,t),s=ki(e,o,t);return i?new n(this.start,r,e,s):new n(s,o,f,this.end)},n.prototype.add=function(t,i){return new n(this.start.add(t,i),this.startControl.add(t,i),this.endControl.add(t,i),this.end.add(t,i))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n}(),di=function(n){return n.type===pr.BEZIER_CURVE},nw=function(n){var f=n.styles,t=n.bounds,st=hr(f.borderTopLeftRadius,t.width,t.height),y=st[0],p=st[1],ht=hr(f.borderTopRightRadius,t.width,t.height),h=ht[0],w=ht[1],ct=hr(f.borderBottomRightRadius,t.width,t.height),c=ct[0],a=ct[1],lt=hr(f.borderBottomLeftRadius,t.width,t.height),b=lt[0],v=lt[1],nt=[],o;nt.push((y+h)/t.width);nt.push((b+c)/t.width);nt.push((p+v)/t.height);nt.push((w+a)/t.height);o=Math.max.apply(Math,nt);o>1&&(y/=o,p/=o,h/=o,w/=o,c/=o,a/=o,b/=o,v/=o);var tt=t.width-h,ut=t.height-a,ft=t.width-c,et=t.height-v,u=f.borderTopWidth,g=f.borderRightWidth,k=f.borderBottomWidth,i=f.borderLeftWidth,d=e(f.paddingTop,n.bounds.width),ot=e(f.paddingRight,n.bounds.width),it=e(f.paddingBottom,n.bounds.width),s=e(f.paddingLeft,n.bounds.width);this.topLeftBorderBox=y>0||p>0?rt(t.left,t.top,y,p,l.TOP_LEFT):new r(t.left,t.top);this.topRightBorderBox=h>0||w>0?rt(t.left+tt,t.top,h,w,l.TOP_RIGHT):new r(t.left+t.width,t.top);this.bottomRightBorderBox=c>0||a>0?rt(t.left+ft,t.top+ut,c,a,l.BOTTOM_RIGHT):new r(t.left+t.width,t.top+t.height);this.bottomLeftBorderBox=b>0||v>0?rt(t.left,t.top+et,b,v,l.BOTTOM_LEFT):new r(t.left,t.top+t.height);this.topLeftPaddingBox=y>0||p>0?rt(t.left+i,t.top+u,Math.max(0,y-i),Math.max(0,p-u),l.TOP_LEFT):new r(t.left+i,t.top+u);this.topRightPaddingBox=h>0||w>0?rt(t.left+Math.min(tt,t.width+i),t.top+u,tt>t.width+i?0:h-i,w-u,l.TOP_RIGHT):new r(t.left+t.width-g,t.top+u);this.bottomRightPaddingBox=c>0||a>0?rt(t.left+Math.min(ft,t.width-i),t.top+Math.min(ut,t.height+u),Math.max(0,c-g),a-k,l.BOTTOM_RIGHT):new r(t.left+t.width-g,t.top+t.height-k);this.bottomLeftPaddingBox=b>0||v>0?rt(t.left+i,t.top+et,Math.max(0,b-i),v-k,l.BOTTOM_LEFT):new r(t.left+i,t.top+t.height-k);this.topLeftContentBox=y>0||p>0?rt(t.left+i+s,t.top+u+d,Math.max(0,y-(i+s)),Math.max(0,p-(u+d)),l.TOP_LEFT):new r(t.left+i+s,t.top+u+d);this.topRightContentBox=h>0||w>0?rt(t.left+Math.min(tt,t.width+i+s),t.top+u+d,tt>t.width+i+s?0:h-i+s,w-(u+d),l.TOP_RIGHT):new r(t.left+t.width-(g+ot),t.top+u+d);this.bottomRightContentBox=c>0||a>0?rt(t.left+Math.min(ft,t.width-(i+s)),t.top+Math.min(ut,t.height+u+d),Math.max(0,c-(g+ot)),a-(k+it),l.BOTTOM_RIGHT):new r(t.left+t.width-(g+ot),t.top+t.height-(k+it));this.bottomLeftContentBox=b>0||v>0?rt(t.left+i+s,t.top+et,Math.max(0,b-(i+s)),v-(k+it),l.BOTTOM_LEFT):new r(t.left+i+s,t.top+t.height-(k+it))};!function(n){n[n.TOP_LEFT=0]="TOP_LEFT";n[n.TOP_RIGHT=1]="TOP_RIGHT";n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT";n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(l||(l={}));var rt=function(n,t,i,u,f){var c=(Math.sqrt(2)-1)/3*4,s=i*c,h=u*c,e=n+i,o=t+u;switch(f){case l.TOP_LEFT:return new du(new r(n,o),new r(n,o-h),new r(e-s,t),new r(e,t));case l.TOP_RIGHT:return new du(new r(n,t),new r(n+s,t),new r(e,o-h),new r(e,o));case l.BOTTOM_RIGHT:return new du(new r(e,t),new r(e,t+h),new r(n+s,o),new r(n,o));case l.BOTTOM_LEFT:default:return new du(new r(e,o),new r(e-s,o),new r(n,t+h),new r(n,t))}},gu=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},nf=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},tw=function(n,t,i){this.type=0;this.offsetX=n;this.offsetY=t;this.matrix=i;this.target=6},tf=function(n,t){this.type=1;this.target=t;this.path=n},vh=function(n){this.element=n;this.inlineLevel=[];this.nonInlineLevel=[];this.negativeZIndex=[];this.zeroOrAutoZIndexOrTransformedOrOpacity=[];this.positiveZIndex=[];this.nonPositionedFloats=[];this.nonPositionedInlineLevel=[]},yh=function(){function n(n,t){var i,r;if(this.container=n,this.effects=t.slice(0),this.curves=new nw(n),null!==n.styles.transform){var u=n.bounds.left+n.styles.transformOrigin[0].number,f=n.bounds.top+n.styles.transformOrigin[1].number,e=n.styles.transform;this.effects.push(new tw(u,f,e))}n.styles.overflowX!==ui.VISIBLE&&(i=gu(this.curves),r=nf(this.curves),ah(i,r)?this.effects.push(new tf(i,6)):(this.effects.push(new tf(i,2)),this.effects.push(new tf(r,4))))}return n.prototype.getParentEffects=function(){var t=this.effects.slice(0),i,n;return this.container.styles.overflowX!==ui.VISIBLE&&(i=gu(this.curves),n=nf(this.curves),ah(i,n)||t.push(new tf(n,6))),t},n}(),ae=function(n,t,i,r){n.container.elements.forEach(function(u){var a=p(u.flags,4),v=p(u.flags,2),o=new yh(u,n.getParentEffects()),h,f,e,s,c,l;p(u.styles.display,2048)&&r.push(o);h=p(u.flags,8)?[]:r;a||v?(f=a||u.styles.isPositioned()?i:t,e=new vh(o),u.styles.isPositioned()||u.styles.opacity<1||u.styles.isTransformed()?(s=u.styles.zIndex.order,s<0?(c=0,f.negativeZIndex.some(function(n,t){return s>n.element.container.styles.zIndex.order?(c=t,!1):c>0}),f.negativeZIndex.splice(c,0,e)):s>0?(l=0,f.positiveZIndex.some(function(n,t){return s>n.element.container.styles.zIndex.order?(l=t+1,!1):l>0}),f.positiveZIndex.splice(l,0,e)):f.zeroOrAutoZIndexOrTransformedOrOpacity.push(e)):u.styles.isFloating()?f.nonPositionedFloats.push(e):f.nonPositionedInlineLevel.push(e),ae(o,e,a?e:i,h)):(u.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),ae(o,t,i,h));p(u.flags,8)&&ph(u,h)})},ph=function(n,t){for(var i,r=n instanceof ee?n.start:1,f=n instanceof ee&&n.reversed,u=0;u<t.length;u++)i=t[u],i.container instanceof ys&&"number"==typeof i.container.value&&0!==i.container.value&&(r=i.container.value),i.listValue=yr(r,i.container.styles.listStyleType,!0),r+=f?-1:1},rf=function(n,t,i,r){var u=[];return di(n)?u.push(n.subdivide(.5,!1)):u.push(n),di(i)?u.push(i.subdivide(.5,!0)):u.push(i),di(r)?u.push(r.subdivide(.5,!0).reverse()):u.push(r),di(t)?u.push(t.subdivide(.5,!1).reverse()):u.push(t),u},wh=function(n){var i=n.bounds,t=n.styles;return i.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},uf=function(n){var t=n.styles,i=n.bounds,r=e(t.paddingLeft,i.width),f=e(t.paddingRight,i.width),u=e(t.paddingTop,i.width),o=e(t.paddingBottom,i.width);return i.add(r+t.borderLeftWidth,u+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+r+f),-(t.borderTopWidth+t.borderBottomWidth+u+o))},ve=function(n,t,i){var r=function(n,t){return 0===n?t.bounds:2===n?uf(t):wh(t)}(nr(n.styles.backgroundOrigin,t),n),s=function(n,t){return n===ut.BORDER_BOX?t.bounds:n===ut.CONTENT_BOX?uf(t):wh(t)}(nr(n.styles.backgroundClip,t),n),u=iw(nr(n.styles.backgroundSize,t),i,r),e=u[0],o=u[1],f=hr(nr(n.styles.backgroundPosition,t),r.width-e,r.height-o);return[rw(nr(n.styles.backgroundRepeat,t),f,u,r,s),Math.round(r.left+f[0]),Math.round(r.top+f[1]),e,o]},gi=function(n){return f(n)&&n.value===yi.AUTO},ff=function(n){return"number"==typeof n},iw=function(n,t,i){var s=t[0],c=t[1],o=t[2],u=n[0],r=n[1],b,p,w,l,a;if(h(u)&&r&&h(r))return[e(u,i.width),e(r,i.height)];if(b=ff(o),f(u)&&(u.value===yi.CONTAIN||u.value===yi.COVER))return ff(o)?i.width/i.height<o!=(u.value===yi.COVER)?[i.width,i.width/o]:[i.height*o,i.height]:[i.width,i.height];var v=ff(s),y=ff(c),k=v||y;if(gi(u)&&(!r||gi(r)))return v&&y?[s,c]:b||k?k&&b?[v?s:c*o,y?c:s/o]:[v?s:i.width,y?c:i.height]:[i.width,i.height];if(b)return p=0,w=0,h(u)?p=e(u,i.width):h(r)&&(w=e(r,i.height)),gi(u)?p=w*o:r&&!gi(r)||(w=p/o),[p,w];if(l=null,a=null,h(u)?l=e(u,i.width):r&&h(r)&&(a=e(r,i.height)),null===l||r&&!gi(r)||(a=v&&y?l/s*c:i.height),null!==a&&gi(u)&&(l=v&&y?a/c*s:i.width),null!==l&&null!==a)return[l,a];throw new Error("Unable to calculate background-size for element");},nr=function(n,t){var i=n[t];return void 0===i?n[0]:i},rw=function(n,t,i,u,f){var e=t[0],o=t[1],s=i[0],h=i[1];switch(n){case yt.REPEAT_X:return[new r(Math.round(u.left),Math.round(u.top+o)),new r(Math.round(u.left+u.width),Math.round(u.top+o)),new r(Math.round(u.left+u.width),Math.round(h+u.top+o)),new r(Math.round(u.left),Math.round(h+u.top+o))];case yt.REPEAT_Y:return[new r(Math.round(u.left+e),Math.round(u.top)),new r(Math.round(u.left+e+s),Math.round(u.top)),new r(Math.round(u.left+e+s),Math.round(u.height+u.top)),new r(Math.round(u.left+e),Math.round(u.height+u.top))];case yt.NO_REPEAT:return[new r(Math.round(u.left+e),Math.round(u.top+o)),new r(Math.round(u.left+e+s),Math.round(u.top+o)),new r(Math.round(u.left+e+s),Math.round(u.top+o+h)),new r(Math.round(u.left+e),Math.round(u.top+o+h))];default:return[new r(Math.round(f.left),Math.round(f.top)),new r(Math.round(f.left+f.width),Math.round(f.top)),new r(Math.round(f.left+f.width),Math.round(f.height+f.top)),new r(Math.round(f.left),Math.round(f.height+f.top))]}},uw=function(){function n(n){this._data={};this._document=n}return n.prototype.parseMetrics=function(n,t){var i=this._document.createElement("div"),r=this._document.createElement("img"),u=this._document.createElement("span"),f=this._document.body,e,o;return i.style.visibility="hidden",i.style.fontFamily=n,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",f.appendChild(i),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",u.style.fontFamily=n,u.style.fontSize=t,u.style.margin="0",u.style.padding="0",u.appendChild(this._document.createTextNode("Hidden Text")),i.appendChild(u),i.appendChild(r),e=r.offsetTop-u.offsetTop+2,i.removeChild(u),i.appendChild(this._document.createTextNode("Hidden Text")),i.style.lineHeight="normal",r.style.verticalAlign="super",o=r.offsetTop-i.offsetTop+2,f.removeChild(i),{baseline:e,middle:o}},n.prototype.getMetrics=function(n,t){var i=n+" "+t;return void 0===this._data[i]&&(this._data[i]=this.parseMetrics(n,t)),this._data[i]},n}(),fw=function(){function i(n){this._activeEffects=[];this.canvas=n.canvas?n.canvas:document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.options=n;n.canvas||(this.canvas.width=Math.floor(n.width*n.scale),this.canvas.height=Math.floor(n.height*n.scale),this.canvas.style.width=n.width+"px",this.canvas.style.height=n.height+"px");this.fontMetrics=new uw(document);this.ctx.scale(this.options.scale,this.options.scale);this.ctx.translate(-n.x+n.scrollX,-n.y+n.scrollY);this.ctx.textBaseline="bottom";this._activeEffects=[];c.getInstance(n.id).debug("Canvas renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale)}return i.prototype.applyEffects=function(n,t){for(var i=this;this._activeEffects.length;)this.popEffect();n.filter(function(n){return p(n.target,t)}).forEach(function(n){return i.applyEffect(n)})},i.prototype.applyEffect=function(n){this.ctx.save(),function(n){return 0===n.type}(n)&&(this.ctx.translate(n.offsetX,n.offsetY),this.ctx.transform(n.matrix[0],n.matrix[1],n.matrix[2],n.matrix[3],n.matrix[4],n.matrix[5]),this.ctx.translate(-n.offsetX,-n.offsetY)),function(n){return 1===n.type}(n)&&(this.path(n.path),this.ctx.clip());this._activeEffects.push(n)},i.prototype.popEffect=function(){this._activeEffects.pop();this.ctx.restore()},i.prototype.renderStack=function(n){return nt(this,void 0,void 0,function(){var t;return d(this,function(i){switch(i.label){case 0:return(t=n.element.container.styles).isVisible()?(this.ctx.globalAlpha=t.opacity,[4,this.renderStackContent(n)]):[3,2];case 1:i.sent();i.label=2;case 2:return[2]}})})},i.prototype.renderNode=function(n){return nt(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return n.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(n)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(n)];case 2:t.sent();t.label=3;case 3:return[2]}})})},i.prototype.renderTextWithLetterSpacing=function(n,t){var i=this;0===t?this.ctx.fillText(n.text,n.bounds.left,n.bounds.top+n.bounds.height):wr(n.text).map(function(n){return s(n)}).reduce(function(t,r){return i.ctx.fillText(r,t,n.bounds.top+n.bounds.height),t+i.ctx.measureText(r).width},n.bounds.left)},i.prototype.createFontStyle=function(n){var r=n.fontVariant.filter(function(n){return"normal"===n||"small-caps"===n}).join(""),t=n.fontFamily.join(", "),i=df(n.fontSize)?""+n.fontSize.number+n.fontSize.unit:n.fontSize.number+"px";return[[n.fontStyle,r,n.fontWeight,i,t].join(" "),t,i]},i.prototype.renderTextNode=function(n,t){return nt(this,void 0,void 0,function(){var r,e,u,f,i=this;return d(this,function(){return r=this.createFontStyle(t),e=r[0],u=r[1],f=r[2],this.ctx.font=e,n.textBounds.forEach(function(n){i.ctx.fillStyle=b(t.color);i.renderTextWithLetterSpacing(n,t.letterSpacing);var r=t.textShadow;r.length&&n.text.trim().length&&(r.slice(0).reverse().forEach(function(t){i.ctx.shadowColor=b(t.color);i.ctx.shadowOffsetX=t.offsetX.number*i.options.scale;i.ctx.shadowOffsetY=t.offsetY.number*i.options.scale;i.ctx.shadowBlur=t.blur.number;i.ctx.fillText(n.text,n.bounds.left,n.bounds.top+n.bounds.height)}),i.ctx.shadowColor="",i.ctx.shadowOffsetX=0,i.ctx.shadowOffsetY=0,i.ctx.shadowBlur=0);t.textDecorationLine.length&&(i.ctx.fillStyle=b(t.textDecorationColor||t.color),t.textDecorationLine.forEach(function(t){var r,e;switch(t){case 1:r=i.fontMetrics.getMetrics(u,f).baseline;i.ctx.fillRect(n.bounds.left,Math.round(n.bounds.top+r),n.bounds.width,1);break;case 2:i.ctx.fillRect(n.bounds.left,Math.round(n.bounds.top),n.bounds.width,1);break;case 3:e=i.fontMetrics.getMetrics(u,f).middle;i.ctx.fillRect(n.bounds.left,Math.ceil(n.bounds.top+e),n.bounds.width,1)}}))}),[2]})})},i.prototype.renderReplacedElement=function(n,t,i){if(i&&n.intrinsicWidth>0&&n.intrinsicHeight>0){var r=uf(n),u=nf(t);this.path(u);this.ctx.save();this.ctx.clip();this.ctx.drawImage(i,0,0,n.intrinsicWidth,n.intrinsicHeight,r.left,r.top,r.width,r.height);this.ctx.restore()}},i.prototype.renderNodeContent=function(u){return nt(this,void 0,void 0,function(){var o,y,a,w,nt,it,rt,l,g,ut,ft,v,tt,s;return d(this,function(d){switch(d.label){case 0:this.applyEffects(u.effects,4);o=u.container;y=u.curves;a=o.styles;w=0;nt=o.textNodes;d.label=1;case 1:return w<nt.length?(it=nt[w],[4,this.renderTextNode(it,a)]):[3,4];case 2:d.sent();d.label=3;case 3:return w++,[3,1];case 4:if(!(o instanceof ls))return[3,8];d.label=5;case 5:return d.trys.push([5,7,,8]),[4,this.options.cache.match(o.src)];case 6:return v=d.sent(),this.renderReplacedElement(o,y,v),[3,8];case 7:return d.sent(),c.getInstance(this.options.id).error("Error loading image "+o.src),[3,8];case 8:if(o instanceof as&&this.renderReplacedElement(o,y,o.canvas),!(o instanceof vs))return[3,12];d.label=9;case 9:return d.trys.push([9,11,,12]),[4,this.options.cache.match(o.svg)];case 10:return v=d.sent(),this.renderReplacedElement(o,y,v),[3,12];case 11:return d.sent(),c.getInstance(this.options.id).error("Error loading svg "+o.svg.substring(0,255)),[3,12];case 12:return o instanceof ks&&o.tree?[4,new i({id:this.options.id,scale:this.options.scale,backgroundColor:o.backgroundColor,x:0,y:0,scrollX:0,scrollY:0,width:o.width,height:o.height,cache:this.options.cache,windowWidth:o.width,windowHeight:o.height}).render(o.tree)]:[3,14];case 13:rt=d.sent();o.width&&o.height&&this.ctx.drawImage(rt,0,0,o.width,o.height,o.bounds.left,o.bounds.top,o.bounds.width,o.bounds.height);d.label=14;case 14:if(o instanceof oe&&(l=Math.min(o.bounds.width,o.bounds.height),"checkbox"===o.type?o.checked&&(this.ctx.save(),this.path([new r(o.bounds.left+.39363*l,o.bounds.top+.79*l),new r(o.bounds.left+.16*l,o.bounds.top+.5549*l),new r(o.bounds.left+.27347*l,o.bounds.top+.44071*l),new r(o.bounds.left+.39694*l,o.bounds.top+.5649*l),new r(o.bounds.left+.72983*l,o.bounds.top+.23*l),new r(o.bounds.left+.84*l,o.bounds.top+.34085*l),new r(o.bounds.left+.39363*l,o.bounds.top+.79*l)]),this.ctx.fillStyle=b(707406591),this.ctx.fill(),this.ctx.restore()):"radio"===o.type&&o.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(o.bounds.left+l/2,o.bounds.top+l/2,l/4,0,2*Math.PI,!0),this.ctx.fillStyle=b(707406591),this.ctx.fill(),this.ctx.restore())),ew(o)&&o.value.length){switch(this.ctx.font=this.createFontStyle(a)[0],this.ctx.fillStyle=b(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign=sw(o.styles.textAlign),s=uf(o),g=0,o.styles.textAlign){case st.CENTER:g+=s.width/2;break;case st.RIGHT:g+=s.width}ut=s.add(g,0,0,-s.height/2+1);this.ctx.save();this.path([new r(s.left,s.top),new r(s.left+s.width,s.top),new r(s.left+s.width,s.top+s.height),new r(s.left,s.top+s.height)]);this.ctx.clip();this.renderTextWithLetterSpacing(new wu(o.value,ut),a.letterSpacing);this.ctx.restore();this.ctx.textBaseline="bottom";this.ctx.textAlign="left"}if(!p(o.styles.display,2048))return[3,20];if(null===o.styles.listStyleImage)return[3,19];if((ft=o.styles.listStyleImage).type!==k.URL)return[3,18];v=void 0;tt=ft.url;d.label=15;case 15:return d.trys.push([15,17,,18]),[4,this.options.cache.match(tt)];case 16:return v=d.sent(),this.ctx.drawImage(v,o.bounds.left-(v.width+10),o.bounds.top),[3,18];case 17:return d.sent(),c.getInstance(this.options.id).error("Error loading list-style-image "+tt),[3,18];case 18:return[3,20];case 19:u.listValue&&o.styles.listStyleType!==t.NONE&&(this.ctx.font=this.createFontStyle(a)[0],this.ctx.fillStyle=b(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",s=new bt(o.bounds.left,o.bounds.top+e(o.styles.paddingTop,o.bounds.width),o.bounds.width,function(t,i){return f(t)&&"normal"===t.value?1.2*i:t.type===n.NUMBER_TOKEN?i*t.number:h(t)?e(t,i):i}(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new wu(u.listValue,s),a.letterSpacing),this.ctx.textBaseline="bottom",this.ctx.textAlign="left");d.label=20;case 20:return[2]}})})},i.prototype.renderStackContent=function(n){return nt(this,void 0,void 0,function(){var i,h,r,c,u,l,f,a,e,v,o,y,s,p,t;return d(this,function(w){switch(w.label){case 0:return[4,this.renderNodeBackgroundAndBorders(n.element)];case 1:w.sent();i=0;h=n.negativeZIndex;w.label=2;case 2:return i<h.length?(t=h[i],[4,this.renderStack(t)]):[3,5];case 3:w.sent();w.label=4;case 4:return i++,[3,2];case 5:return[4,this.renderNodeContent(n.element)];case 6:w.sent();r=0;c=n.nonInlineLevel;w.label=7;case 7:return r<c.length?(t=c[r],[4,this.renderNode(t)]):[3,10];case 8:w.sent();w.label=9;case 9:return r++,[3,7];case 10:u=0;l=n.nonPositionedFloats;w.label=11;case 11:return u<l.length?(t=l[u],[4,this.renderStack(t)]):[3,14];case 12:w.sent();w.label=13;case 13:return u++,[3,11];case 14:f=0;a=n.nonPositionedInlineLevel;w.label=15;case 15:return f<a.length?(t=a[f],[4,this.renderStack(t)]):[3,18];case 16:w.sent();w.label=17;case 17:return f++,[3,15];case 18:e=0;v=n.inlineLevel;w.label=19;case 19:return e<v.length?(t=v[e],[4,this.renderNode(t)]):[3,22];case 20:w.sent();w.label=21;case 21:return e++,[3,19];case 22:o=0;y=n.zeroOrAutoZIndexOrTransformedOrOpacity;w.label=23;case 23:return o<y.length?(t=y[o],[4,this.renderStack(t)]):[3,26];case 24:w.sent();w.label=25;case 25:return o++,[3,23];case 26:s=0;p=n.positiveZIndex;w.label=27;case 27:return s<p.length?(t=p[s],[4,this.renderStack(t)]):[3,30];case 28:w.sent();w.label=29;case 29:return s++,[3,27];case 30:return[2]}})})},i.prototype.mask=function(n){this.ctx.beginPath();this.ctx.moveTo(0,0);this.ctx.lineTo(this.canvas.width,0);this.ctx.lineTo(this.canvas.width,this.canvas.height);this.ctx.lineTo(0,this.canvas.height);this.ctx.lineTo(0,0);this.formatPath(n.slice(0).reverse());this.ctx.closePath()},i.prototype.path=function(n){this.ctx.beginPath();this.formatPath(n);this.ctx.closePath()},i.prototype.formatPath=function(n){var t=this;n.forEach(function(n,i){var r=di(n)?n.start:n;0===i?t.ctx.moveTo(r.x,r.y):t.ctx.lineTo(r.x,r.y);di(n)&&t.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},i.prototype.renderRepeat=function(n,t,i,r){this.path(n);this.ctx.fillStyle=t;this.ctx.translate(i,r);this.ctx.fill();this.ctx.translate(-i,-r)},i.prototype.resizeImage=function(n,t,i){if(n.width===t&&n.height===i)return n;var r=this.canvas.ownerDocument.createElement("canvas");return r.width=t,r.height=i,r.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,t,i),r},i.prototype.renderBackgroundImage=function(n){return nt(this,void 0,void 0,function(){var i,f,t,r,u,o;return d(this,function(s){switch(s.label){case 0:i=n.styles.backgroundImage.length-1;f=function(r){var o,ht,a,p,w,wt,bt,kt,dt,gt,it,rt,ct,ut,g,nt,et,ot,u,f,st,s,h,lt,l,at,vt,yt,tt,ni,pt;return d(this,function(d){switch(d.label){case 0:if(r.type!==k.URL)return[3,5];o=void 0;ht=r.url;d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t.options.cache.match(ht)];case 2:return o=d.sent(),[3,4];case 3:return d.sent(),c.getInstance(t.options.id).error("Error loading background-image "+ht),[3,4];case 4:return o&&(a=ve(n,i,[o.width,o.height,o.width/o.height]),nt=a[0],s=a[1],h=a[2],u=a[3],f=a[4],ut=t.ctx.createPattern(t.resizeImage(o,u,f),"repeat"),t.renderRepeat(nt,ut,s,h)),[3,6];case 5:r.type===k.LINEAR_GRADIENT?(p=ve(n,i,[null,null,null]),nt=p[0],s=p[1],h=p[2],u=p[3],f=p[4],w=sl(r.angle,u,f),wt=w[0],bt=w[1],kt=w[2],dt=w[3],gt=w[4],(it=document.createElement("canvas")).width=u,it.height=f,rt=it.getContext("2d"),ct=rt.createLinearGradient(bt,dt,kt,gt),vo(r.stops,wt).forEach(function(n){return ct.addColorStop(n.stop,b(n.color))}),rt.fillStyle=ct,rt.fillRect(0,0,u,f),u>0&&f>0&&(ut=t.ctx.createPattern(it,"repeat"),t.renderRepeat(nt,ut,s,h))):function(n){return n.type===k.RADIAL_GRADIENT}(r)&&(g=ve(n,i,[null,null,null]),nt=g[0],et=g[1],ot=g[2],u=g[3],f=g[4],st=0===r.position.length?[ne]:r.position,s=e(st[0],u),h=e(st[st.length-1],f),lt=function(n,t,i,r,u){var f=0,o=0,l;switch(n.size){case y.CLOSEST_SIDE:n.shape===v.CIRCLE?f=o=Math.min(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-u)):n.shape===v.ELLIPSE&&(f=Math.min(Math.abs(t),Math.abs(t-r)),o=Math.min(Math.abs(i),Math.abs(i-u)));break;case y.CLOSEST_CORNER:if(n.shape===v.CIRCLE)f=o=Math.min(ft(t,i),ft(t,i-u),ft(t-r,i),ft(t-r,i-u));else if(n.shape===v.ELLIPSE){var s=Math.min(Math.abs(i),Math.abs(i-u))/Math.min(Math.abs(t),Math.abs(t-r)),a=yo(r,u,t,i,!0),h=a[0],c=a[1];o=s*(f=ft(h-t,(c-i)/s))}break;case y.FARTHEST_SIDE:n.shape===v.CIRCLE?f=o=Math.max(Math.abs(t),Math.abs(t-r),Math.abs(i),Math.abs(i-u)):n.shape===v.ELLIPSE&&(f=Math.max(Math.abs(t),Math.abs(t-r)),o=Math.max(Math.abs(i),Math.abs(i-u)));break;case y.FARTHEST_CORNER:n.shape===v.CIRCLE?f=o=Math.max(ft(t,i),ft(t,i-u),ft(t-r,i),ft(t-r,i-u)):n.shape===v.ELLIPSE&&(s=Math.max(Math.abs(i),Math.abs(i-u))/Math.max(Math.abs(t),Math.abs(t-r)),l=yo(r,u,t,i,!1),h=l[0],c=l[1],o=s*(f=ft(h-t,(c-i)/s)))}return Array.isArray(n.size)&&(f=e(n.size[0],r),o=2===n.size.length?e(n.size[1],u):f),[f,o]}(r,s,h,u,f),l=lt[0],at=lt[1],l>0&&l>0&&(vt=t.ctx.createRadialGradient(et+s,ot+h,0,et+s,ot+h,l),vo(r.stops,2*l).forEach(function(n){return vt.addColorStop(n.stop,b(n.color))}),t.path(nt),t.ctx.fillStyle=vt,l!==at?(yt=n.bounds.left+.5*n.bounds.width,tt=n.bounds.top+.5*n.bounds.height,pt=1/(ni=at/l),t.ctx.save(),t.ctx.translate(yt,tt),t.ctx.transform(1,0,0,ni,0,0),t.ctx.translate(-yt,-tt),t.ctx.fillRect(et,pt*(ot-tt)+tt,u,f*pt),t.ctx.restore()):t.ctx.fill()));d.label=6;case 6:return i--,[2]}})};t=this;r=0;u=n.styles.backgroundImage.slice(0).reverse();s.label=1;case 1:return r<u.length?(o=u[r],[5,f(o)]):[3,4];case 2:s.sent();s.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},i.prototype.renderBorder=function(n,t,i){return nt(this,void 0,void 0,function(){return d(this,function(){return this.path(function(n,t){switch(t){case 0:return rf(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return rf(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return rf(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return rf(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}}(i,t)),this.ctx.fillStyle=b(n),this.ctx.fill(),[2]})})},i.prototype.renderNodeBackgroundAndBorders=function(n){return nt(this,void 0,void 0,function(){var t,o,s,h,u,r,f,e,i=this;return d(this,function(c){switch(c.label){case 0:return this.applyEffects(n.effects,2),t=n.container.styles,o=!ti(t.backgroundColor)||t.backgroundImage.length,s=[{style:t.borderTopStyle,color:t.borderTopColor},{style:t.borderRightStyle,color:t.borderRightColor},{style:t.borderBottomStyle,color:t.borderBottomColor},{style:t.borderLeftStyle,color:t.borderLeftColor}],h=ow(nr(t.backgroundClip,0),n.curves),o||t.boxShadow.length?(this.ctx.save(),this.path(h),this.ctx.clip(),ti(t.backgroundColor)||(this.ctx.fillStyle=b(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(n.container)]):[3,2];case 1:c.sent();this.ctx.restore();t.boxShadow.slice(0).reverse().forEach(function(t){i.ctx.save();var s,r,u,f,e,o=gu(n.curves),h=t.inset?0:1e4,c=(s=o,r=-h+(t.inset?1:-1)*t.spread.number,u=(t.inset?1:-1)*t.spread.number,f=t.spread.number*(t.inset?-2:2),e=t.spread.number*(t.inset?-2:2),s.map(function(n,t){switch(t){case 0:return n.add(r,u);case 1:return n.add(r+f,u);case 2:return n.add(r+f,u+e);case 3:return n.add(r,u+e)}return n}));t.inset?(i.path(o),i.ctx.clip(),i.mask(c)):(i.mask(o),i.ctx.clip(),i.path(c));i.ctx.shadowOffsetX=t.offsetX.number+h;i.ctx.shadowOffsetY=t.offsetY.number;i.ctx.shadowColor=b(t.color);i.ctx.shadowBlur=t.blur.number;i.ctx.fillStyle=t.inset?b(t.color):"rgba(0,0,0,1)";i.ctx.fill();i.ctx.restore()});c.label=2;case 2:u=0;r=0;f=s;c.label=3;case 3:return r<f.length?(e=f[r]).style===pi.NONE||ti(e.color)?[3,5]:[4,this.renderBorder(e.color,u,n.curves)]:[3,7];case 4:c.sent();c.label=5;case 5:u++;c.label=6;case 6:return r++,[3,3];case 7:return[2]}})})},i.prototype.render=function(n){return nt(this,void 0,void 0,function(){var t;return d(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=b(this.options.backgroundColor),this.ctx.fillRect(this.options.x-this.options.scrollX,this.options.y-this.options.scrollY,this.options.width,this.options.height)),r=new yh(n,[]),u=new vh(r),ae(r,u,u,f=[]),ph(r.container,f),t=u,[4,this.renderStack(t)];case 1:return i.sent(),this.applyEffects([],2),[2,this.canvas]}var r,u,f})})},i}(),ew=function(n){return n instanceof ws||n instanceof ps||n instanceof oe&&"radio"!==n.type&&"checkbox"!==n.type},ow=function(n,t){switch(n){case ut.BORDER_BOX:return gu(t);case ut.CONTENT_BOX:return function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]}(t);case ut.PADDING_BOX:default:return nf(t)}},sw=function(n){switch(n){case st.CENTER:return"center";case st.RIGHT:return"right";case st.LEFT:default:return"left"}},hw=function(){function n(n){this.canvas=n.canvas?n.canvas:document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.options=n;this.canvas.width=Math.floor(n.width*n.scale);this.canvas.height=Math.floor(n.height*n.scale);this.canvas.style.width=n.width+"px";this.canvas.style.height=n.height+"px";this.ctx.scale(this.options.scale,this.options.scale);this.ctx.translate(-n.x+n.scrollX,-n.y+n.scrollY);c.getInstance(n.id).debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale)}return n.prototype.render=function(n){return nt(this,void 0,void 0,function(){var t,i;return d(this,function(r){switch(r.label){case 0:return t=ie(Math.max(this.options.windowWidth,this.options.width)*this.options.scale,Math.max(this.options.windowHeight,this.options.height)*this.options.scale,this.options.scrollX*this.options.scale,this.options.scrollY*this.options.scale,n),[4,cw(t)];case 1:return i=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=b(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},n}(),cw=function(n){return new Promise(function(t,i){var r=new Image;r.onload=function(){t(r)};r.onerror=i;r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(n))})},ye=function(n){return lt(kf.create(n).parseComponentValue())};return vt.setContext(window),bh=function(n,t){return nt(void 0,void 0,void 0,function(){var u,f,r,e,g,nt,tt,it,h,rt,i,ut,l,a,ft,v,y,o,p,w,b,k,s;return d(this,function(d){switch(d.label){case 0:if(!(u=n.ownerDocument))throw new Error("Element is not attached to a Document");if(!(f=u.defaultView))throw new Error("Document is not attached to a Window");return r=(Math.round(1e3*Math.random())+Date.now()).toString(16),e=he(n)||"HTML"===n.tagName?function(n){var t=n.body,i=n.documentElement,r,u;if(!t||!i)throw new Error("Unable to get document size");return r=Math.max(Math.max(t.scrollWidth,i.scrollWidth),Math.max(t.offsetWidth,i.offsetWidth),Math.max(t.clientWidth,i.clientWidth)),u=Math.max(Math.max(t.scrollHeight,i.scrollHeight),Math.max(t.offsetHeight,i.offsetHeight),Math.max(t.clientHeight,i.clientHeight)),new bt(0,0,r,u)}(u):of(n),g=e.width,nt=e.height,tt=e.left,it=e.top,h=ef({},{allowTaint:!1,imageTimeout:15e3,proxy:void 0,useCORS:!1},t),rt={backgroundColor:"#ffffff",cache:t.cache?t.cache:vt.create(r,h),logging:!0,removeContainer:!0,foreignObjectRendering:!1,scale:f.devicePixelRatio||1,windowWidth:f.innerWidth,windowHeight:f.innerHeight,scrollX:f.pageXOffset,scrollY:f.pageYOffset,x:tt,y:it,width:Math.ceil(g),height:Math.ceil(nt),id:r},i=ef({},rt,h,t),ut=new bt(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),c.create({id:r,enabled:i.logging}),c.getInstance(r).debug("Starting document clone"),l=new ch(n,{id:r,onclone:i.onclone,ignoreElements:i.ignoreElements,inlineImages:i.foreignObjectRendering,copyStyles:i.foreignObjectRendering}),(a=l.clonedReferenceElement)?[4,l.toIFrame(u,ut)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return ft=d.sent(),v=u.documentElement?ye(getComputedStyle(u.documentElement).backgroundColor):at.TRANSPARENT,y=u.body?ye(getComputedStyle(u.body).backgroundColor):at.TRANSPARENT,o=t.backgroundColor,p="string"==typeof o?ye(o):null===o?at.TRANSPARENT:4294967295,w=n===u.documentElement?ti(v)?ti(y)?p:y:v:p,b={id:r,cache:i.cache,canvas:i.canvas,backgroundColor:w,scale:i.scale,x:i.x,y:i.y,scrollX:i.scrollX,scrollY:i.scrollY,width:i.width,height:i.height,windowWidth:i.windowWidth,windowHeight:i.windowHeight},i.foreignObjectRendering?(c.getInstance(r).debug("Document cloned, using foreign object rendering"),[4,new hw(b).render(a)]):[3,3];case 2:return k=d.sent(),[3,5];case 3:return c.getInstance(r).debug("Document cloned, using computed rendering"),vt.attachInstance(i.cache),c.getInstance(r).debug("Starting DOM parsing"),s=nh(a),vt.detachInstance(),w===s.styles.backgroundColor&&(s.styles.backgroundColor=at.TRANSPARENT),c.getInstance(r).debug("Starting renderer"),[4,new fw(b).render(s)];case 4:k=d.sent();d.label=5;case 5:return!0===i.removeContainer&&(ch.destroy(ft)||c.getInstance(r).error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.getInstance(r).debug("Finished rendering"),c.destroy(r),vt.destroy(r),[2,k]}})})},function(n,t){return void 0===t&&(t={}),bh(n,t)}}()},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GATECRASH_ON_SURVEY_LOAD=t.GATECRASH_ON_SURVEY_CANCEL=t.EVENT_RESPONSE_DATA_ERROR=t.GATECRASH_ON_SURVEY_DATA_SUBMIT=t.GATECRASH_RENDER_ERROR=t.SURVEY_DIV_ID=t.RESPONSE_PAGE_IFRAME_ID=t.OVERLAY_DIV_ID=t.IFRAME_ID=t.ICON_DIV_ID=t.FORMSPRO_BASE_URL=t.DEFAULT_BASE_URL=t.DEFAULT_TEXT_CONTENT=t.DEFAULT_FRAME_CONTAINER_WIDTH=t.DEFAULT_FRAME_CONTAINER_HEIGHT=t.DEFAULT_FRAME_CONTAINER_ID=t.DEFAULT_EXPAND_HEIGHT=t.DEFAULT_COLLAPSE_HEIGHT=t.CDN_URL=t.CONTAINTER_SPAN_TEXT_ID=t.CONTAINER_BUTTON_ID=t.CLOSE_ICON_SOURCE=t.CLOSE_ICON_ID=t.CLOSE_BUTTON_ID=t.BUTTON_IFRAME_ID=t.BUTTON_CONTAINER_COLLAPSE=t.BUTTON_CONTAINER=t.ARROW_ICON_ID=void 0;t.ARROW_ICON_ID="MfpEmbed_Icon_Arrow";t.BUTTON_CONTAINER="MfpEmbed_Button_Container";t.BUTTON_CONTAINER_COLLAPSE="MfpEmbed_Button_Container_Collapse";t.BUTTON_IFRAME_ID="MfpEmbed_Button_Iframe";t.CLOSE_BUTTON_ID="closeButton";t.CLOSE_ICON_ID="MfpEmbed_CrossButton";t.CLOSE_ICON_SOURCE="cross.svg";t.CONTAINER_BUTTON_ID="MfpEmbed_Button";t.CONTAINTER_SPAN_TEXT_ID="MfpEmbed_Span";t.CDN_URL="https://mfpembedcdnwus2.azureedge.net/mfpembedcontwus2/";t.DEFAULT_COLLAPSE_HEIGHT="48px";t.DEFAULT_EXPAND_HEIGHT="480px";t.DEFAULT_FRAME_CONTAINER_ID="MfpEmbed_Popup";t.DEFAULT_FRAME_CONTAINER_HEIGHT="600px";t.DEFAULT_FRAME_CONTAINER_WIDTH="320px";t.DEFAULT_TEXT_CONTENT="Provide Feedback";t.DEFAULT_BASE_URL="https://customervoice.microsoft.com/";t.FORMSPRO_BASE_URL="https://forms.office.com/formspro/";t.ICON_DIV_ID="mfpembed_iconDiv";t.IFRAME_ID="MfpEmbed_Iframe";t.OVERLAY_DIV_ID="mfpembed_overlayDiv";t.RESPONSE_PAGE_IFRAME_ID="MfpEmbed_Popup_Iframe";t.SURVEY_DIV_ID="gatecrashSurvey";t.GATECRASH_RENDER_ERROR={name:"Gatecrash_Render_Error"};t.GATECRASH_ON_SURVEY_DATA_SUBMIT={name:"Gatecrash_On_Survey_Data_Submit"};t.EVENT_RESPONSE_DATA_ERROR={name:"Gatecrash_Event_Response_Data_Error"};t.GATECRASH_ON_SURVEY_CANCEL={name:"Gatecrash_On_Survey_Cancel"};t.GATECRASH_ON_SURVEY_LOAD={name:"Gatecrash_On_Survey_Load"}},function(n,t,i){"use strict";function f(n){var t=n.toLocaleUpperCase(),i,e,f;if(t in u)return u[t];for(i=0,e=r;i<e.length;i++)if((f=e[i]).toUpperCase()===t)return f;for(var h=t.split("-")[0],o=0,s=r;o<s.length;o++)if((f=s[o]).toUpperCase()===h)return f;return"en"}i.d(t,"a",function(){return f});var r=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],u={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"}},function(n,t,i){"use strict";var f=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){void 0===r&&(r=i);n[r]=t[i]}),r=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||f(t,n,i)},u;Object.defineProperty(t,"__esModule",{value:!0});t.ItemChanges=t.ItemOperation=void 0;r(i(79),t);u=i(80);Object.defineProperty(t,"ItemOperation",{enumerable:!0,get:function(){return u.ItemOperation}});Object.defineProperty(t,"ItemChanges",{enumerable:!0,get:function(){return u.ItemChanges}});r(i(81),t);r(i(82),t);r(i(83),t);r(i(84),t);r(i(85),t);r(i(29),t);r(i(86),t);r(i(87),t)},function(n,t,i){"use strict";var u=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){void 0===r&&(r=i);n[r]=t[i]}),r=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||t.hasOwnProperty(i)||u(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0});r(i(88),t);r(i(89),t)},function(n,t,i){i(91);n.exports=i(92)},function(n,t,i){"use strict";n.exports=i(55).polyfill()},function(n){n.exports=function(){"use strict";function l(n){return"function"==typeof n}function v(){var n=setTimeout;return function(){return n(f,1)}}function f(){for(var n=0;n<o;n+=2)u[n](u[n+1]),u[n]=void 0,u[n+1]=void 0;o=0}function w(n,t){var f=this,i=new this.constructor(e),u,o;return void 0===i[h]&&ht(i),u=f._state,u?(o=arguments[u-1],r(function(){return st(u,i,o,f._result)})):k(f,i,n,t),i}function b(n){if(n&&"object"==typeof n&&n.constructor===this)return n;var t=new this(e);return c(t,n),t}function e(){}function ot(t,u,f){u.constructor===t.constructor&&f===w&&u.constructor.resolve===b?function(t,r){1===r._state?i(t,r._result):2===r._state?n(t,r._result):k(r,void 0,function(n){return c(t,n)},function(i){return n(t,i)})}(t,u):void 0===f?i(t,u):l(f)?function(t,u,f){r(function(t){var r=!1,e=function(n,t,i,r){try{n.call(t,i,r)}catch(n){return n}}(f,u,function(n){r||(r=!0,u!==n?c(t,n):i(t,n))},function(i){r||(r=!0,n(t,i))},t._label);!r&&e&&(r=!0,n(t,e))},t)}(t,u,f):i(t,u)}function c(t,r){var u,e,f;if(t===r)n(t,new TypeError("You cannot resolve a promise with itself"));else if(f=typeof(e=r),null===e||"object"!==f&&"function"!==f)i(t,r);else{u=void 0;try{u=r.then}catch(r){return void n(t,r)}ot(t,r,u)}}function vt(n){n._onerror&&n._onerror(n._result);d(n)}function i(n,t){void 0===n._state&&(n._result=t,n._state=1,0!==n._subscribers.length&&r(d,n))}function n(n,t){void 0===n._state&&(n._state=2,n._result=t,r(vt,n))}function k(n,t,i,u){var f=n._subscribers,e=f.length;n._onerror=null;f[e]=t;f[e+1]=i;f[e+2]=u;0===e&&n._state&&r(d,n)}function d(n){var t=n._subscribers,f=n._state;if(0!==t.length){for(var r=void 0,u=void 0,e=n._result,i=0;i<t.length;i+=3)r=t[i],u=t[i+f],r?st(f,r,u,e):u(e);n._subscribers.length=0}}function st(t,r,u,f){var s=l(u),e=void 0,h=void 0,o=!0;if(s){try{e=u(f)}catch(l){o=!1;h=l}if(r===e)return void n(r,new TypeError("A promises callback cannot return that same promise."))}else e=f;void 0!==r._state||(s&&o?c(r,e):!1===o?n(r,h):1===t?i(r,e):2===t&&n(r,e))}function ht(n){n[h]=g++;n._state=void 0;n._result=void 0;n._subscribers=[]}var nt=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},o=0,tt=void 0,a=void 0,r=function(n,t){u[o]=n;u[o+1]=t;2===(o+=2)&&(a?a(f):s())},it="undefined"!=typeof window?window:void 0,rt=it||{},ut=rt.MutationObserver||rt.WebKitMutationObserver,lt="undefined"==typeof self&&"[object process]"==={}.toString.call(Object({})),at="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,u=new Array(1e3),ft,y,et,p,s=void 0,h,g,ct,t;return lt?s=function(){return Object({}).nextTick(f)}:ut?(y=0,et=new ut(f),p=document.createTextNode(""),et.observe(p,{characterData:!0}),s=function(){p.data=y=++y%2}):at?((ft=new MessageChannel).port1.onmessage=f,s=function(){return ft.port2.postMessage(0)}):s=void 0===it?function(){try{var n=Function("return this")().require("vertx");return void 0!==(tt=n.runOnLoop||n.runOnContext)?function(){tt(f)}:v()}catch(n){return v()}}():v(),h=Math.random().toString(36).substring(2),g=0,ct=function(){function r(t,r){this._instanceConstructor=t;this.promise=new t(e);this.promise[h]||ht(this.promise);nt(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?i(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&i(this.promise,this._result))):n(this.promise,new Error("Array Methods must be provided an Array"))}return r.prototype._enumerate=function(n){for(var t=0;void 0===this._state&&t<n.length;t++)this._eachEntry(n[t],t)},r.prototype._eachEntry=function(i,r){var u=this._instanceConstructor,s=u.resolve,o;if(s===b){var f=void 0,h=void 0,c=!1;try{f=i.then}catch(i){c=!0;h=i}f===w&&void 0!==i._state?this._settledAt(i._state,r,i._result):"function"!=typeof f?(this._remaining--,this._result[r]=i):u===t?(o=new u(e),c?n(o,h):ot(o,i,f),this._willSettleAt(o,r)):this._willSettleAt(new u(function(n){return n(i)}),r)}else this._willSettleAt(s(i),r)},r.prototype._settledAt=function(t,r,u){var f=this.promise;void 0===f._state&&(this._remaining--,2===t?n(f,u):this._result[r]=u);0===this._remaining&&i(f,this._result)},r.prototype._willSettleAt=function(n,t){var i=this;k(n,void 0,function(n){return i._settledAt(1,t,n)},function(n){return i._settledAt(2,t,n)})},r}(),t=function(){function t(i){this[h]=g++;this._result=this._state=void 0;this._subscribers=[];e!==i&&("function"!=typeof i&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}(),this instanceof t?function(t,i){try{i(function(n){c(t,n)},function(i){n(t,i)})}catch(i){n(t,i)}}(this,i):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}())}return t.prototype.catch=function(n){return this.then(null,n)},t.prototype.finally=function(n){var t=this.constructor;return l(n)?this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){throw i;})}):this.then(n,n)},t}(),t.prototype.then=w,t.all=function(n){return new ct(this,n).promise},t.race=function(n){var t=this;return nt(n)?new t(function(i,r){for(var f=n.length,u=0;u<f;u++)t.resolve(n[u]).then(i,r)}):new t(function(n,t){return t(new TypeError("You must pass an array to race."))})},t.resolve=b,t.reject=function(t){var i=new this(e);return n(i,t),i},t._setScheduler=function(n){a=n},t._setAsap=function(n){r=n},t._asap=r,t.polyfill=function(){var n=void 0,i,r;if("undefined"!=typeof window)n=window;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment");}if(i=n.Promise,i){r=null;try{r=Object.prototype.toString.call(i.resolve())}catch(n){}if("[object Promise]"===r&&!i.cast)return}n.Promise=t},t.Promise=t,t}()},function(n){"use strict";var t;!function(n){var t=function(){function n(){}return n.AppLaunch="AppLaunch",n.AppUsageTime="AppUsageTime",n.AppResume="AppResume",n}();n.ActivityName=t}(t||(t={}));n.exports=t},function(n){"use strict";var t;!function(n){n.RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259}}(t||(t={}));n.exports=t},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CampaignManager=void 0;var f=i(20),u=i(10),e=i(21),l=i(41),a=i(59),h=i(16),v=i(35),c=u.getDistantFuture,o=u.getDistantPast,s=u.isArray,r=u.isNOU,y=function(){function n(n,t,i,u,f,e,o){if(!n)throw new Error("stateProvider must not be null");if(!s(t))throw new Error("definitionProviders is either null or not an array type");if(!i)throw new Error("stringProvider must not be null");if(r(f))throw new Error("currentBuildNumber must not be null");this.campaignStates={};this.campaignDefinitions={};this.userFacts=[];this.stateProvider=n;this.definitionProviders=t;this.stringProvider=i;this.userFactsProvider=o;this.environmentProvider=u;this.currentBuildNumber=f;e=e||new Date}return n.isStateUpForNomination=function(t,i,r,u){if(!t||!i)return!1;if(r=r||new Date,t.ForceCandidacy)return!0;var f=i.nominationScheme.getCampaignCooldown(t.IsCandidate&&t.DidCandidateTriggerSurvey);return!!f&&(!!n.hasBuildChangeDurationElapsed(f,t.LastNominationBuildNumber,u)||n.hasTimeIntervalDurationElapsed(f,t.getCooldownStartDate(),r))},n.isDateInRange=function(n,t,i){return n=n||new Date,t=t||o(),i=i||c(),t.getTime()<=n.getTime()&&i.getTime()>=n.getTime()},n.hasTimeIntervalDurationElapsed=function(n,t,i){if(r(n)||!(n instanceof e.CampaignDurationTimeInterval)||!t||!i)return!1;var f=u.addSecondsWithoutOverflow(t,n.intervalSeconds);return i.getTime()>=f.getTime()},n.hasBuildChangeDurationElapsed=function(n,t,i){return!r(n)&&n instanceof e.CampaignDurationSingleBuildChange&&(r(t)||r(i)?null===t!=(null===i):!(t===i))},n.isCampaignInScope=function(t,i,r,u){return!!t&&(i=i||new Date,!!n.isDateInRangeWithDefinition(i,t)&&!(t.scope&&((t.scope instanceof e.CampaignScopeUserFactAny||t.scope instanceof e.CampaignScopeUserFactAll)&&t.scope.setUserFactsProvider(u),t.scope instanceof e.CampaignScopeEnvironmentCrossProduct&&t.scope.setEnvironmentProvider(r),!t.scope.isInScope())))},n.isDateInRangeWithDefinition=function(t,i){return!!i&&(t=t||new Date,n.isDateInRange(t,i.startTime?i.startTime:c(),i.endTime))},n.prototype.getActiveSurveys=function(){var u={},f=this.getPrioritizedCampaigns(),i,n,r,t;for(i in this.campaignStates)if(this.campaignStates.hasOwnProperty(i)){if(n=this.campaignStates[i],!n.IsCandidate)continue;if(r=f[n.CampaignId],!r)continue;if(t=a.CampaignSurveyFactory.makeSurvey(n,r,this.stringProvider),!t)continue;u[t.getSurveyInfo().getId()]=t}return u},n.prototype.onCampaignSurveyActivated=function(n,t,i){var r=this.campaignStates[n],u;r&&(t=t||new Date,u=this.campaignDefinitions[n].nominationScheme.cooldownPeriod.asTimeIntervalSeconds(),r.markCurrentSurveyTakenOnDate(t,u,i),this.saveCurrentState())},n.prototype.getCampaignStates=function(){return this.campaignStates},n.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions},n.prototype.getUserFacts=function(){return this.userFacts},n.prototype.onSurveyActivated=function(n,t){n&&this.onCampaignSurveyActivated(n.getBackEndId(),new Date,t)},n.prototype.refreshSurveyDefinitions=function(n,t){this.refreshSurveyDefinitionsPrivate(n,t||new Date)},n.prototype.refreshSurveyDefinitionsAsync=function(n,t){var i=this;return new Promise(function(r,u){i.refreshSurveyDefinitionsPrivateAsync(n,t||new Date).then(function(){r()}).catch(function(n){u(n)})})},n.prototype.getAppSurveys=function(){return this.getActiveSurveys()},n.prototype.saveCurrentState=function(){var n=u.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);this.stateProvider.save(n)},n.prototype.refreshSurveyDefinitionsPrivate=function(n,t){this.campaignStates={};this.campaignDefinitions={};this.userFacts=[];this.loadAndFilterCampaignData(t,n);this.evaluateCampaigns(t)},n.prototype.refreshSurveyDefinitionsPrivateAsync=function(n,t){this.campaignStates={};this.campaignDefinitions={};this.userFacts=[];var i=this;return new Promise(function(r,u){i.loadAndFilterCampaignDataAsync(t,n).then(function(){i.evaluateCampaigns(t);r()}).catch(function(n){u(n)})})},n.prototype.loadAndFilterCampaignDataAsync=function(n,t){var o;n=n||new Date;for(var u=[],c=[],l=this.userFactsProvider&&this.userFactsProvider.loadAsync(),e=0,a=Object.keys(this.definitionProviders);e<a.length;e++){var y=a[e],v=this.definitionProviders[y],i=v&&v.loadAsync();r(i)||(i=i.catch(function(){f.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider");Promise.resolve()}),c.push(i))}return o=this,new Promise(function(i){Promise.all(c).then(function(e){for(var y,a,c=0,v=Object.keys(e);c<v.length;c++)y=e[v[c]],s(y)&&(u=u.concat(y));a=function(r){o.userFacts=r||[];o.FilterCampaignData(n,t,u);i()};r(l)?a():l.then(function(n){a(n)}).catch(function(){f.FloodgateEngine.getTelemetryLogger().log_Error(h.TelemetryEvent.Floodgate.UserFactsLoad.Failed,"Failed to load from user facts provider");a()})}).catch(function(){f.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider")})})},n.prototype.loadAndFilterCampaignData=function(n,t){var u,e;n=n||new Date;for(var i=[],r=0,o=Object.keys(this.definitionProviders);r<o.length;r++){u=o[r];try{e=this.definitionProviders[u]&&this.definitionProviders[u].load();s(e)&&(i=i.concat(e))}catch(n){f.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider. "+n.toString())}}try{this.userFacts=this.userFactsProvider&&this.userFactsProvider.load()||[]}catch(n){f.FloodgateEngine.getTelemetryLogger().log_Error(h.TelemetryEvent.Floodgate.UserFactsLoad.Failed,"Failed to load from user facts provider. "+n)}this.FilterCampaignData(n,t,i)},n.prototype.FilterCampaignData=function(t,i,r){var l={},h,s,f,e,o,c;for(e in r)if(r.hasOwnProperty(e)){if(l[(o=r[e]).campaignId]=o,i&&i.indexOf(o.governedChannelType)<0&&o.businessLevel!==v.BusinessLevel.Critical)continue;if(!n.isCampaignInScope(o,t,this.environmentProvider,this.userFactsProvider))continue;this.campaignDefinitions[o.campaignId]=o}h=this.stateProvider.load();s=[];for(e in h)h.hasOwnProperty(e)&&(f=h[e],this.campaignDefinitions.hasOwnProperty(f.CampaignId)||s.push(f),this.campaignStates[f.CampaignId]=f);for(e in s)if(s.hasOwnProperty(e)){if(!(f=s[e]))continue;c=!1;(o=l[f.CampaignId])?n.isStateUpForNomination(f,o,t,this.currentBuildNumber)&&(c=!0):f.LastNominationTimeUtc.getTime()<=u.subtractSecondsWithoutOverflow(t,f.DeleteAfterSecondsWhenStale).getTime()&&(c=!0);c&&delete this.campaignStates[f.CampaignId]}},n.prototype.getPrioritizedCampaigns=function(){var i=this,t={},n={};return Object.keys(this.campaignDefinitions||[]).forEach(function(r){var u=i.campaignDefinitions[r];t[r]=u;(u.tags&&u.tags.length>0?u.tags:[""]).forEach(function(t){var i=t+"_"+u.governedChannelType;n[i]=n[i]||[];n[i].push(u)})}),Object.keys(n).forEach(function(i){var u=n[i],f;u.length<=1||(f=u.reduce(function(n,t){return(t.primaryPriority||0)<(n.primaryPriority||0)?t:n},u[0]).primaryPriority,r(f)||u.forEach(function(n){var i=n.primaryPriority;!r(n.primaryPriority)&&i>f&&delete t[n.campaignId]}))}),t},n.prototype.evaluateCampaigns=function(t){var f,r,i,s;for(f in t=t||new Date,this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(f)&&(r=this.campaignDefinitions[f],i=this.campaignStates[r.campaignId],!i||n.isStateUpForNomination(i,r,t,this.currentBuildNumber))){var h=i?i.LastSurveyId:"",e=i?i.LastSurveyStartTimeUtc:o(),c=i?i.LastSurveyExpirationTimeUtc:o(),v=i?i.LastSurveyActivatedTimeUtc:o(),y=i?i.LastCooldownEndTimeUtc:o(),a=i&&i.ForceCandidacy||r.nominationScheme.evaluateNominationRules();a&&(h=u.guid(),e=r.nominationScheme.calculateSurveyStartTimeFromDate(t),c=r.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(e));s=new l.CampaignState(r.campaignId,t,this.currentBuildNumber,r.nominationScheme.getActiveSurveyTimeIntervalSeconds(),!1,a,!1,v,h,e,c,y);this.campaignStates[s.CampaignId]=s}},n}();t.CampaignManager=y},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CampaignSurveyFactory=void 0;var c=i(18),u=i(60),o=i(63),l=i(64),a=i(66),v=i(67),y=i(69),e=i(70),p=i(24),s=i(10),r=i(21),h=s.dateToShortUtcString,f=s.isNOU,w=function(){function n(){}return n.makeSurvey=function(t,i,u){if(!(t&&i&&i.surveyTemplate&&u))return null;var o=n.makeSurveyDataSourceData(t,i),f=i.surveyTemplate;return f instanceof r.CampaignSurveyTemplateNps5PointStatic?e.make5Point(o,u):f instanceof r.CampaignSurveyTemplateNps11PointStatic?e.make11Point(o,u):f instanceof r.CampaignSurveyTemplateFps?l.makeFps(o,u,f):f instanceof r.CampaignSurveyTemplateNlqs?y.makeNlqs(o,u,f):f instanceof r.CampaignSurveyTemplateNps?e.makeCustom(o,u,f):f instanceof r.CampaignSurveyTemplateGenericMessagingSurface?a.makeCustom(o):f instanceof r.CampaignSurveyTemplateIntercept?v.makeIntercept(o,u,f):null},n.makeSurveyDataSourceData=function(t,i){if(!t||!i||!i.surveyTemplate)return null;var u=i.surveyTemplate,r=new p.SurveyDataSourceData;return r.activationEvent=n.makeEvent(t,u.activationEvent),r.metadata=n.makeMetadata(u.metadata),r.id=t.LastSurveyId,r.backEndIdentifier=t.CampaignId,r.expirationTimeUtc=h(t.LastSurveyExpirationTimeUtc),r.governedChannelType=i.governedChannelType,r.startTimeUtc=h(t.LastSurveyStartTimeUtc),r.additionalDataRequested=i.additionalDataRequested||[],r.launcherType=i.launcherType||c.LAUNCHER_TYPE_DEFAULT,r.preferredLaunchType=i.surveyTemplate.preferredLaunchType||"Default",r.businessLevel=i.businessLevel,f(u.maxLaunches)||(r.maxLaunches=u.maxLaunches),f(u.maxLaunchesPerSession)||(r.maxLaunchesPerSession=u.maxLaunchesPerSession),r},n.makeCountedActivityEventData=function(n){if(!n)return null;var t=new u.CountedActivityEventData;return t.activity=n.activity,t.count=n.count,t.isAggregate=n.isAggregate,t},n.makeCountedActivityEvent=function(t,i){if(!t||!i)return null;var r=n.makeCountedActivityEventData(i);return r?new u.CountedActivityEvent(r):null},n.makeCountedActivitySequenceEvent=function(t,i){var r,f,e,s,o;if(!t||!i)return null;for(r=new u.CountedActivitySequenceEventData,r.sequence=[],f=0,e=i.sequence;f<e.length;f++){if(s=e[f],o=n.makeCountedActivityEventData(s),!o)return null;r.sequence.push(o)}return new u.CountedActivitySequenceEvent(r)},n.makeEvent=function(t,i){return i instanceof r.CampaignSurveyEventCountedActivity?n.makeCountedActivityEvent(t,i):i instanceof r.CampaignSurveyEventCountedActivitySequence?n.makeCountedActivitySequenceEvent(t,i):null},n.makeMetadata=function(n){if(f(n)||f(n.contentMetadata))return null;var t=new o.Metadata;return t.contentMetadata=n.contentMetadata,new o.SurveyMetadata(t)},n}();t.CampaignSurveyFactory=w},function(n,t,i){"use strict";var e,o,s;Object.defineProperty(t,"__esModule",{value:!0});t.CountedActivitySequenceEventData=t.CountedActivitySequenceEvent=t.CountedActivityEventData=t.CountedActivityEvent=void 0;var r=i(61),u=i(62),f=function(){function n(n){if(!n)throw new Error("data must not be null");if(n.count<=0)throw new Error("count must be greater than 0");if(!n.activity||0===n.activity.length)throw new Error("activity must not be null or an empty string");this.data=n}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getActivity=function(){return this.data.activity},n.prototype.getCount=function(){return this.data.count},n.prototype.isAggregate=function(){return this.data.isAggregate},n.prototype.getType=function(){return"CountedActivity"},n.prototype.getTrackingSet=function(){var n=[];return n.push(new r.ActivityTrackingData(this.data.activity,this.data.count,this.data.isAggregate)),new u.ActivityTrackingSet(!1,n)},n}();t.CountedActivityEvent=f;e=function(){};t.CountedActivityEventData=e;o=function(){function n(n){var t,i,r;if(!n)throw new Error("data must not be null");if(!n.sequence)throw new Error("data.sequence must not be null");if(0===n.sequence.length)throw new Error("data.sequence size must be greater than 0");for(this.data=[],t=0,i=n.sequence;t<i.length;t++)r=i[t],this.data.push(new f(r))}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getSequence=function(){return this.data},n.prototype.getType=function(){return"CountedActivitySequence"},n.prototype.getTrackingSet=function(){for(var n,i=[],t=0,f=this.data;t<f.length;t++)n=f[t],i.push(new r.ActivityTrackingData(n.getActivity(),n.getCount(),n.isAggregate()));return new u.ActivityTrackingSet(!0,i)},n}();t.CountedActivitySequenceEvent=o;s=function(){function n(){}return n.prototype.CountedActivitySequenceEventData=function(){},n}();t.CountedActivitySequenceEventData=s},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActivityTrackingData=void 0;var i=function(){function n(n,t,i){this.activity=n;this.count=t;this.isAggregate=i}return n.prototype.getActivity=function(){return this.activity},n.prototype.getCount=function(){return this.count},n.prototype.setCount=function(n){this.count=n},n.prototype.getIsAggregate=function(){return this.isAggregate},n}();t.ActivityTrackingData=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActivityTrackingSet=void 0;var r=i(10),u=function(){function n(n,t){this.isOrdered=n;this.list=t}return n.prototype.getIsOrdered=function(){return this.isOrdered},n.prototype.getList=function(){return this.list},n.prototype.getActivityTrackingInfo=function(n,t){var i,u,e;if(0===this.list.length)return i={Activities:[],IsListOrdered:this.isOrdered},JSON.stringify(i);for(u=0,e=this.list;u<e.length;u++){var f=e[u],o=n.getCount(f.getActivity(),t),s={Activity:f.getActivity(),ActualCount:o,Count:f.getCount(),IsAggregate:f.getIsAggregate(),IsDiscrete:o%1==0};r.isNOU(i)?i={Activities:[s],IsListOrdered:this.isOrdered}:i.Activities.push(s)}return JSON.stringify(i)},n}();t.ActivityTrackingSet=u},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.Metadata=t.SurveyMetadata=void 0;r=i(10);u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.contentMetadata)throw new Error("content metadata must not be null");if(!r.isObject(n.contentMetadata))throw new Error("content metadata must be of object type");this.data=n}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getContentMetadata=function(){return this.data.contentMetadata},n}();t.SurveyMetadata=u;f=function(){};t.Metadata=f},function(n,t,i){"use strict";var f,y=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}f(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=i(18),u=i(19),s=i(37),h=i(44),c=i(65),l=i(38),a=i(39),v=i(10),p=i(28),w=i(24),r=v.isNOU,e=function(n){function t(t){var i=n.call(this)||this;if(r(t))throw new Error("data must not be null");return i.surveyInfo=new w(t.baseData),i.prompt=new l(t.promptData),i.question=t.commentData?new s(t.commentData):null,i.rating=t.ratingData?new a(t.ratingData):null,i.multipleChoice=t.multipleChoiceData?new c(t.multipleChoiceData):null,i.cvSurvey=t.cvSurveyData?new h(t.cvSurveyData):null,i}return y(t,n),t.make=function(n){try{return new t(n)}catch(n){return null}},t.makeFps=function(n,i,u){var f,v,w,y,o,p,b;if(r(n)||r(i)||r(u))return null;var k=[],d=[],e=u.content;if(r(e)||r(e.prompt)||r(e.rating)&&r(e.multipleChoice)&&r(e.comment)||(f=new t.FpsSurveyData,f.baseData=n,f.promptData=new l.PromptComponentData,f.promptData.title=i.getCustomString(e.prompt.title),f.promptData.question=i.getCustomString(e.prompt.question),f.promptData.yesButtonLabel=i.getCustomString(e.prompt.yesLabel),f.promptData.noButtonLabel=i.getCustomString(e.prompt.noLabel),r(f.promptData.title)||r(f.promptData.question)||r(f.promptData.yesButtonLabel)||r(f.promptData.noButtonLabel)))return null;if(e.rating){for(f.ratingData=new a.RatingComponentData,f.ratingData.question=i.getCustomString(e.rating.question),f.ratingData.isZeroBased=e.rating.isZeroBased,v=0,w=e.rating.ratingValuesAscending;v<w.length;v++){if(y=w[v],o=i.getCustomString(y),r(o))return null;k.push(o)}if(f.ratingData.ratingValuesAscending=k,r(f.ratingData.question)||r(f.ratingData.ratingValuesAscending))return null}if(e.multipleChoice){for(f.multipleChoiceData=new c.MultipleChoiceComponentData,f.multipleChoiceData.question=i.getCustomString(e.multipleChoice.question),f.multipleChoiceData.minNumberOfSelectedOptions=e.multipleChoice.minNumberOfSelectedOptions,f.multipleChoiceData.maxNumberOfSelectedOptions=e.multipleChoice.maxNumberOfSelectedOptions,p=0,b=e.multipleChoice.availableOptions;p<b.length;p++){if(y=b[p],o=i.getCustomString(y),r(o))return null;d.push(o)}if(f.multipleChoiceData.availableOptions=d,r(f.multipleChoiceData.question)||r(f.multipleChoiceData.availableOptions))return null}return e.comment&&(f.commentData=new s.CommentComponentData,f.commentData.question=i.getCustomString(e.comment.question),r(f.commentData.question))||e.cvSurvey&&(f.cvSurveyData=new h.CVSurveyComponentData,f.cvSurveyData.customerVoiceFormId=e.cvSurvey.customerVoiceFormId,r(f.cvSurveyData.customerVoiceFormId))?null:this.make(f)},t.prototype.getType=function(){return o.Type.Fps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getMultipleChoiceComponent=function(){return this.multipleChoice},t.prototype.getCVSurveyComponent=function(){return this.cvSurvey},t.prototype.getComponent=function(n){switch(n){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();case"MultipleChoice":return this.getMultipleChoiceComponent();case"CVSurvey":return this.getCVSurveyComponent();default:return null}},t.prototype.getDomElements=function(n){if(r(n))throw new Error("Document must not be null");var t=n.createElement(o.DOM_FPS_TAGNAME);return this.getSurveyInfo().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),this.getCommentComponent().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),this.getRatingComponent()&&this.getRatingComponent().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),this.getMultipleChoiceComponent()&&this.getMultipleChoiceComponent().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),[t]},t.prototype.getJsonElements=function(){var t,n={};return(n=v.overrideValues(this.getSurveyInfo().getJsonElements(),n))[u.JSON_APPLICATION_KEYNAME]={},n[u.JSON_APPLICATION_KEYNAME][u.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[u.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t[u.JSON_SURVEYSPECIFICDATA_KEYNAME]=this.makeResponseString(),t)),n},t.prototype.makeResponseString=function(){var n={};return this.question&&(n[u.JSON_COMMENT_KEYNAME]=[this.getCommentComponent().getSubmittedText()]),this.multipleChoice&&(n[u.JSON_MULTIPLECHOICE_KEYNAME]=[this.getMultipleChoiceComponent().getOptionSelectedStates()]),this.rating&&(n[u.JSON_RATING_KEYNAME]=[{numberOfOptions:this.getRatingComponent().getRatingValuesAscending().length,selectedRating:this.getRatingComponent().getSelectedRatingIndex()}]),JSON.stringify(n)},t.prototype.makeSurveyStrings=function(){var n={};return this.prompt&&(n[u.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(n[u.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(n[u.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),this.multipleChoice&&(n[u.JSON_MULTIPLECHOICE_KEYNAME]=[this.multipleChoice.getComponentJson()]),JSON.stringify(n)},t}(p.Survey);!function(n){var t=function(){};n.FpsSurveyData=t}(e||(e={}));n.exports=e},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.question)throw new Error("data.question must not be null or empty");if(!n.availableOptions||n.availableOptions.length<2)throw new Error("data.availableOptions must not be null or have less than two choices");n.availableOptions.forEach(function(n){if(!n)throw new Error("Option values must not contain null or empty");});this.data=n;this.optionStates=new Array(n.availableOptions.length);for(var t=0;t<this.optionStates.length;t++)this.optionStates[t]=!1}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"MultipleChoice"},n.prototype.getQuestion=function(){return this.data.question},n.prototype.getAvailableOptions=function(){return this.data.availableOptions},n.prototype.getOptionSelectedStates=function(){return this.optionStates},n.prototype.getMinNumberofSelectedOptions=function(){return this.data.minNumberOfSelectedOptions},n.prototype.getMaxNumberofSelectedOptions=function(){return this.data.maxNumberOfSelectedOptions},n.prototype.setOptionSelectedStates=function(n){for(var t=0;t<n.length;t++)this.optionStates[t]=n[t]},n.prototype.ValidateMinNumberofSelectedOptions=function(){var n=0;return this.optionStates.forEach(function(t){t&&n++}),n>=this.getMinNumberofSelectedOptions()},n.prototype.ValidateMaxNumberofSelectedOptions=function(){var n=0;return this.optionStates.forEach(function(t){t&&n++}),n<=this.getMaxNumberofSelectedOptions()},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");var t=n.createElement(r.DOM_MULTIPLECHOICE_TAGNAME);return t.appendChild(n.createTextNode(this.getOptionSelectedStates().toString())),[t]},n.prototype.getJsonElements=function(){var n={};return n[r.JSON_MULTIPLECHOICE_KEYNAME]=this.getOptionSelectedStates().toString(),n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),n[r.JSON_RATINGOPTIONS_KEYNAME]=this.getAvailableOptions(),n},n}();!function(n){var t=function(){};n.MultipleChoiceComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var r,e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}r(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=i(18),s=i(10),h=i(28),c=i(24),f=s.isNOU,u=function(n){function t(t){var i=n.call(this)||this;if(!t)throw new Error("data must not be null");if(i.surveyInfo=new c(t.baseData),f(i.surveyInfo.getMetadata()))throw new Error("metadata must not be null");return i}return e(t,n),t.make=function(n){try{return new t(n)}catch(n){return null}},t.makeCustom=function(n){if(f(n))return null;var i=new t.GenericMessagingSurfaceSurveyData;return i.baseData=n,this.make(i)},t.prototype.getType=function(){return o.Type.GenericMessagingSurface},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getComponent=function(){return null},t.prototype.getDomElements=function(){return[]},t.prototype.getJsonElements=function(){return{}},t}(h.Survey);!function(n){var t=function(){};n.GenericMessagingSurfaceSurveyData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var u,o=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),s=i(18),e=i(68),h=i(10),c=i(28),l=i(24),r=h.isNOU,f=function(n){function t(t){var i=n.call(this)||this;if(r(t))throw new Error("data must not be null");return i.surveyInfo=new l(t.baseData),i.intercept=new e(t.interceptData),i}return o(t,n),t.make=function(n){try{return new t(n)}catch(n){return null}},t.makeIntercept=function(n,i,u){var o,f;return r(n)||r(i)||r(u)?null:(o=u.content,r(o)||r(o.intercept))?null:(f=new t.InterceptSurveyData,f.baseData=n,f.interceptData=new e.InterceptComponentData,f.interceptData.title=i.getCustomString(o.intercept.title),f.interceptData.question=i.getCustomString(o.intercept.question),f.interceptData.url=i.getCustomString(o.intercept.url),r(f.interceptData.title)||r(f.interceptData.question)||r(f.interceptData.url)?null:this.make(f))},t.prototype.getType=function(){return s.Type.Intercept},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getInterceptComponent=function(){return this.intercept},t.prototype.getComponent=function(n){return"Intercept"===n?this.getInterceptComponent():null},t.prototype.getDomElements=function(){return[]},t.prototype.getJsonElements=function(){return{}},t}(c.Survey);!function(n){var t=function(){};n.InterceptSurveyData=t}(f||(f={}));n.exports=f},function(n,t,i){"use strict";var r=i(19),u=function(){function n(n){if(!n)throw new Error("data must not be null");if(!n.question)throw new Error("data.question must not be null or empty");if(!n.title)throw new Error("data.title must not be null or empty");if(!n.url)throw new Error("data.url must not be null or empty");this.data=n}return n.make=function(t){try{return new n(t)}catch(n){return null}},n.prototype.getType=function(){return"Intercept"},n.prototype.getTitle=function(){return this.data.title},n.prototype.getQuestion=function(){return this.data.question},n.prototype.getUrl=function(){return this.data.url},n.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");return[n.createElement(r.DOM_INTERCEPT_TAGNAME)]},n.prototype.getJsonElements=function(){var n;return(n={})[r.JSON_INTERCEPT_KEYNAME]="",n},n.prototype.getComponentJson=function(){var n;return(n={})[r.JSON_TITLE_KEYNAME]=this.getTitle(),n[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),n[r.JSON_INTERCEPTURL_KEYNAME]=this.getUrl(),n},n}();!function(n){var t=function(){};n.InterceptComponentData=t}(u||(u={}));n.exports=u},function(n,t,i){"use strict";var u,a=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}u(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=i(18),s=i(37),h=i(38),c=i(39),l=i(10),v=i(28),y=i(24),r=l.isNOU,f=l.overrideValues,e=function(n){function t(t){var i=n.call(this)||this;if(r(t))throw new Error("data must not be null");return i.surveyInfo=new y(t.baseData),i.prompt=new h(t.promptData),i.question=new s(t.commentData),i.rating=new c(t.ratingData),i}return a(t,n),t.make=function(n){try{return new t(n)}catch(n){return null}},t.makeNlqs=function(n,i,u){var l,e,f,o,a,y,v;if(r(n)||r(i)||r(u)||(l=[],e=u.content,r(e)||r(e.comment)||r(e.prompt)||r(e.rating)))return null;for(f=new t.NlqsSurveyData,f.baseData=n,f.promptData=new h.PromptComponentData,f.ratingData=new c.RatingComponentData,f.commentData=new s.CommentComponentData,f.promptData.title=i.getCustomString(e.prompt.title),f.promptData.question=i.getCustomString(e.prompt.question),f.promptData.yesButtonLabel=i.getCustomString(e.prompt.yesLabel),f.promptData.noButtonLabel=i.getCustomString(e.prompt.noLabel),f.ratingData.question=i.getCustomString(e.rating.question),f.ratingData.isZeroBased=e.rating.isZeroBased,f.commentData.question=i.getCustomString(e.comment.question),o=0,a=e.rating.ratingValuesAscending;o<a.length;o++){if(y=a[o],v=i.getCustomString(y),r(v))return null;l.push(v)}return f.ratingData.ratingValuesAscending=l,r(f.ratingData.question)||r(f.commentData.question)||r(f.promptData.title)||r(f.promptData.question)||r(f.promptData.yesButtonLabel)||r(f.promptData.noButtonLabel)||r(f.ratingData.ratingValuesAscending)?null:this.make(f)},t.prototype.getType=function(){return o.Type.Nlqs},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getComponent=function(n){switch(n){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();default:return null}},t.prototype.getDomElements=function(n){if(r(n))throw new Error("Document must not be null");var t=n.createElement(o.DOM_NLQS_TAGNAME);return this.getSurveyInfo().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),this.getCommentComponent().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),this.getRatingComponent().getDomElements(n).forEach(function(n){r(n)||t.appendChild(n)}),[t]},t.prototype.getJsonElements=function(){var n={};return n=f(this.getSurveyInfo().getJsonElements(),n),n=f(this.getCommentComponent().getJsonElements(),n),n=f(this.getRatingComponent().getJsonElements(),n)},t}(v.Survey);!function(n){var t=function(){};n.NlqsSurveyData=t}(e||(e={}));n.exports=e},function(n,t,i){"use strict";var s,y=this&&this.__extends||(s=function(n,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}s(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),l=i(18),u=i(19),f=i(37),a=i(44),e=i(38),o=i(39),v=i(10),p=i(28),w=i(24),r=v.isNOU,h=v.overrideValues,c=function(n){function t(t){var i=n.call(this)||this;if(!t)throw new Error("data must not be null");return i.surveyInfo=new w(t.baseData),i.prompt=new e(t.promptData),i.question=new f(t.commentData),i.rating=new o(t.ratingData),i.cvSurvey=t.cvSurveyData?new a(t.cvSurveyData):null,i}return y(t,n),t.make=function(n){try{return new t(n)}catch(n){return null}},t.makeCustom=function(n,i,u){var l,h,s,c,v,p,y;if(r(n)||r(i)||r(u)||(l=[],h=u.content,r(h)||r(h.comment)||r(h.prompt)||r(h.rating)))return null;for(s=new t.NpsSurveyData,s.baseData=n,s.promptData=new e.PromptComponentData,s.ratingData=new o.RatingComponentData,s.commentData=new f.CommentComponentData,s.promptData.title=i.getCustomString(h.prompt.title),s.promptData.question=i.getCustomString(h.prompt.question),s.promptData.yesButtonLabel=i.getCustomString(h.prompt.yesLabel),s.promptData.noButtonLabel=i.getCustomString(h.prompt.noLabel),s.ratingData.question=i.getCustomString(h.rating.question),s.ratingData.isZeroBased=h.rating.isZeroBased,s.commentData.question=i.getCustomString(h.comment.question),c=0,v=h.rating.ratingValuesAscending;c<v.length;c++){if(p=v[c],y=i.getCustomString(p),r(y))return null;l.push(y)}return s.ratingData.ratingValuesAscending=l,r(s.ratingData.question)||r(s.commentData.question)||r(s.promptData.title)||r(s.promptData.question)||r(s.promptData.yesButtonLabel)||r(s.promptData.noButtonLabel)||r(s.ratingData.ratingValuesAscending)||h.cvSurvey&&(s.cvSurveyData=new a.CVSurveyComponentData,s.cvSurveyData.customerVoiceFormId=h.cvSurvey.customerVoiceFormId,r(s.cvSurveyData.customerVoiceFormId))?null:this.make(s)},t.make5Point=function(n,i){var r,u;return!n||!i?null:(r=new t.NpsSurveyData,r.baseData=n,r.ratingData=new o.RatingComponentData,r.ratingData.isZeroBased=!1,r.commentData=new f.CommentComponentData,r.promptData=new e.PromptComponentData,r.ratingData.question=i.loadStringResource(4),r.commentData.question=i.loadStringResource(21),r.promptData.title=i.loadStringResource(0),r.promptData.question=i.loadStringResource(1),r.promptData.yesButtonLabel=i.loadStringResource(2),r.promptData.noButtonLabel=i.loadStringResource(3),u=new Array(5),u[0]=i.loadStringResource(16),u[1]=i.loadStringResource(17),u[2]=i.loadStringResource(18),u[3]=i.loadStringResource(19),u[4]=i.loadStringResource(20),r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&u[0]&&u[1]&&u[2]&&u[3]&&u[4]?(r.ratingData.ratingValuesAscending=u,this.make(r)):null)},t.make11Point=function(n,i){var u,r;return!n||!i?null:(u=new t.NpsSurveyData,u.baseData=n,u.ratingData=new o.RatingComponentData,u.ratingData.isZeroBased=!0,u.commentData=new f.CommentComponentData,u.promptData=new e.PromptComponentData,u.ratingData.question=i.loadStringResource(4),u.commentData.question=i.loadStringResource(21),u.promptData.title=i.loadStringResource(0),u.promptData.question=i.loadStringResource(1),u.promptData.yesButtonLabel=i.loadStringResource(2),u.promptData.noButtonLabel=i.loadStringResource(3),r=new Array(11),r[0]=i.loadStringResource(5),r[1]=i.loadStringResource(6),r[2]=i.loadStringResource(7),r[3]=i.loadStringResource(8),r[4]=i.loadStringResource(9),r[5]=i.loadStringResource(10),r[6]=i.loadStringResource(11),r[7]=i.loadStringResource(12),r[8]=i.loadStringResource(13),r[9]=i.loadStringResource(14),r[10]=i.loadStringResource(15),u.ratingData.question&&u.commentData.question&&u.promptData.title&&u.promptData.question&&u.promptData.yesButtonLabel&&u.promptData.noButtonLabel&&r[0]&&r[1]&&r[2]&&r[3]&&r[4]&&r[5]&&r[6]&&r[7]&&r[8]&&r[9]&&r[10]?(u.ratingData.ratingValuesAscending=r,this.make(u)):null)},t.prototype.getType=function(){return l.Type.Nps},t.prototype.getSurveyInfo=function(){return this.surveyInfo},t.prototype.getCommentComponent=function(){return this.question},t.prototype.getPromptComponent=function(){return this.prompt},t.prototype.getRatingComponent=function(){return this.rating},t.prototype.getCVSurveyComponent=function(){return this.cvSurvey},t.prototype.getComponent=function(n){switch(n){case"Comment":return this.getCommentComponent();case"Prompt":return this.getPromptComponent();case"Rating":return this.getRatingComponent();case"CVSurvey":return this.getCVSurveyComponent();default:return null}},t.prototype.getDomElements=function(n){if(!n)throw new Error("Document must not be null");var t=n.createElement(l.DOM_NPS_TAGNAME);return this.getSurveyInfo().getDomElements(n).forEach(function(n){n&&t.appendChild(n)}),this.getCommentComponent().getDomElements(n).forEach(function(n){n&&t.appendChild(n)}),this.getRatingComponent().getDomElements(n).forEach(function(n){n&&t.appendChild(n)}),[t]},t.prototype.getJsonElements=function(){var t,n={};return n=h(this.getSurveyInfo().getJsonElements(),n),n=h(this.getCommentComponent().getJsonElements(),n),(n=h(this.getRatingComponent().getJsonElements(),n))[u.JSON_APPLICATION_KEYNAME]={},n[u.JSON_APPLICATION_KEYNAME][u.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[u.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t)),n},t.prototype.makeSurveyStrings=function(){var n={};return this.prompt&&(n[u.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(n[u.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(n[u.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),JSON.stringify(n)},t}(p.Survey);!function(n){var t=function(){};n.NpsSurveyData=t}(c||(c={}));n.exports=c},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FloodgateSettings=void 0;var i=function(){function n(){}return n.toJson=function(n){return JSON.stringify(n)},n.fromJson=function(n){return JSON.parse(n)},n}();t.FloodgateSettings=i},function(n){"use strict";var t=function(){function n(n){if(!n)throw new Error("trackingSet must not be null");if(n.getList().length>32)throw new Error("trackingSet list size must be less than 32");this.isOrdered=n.getIsOrdered();this.trackedActivities=n.getList();this.currentIndex=0;this.activationMask=0;this.currentActivationFlags=0;this.isActivationByInitPending=!1;this.currentCounts=new Array(this.trackedActivities.length);this.currentStartTimes=new Array(this.trackedActivities.length);this.currentSessionCounts=new Array(this.trackedActivities.length);for(var t=0;t<this.trackedActivities.length;t++)this.currentCounts[t]=0,this.currentSessionCounts[t]=0;for(t=0;t<this.trackedActivities.length;t++)this.activationMask|=1<<t,this.trackedActivities[t].getCount()<1&&this.trackedActivities[t].setCount(1)}return n.prototype.getCount=function(n){return this.isValidIndex(n)?this.currentCounts[n]:0},n.prototype.getSessionCount=function(n){return this.isValidIndex(n)?this.currentSessionCounts[n]:0},n.prototype.getStartTime=function(n){return this.isValidIndex(n)?this.currentStartTimes[n]:null},n.prototype.moveSessionCountIntoBaseCount=function(n){if(!this.isValidIndex(n))return 0;var t=this.currentSessionCounts[n];return this.currentSessionCounts[n]=0,t},n.prototype.initCounts=function(n,t,i){void 0===i&&(i=!1);for(var r=0;r<this.trackedActivities.length&&!(this.isOrdered&&r>this.currentIndex);r++)r<t.length&&t[r]&&(this.currentSessionCounts[r]=this.currentCounts[r]=t[r].tracker.getSessionCount(t[r].index),this.currentStartTimes[r]=t[r].tracker.getStartTime(t[r].index)),this.trackedActivities[r].getIsAggregate()&&r<n.length&&(this.currentCounts[r]+=n[r]),this.hasCountCrossedThreshold(r)&&this.finishActivityAtIndex(r);this.isActivated()&&!i&&(this.isActivationByInitPending=!0)},n.prototype.generateActivityIndexList=function(){for(var i,r=[],t=0;t<this.trackedActivities.length;t++)i=new n.ActivityIndex,i.activity=this.trackedActivities[t].getActivity(),i.index=t,r.push(i);return r},n.prototype.incrementActivity=function(n,t){if(!this.isValidIndex(n))return 0;if(t<0)throw new Error("increment must be non-negative");if(this.isOrdered&&n>this.currentIndex)return 0;var i=!this.hasCountCrossedThreshold(n);return this.currentCounts[n]+=t,this.currentSessionCounts[n]+=t,this.isActivationByInitPending?this.isPermittedIndexForActivationByInit(n)?this.commitActivation():0:i&&this.hasCountCrossedThreshold(n)?(this.finishActivityAtIndex(n),this.isActivated()?this.commitActivation():1):0},n.prototype.startTime=function(n,t){this.isValidIndex(n)&&(this.currentStartTimes[n]=t||new Date)},n.prototype.stopTime=function(n,t){var i,r;return this.isValidIndex(n)?(i=this.currentStartTimes[n],this.currentStartTimes[n]=null,!i)?0:i>(t=t||new Date)?0:(r=(t.getTime()-i.getTime())/1e3,r%1==0&&(r+=.001),r):0},n.prototype.isValidIndex=function(n){return n<this.trackedActivities.length},n.prototype.isActivated=function(){return(this.currentActivationFlags&this.activationMask)===this.activationMask},n.prototype.finishActivityAtIndex=function(n){if(!this.isValidIndex(n))throw new Error("Index is not valid");this.currentActivationFlags|=1<<n;n+1<this.trackedActivities.length&&(this.currentIndex=n+1)},n.prototype.hasCountCrossedThreshold=function(n){if(!this.isValidIndex(n))throw new Error("Index is not valid");return this.currentCounts[n]>=this.trackedActivities[n].getCount()},n.prototype.isPermittedIndexForActivationByInit=function(n){return!this.isOrdered||n+1===this.currentCounts.length},n.prototype.commitActivation=function(){return this.isActivationByInitPending=!1,2},n}();!function(n){var t=function(){};n.ActivityIndex=t}(t||(t={}));n.exports=t},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IndexedTracker=void 0;var i=function(){};t.IndexedTracker=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActivityTrackingContract=void 0;var i=function(n,t){this.surveyId=n;this.trackingSet=t};t.ActivityTrackingContract=i},function(n,t,i){"use strict";function r(n){var t=null==n?void 0:n.getMaxLaunches();return u.isNumber(t)&&t>1}function f(n){var t=null==n?void 0:n.getBusinessLevel();return!u.isNOU(t)&&t===e.ISurveyInfo.BusinessLevel.Critical}Object.defineProperty(t,"__esModule",{value:!0});t.hasSurveyReachedMaxLaunches=t.hasSurveyReachedMaxLaunchesPerSession=t.isCriticalSurvey=t.isBusinessCriticalSurvey=t.isMultiLaunchSurvey=void 0;var e=i(11),u=i(10);t.isMultiLaunchSurvey=r;t.isBusinessCriticalSurvey=f;t.isCriticalSurvey=function(n){return r(n)||f(n)};t.hasSurveyReachedMaxLaunchesPerSession=function(n,t){var i;return!r(n)||!u.isNumber(n.getMaxLaunchesPerSession())||(null!==(i=t[n.getId()])&&void 0!==i?i:0)>=n.getMaxLaunchesPerSession()};t.hasSurveyReachedMaxLaunches=function(n,t){return!r(n)||((null==t?void 0:t.SurveyLaunchCount)||0)>=n.getMaxLaunches()}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.validateUserFacts=t.deserializeUserFacts=void 0;var r=i(77);t.deserializeUserFacts=function(n){var t=[],i,u;for(i in n.UserFacts)n.UserFacts.hasOwnProperty(i)&&(u=n.UserFacts[i],u&&t.push(r.UserFact.deserialize(u)));return 0===t.length&&(t=null),t};t.validateUserFacts=function(n){if(n)for(var t in n)if(n.hasOwnProperty(t)&&!n[t])return!1;return!0}},function(n,t,i){"use strict";function e(n,t,i){switch(i){case 0:return t===n;case 1:return t!==n;case 2:return t>n;case 3:return t>=n;case 4:return t<n;case 5:return t<=n;case 6:return o(n,t);case 7:return!o(n,t);case 8:return o(t,n);case 9:return!o(t,n)}}function o(n,t){if("string"==typeof t){var i=t.toLowerCase();if("string"==typeof n)return-1!==n.toLowerCase().indexOf(i);if(l(n))return n.some(function(n){return n&&n.toString().toLowerCase()===i})}return!!l(n)&&-1!==n.indexOf(t)}function s(n,t,i,f){if(!c(n)){var e="User fact "+i+" has invalid value "+t;return f&&(e="Invalid value "+t+" was provided for user fact of type "+f),u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,e),!1}return!0}Object.defineProperty(t,"__esModule",{value:!0});t.UserFact=void 0;var r=i(16),u=i(20),h=i(10),f=h.isNOU,c=h.isNumber,l=h.isArray,a=[0,1,2,3,4,5],v=function(){function n(n){this.input=n}return n.deserialize=function(t){return this.validate(t)?new n(t):null},n.validate=function(n){if(!n)return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Input is null or undefined for user fact"),!1;if(!n.Value&&n.Values&&(n.Value=n.Values),f(n.Name)||f(n.Type)||f(n.Value))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Either of the required parameters Name: "+n.Name+", Type: "+n.Type+" or Value: "+n.Value+" are not provided for the user fact"),!1;if(!this.validateUserFactType(n.Type))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid UserFactType value "+n.Type+" is provided for user fact"),!1;if(6===n.Type)return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Unsupported UserFactType value "+n.Type+" is provided for user fact"),!1;if(n.LatencyType&&!this.validateLatencyType(n.LatencyType))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid LatencyType value "+n.LatencyType+" is provided for user fact of type "+n.Type),!1;if(n.LatencyType&&0!==n.LatencyType&&f(n.LatencyDurationInSeconds))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"LatencyDurationInSeconds value "+n.LatencyDurationInSeconds+" is not provided for user fact of type "+n.Type),!1;if(n.LatencyDurationInSeconds&&!c(n.LatencyDurationInSeconds))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Invalid LatencyDurationInSeconds value "+n.LatencyDurationInSeconds+" is provided for user fact of type "+n.Type),!1;if(1===n.Type&&f(n.IntervalType))return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,"Required parameter intervalType is not provided for user fact of type "+n.Type),!1;var t=this.getComparatorTypes(n.Type);return!(n.Comparator&&!function(n,t){return-1!==t.indexOf(n)}(n.Comparator,t))||(u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,"Unsupported comparator type for user fact of type "+n.Type),!1)},n.getComparatorTypes=function(n){switch(n){case 0:return[0,1];case 4:return[0,1,6,7,8,9];case 5:return[6,7,8,9];case 1:case 2:case 3:case 6:return a}return a},n.validateLatencyType=function(n){return 0===n||3===n||1===n||2===n},n.validateUserFactType=function(n){return 0===n||2===n||3===n||4===n||1===n||5===n||6===n},n.prototype.isAMatch=function(n){if(!n||!n.userFactValue||!this.isLatencyAcceptable(n))return!1;try{var t=this.getType();return 0===t?function(n,t,i){var r=JSON.parse(t.userFactValue.toLowerCase());return e(!!n,!!r,i)}(this.getValue(),n,this.getComparator()):2===t?function(n,t,i){var u=Date.parse(t.userFactValue),r;return s(u,t.userFactValue,t.userFactName)?(r=Date.parse(n),!s(r,n,null,2))?!1:e(r,u,i):!1}(this.getValue(),n,this.getComparator()):3===t?function(n,t,i){var r=parseInt(t.userFactValue,10);return s(r,t.userFactValue,t.userFactName)?e(n,r,i):!1}(this.getValue(),n,this.getComparator()):4===t?function(n,t,i){return e(n.toLowerCase(),t.userFactValue.toLowerCase(),i)}(this.getValue(),n,this.getComparator()):1===t?function(n,t,i,f){var h=Date.parse(t.userFactValue),c,o;return s(h,t.userFactValue,t.userFactName)?(c=Date.now(),o=0===f?c-h:h-c,o<0)?(u.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch,{ErrorMessage:"Interval type not acceptable - { Spec: "+n+', Name: "'+t.userFactName+'" }',TimeMilliseconds:o,Type:""+f}),!1):e(864e5*n,o,i):!1}(this.getValue(),n,this.getComparator(),this.getIntervalType()):5===t?function(n,t,i){return e(n,t.userFactValue,i)}(this.getValue(),n,this.getComparator()):(u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,"Unsupported type of user fact was provided "+t),!1)}catch(n){return u.FloodgateEngine.getTelemetryLogger().log_Error(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,n),!1}},n.prototype.getType=function(){return this.input.Type},n.prototype.getName=function(){return this.input.Name},n.prototype.getValue=function(){return this.input.Value},n.prototype.getComparator=function(){return this.input.Comparator||0},n.prototype.getLatencyType=function(){return this.input.LatencyType||0},n.prototype.getLatencyDurationInSeconds=function(){return this.input.LatencyDurationInSeconds},n.prototype.getIntervalType=function(){return this.input.IntervalType},n.prototype.isLatencyAcceptable=function(n){var t=this.getType();return!(!f(this.getLatencyDurationInSeconds())&&!function(n,t,i){var r,u;switch(n){case 1:r=i.sourceDateTime;break;case 2:r=i.storageDateTime;break;case 3:r=i.clientIngestionDateTime}return f(r)?!0:(u=Date.parse(r),Date.now()-u<=1e3*t)}(this.getLatencyType(),this.getLatencyDurationInSeconds(),n))||(u.FloodgateEngine.getTelemetryLogger().log_Event(r.TelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch,{ErrorMessage:'Latency duration not acceptable - { Name: "'+n.userFactName+'" }',TimeMilliseconds:this.getLatencyDurationInSeconds(),Type:""+t}),!1)},n}();t.UserFact=v},function(n){var t;t=function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.i=function(n){return n},t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=15)}([function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});i=function(){function n(n){this.low=0;this.high=0;this.low=parseInt(n,10);this.low<0&&(this.high=-1)}return n.prototype.Equals=function(t){var i=new n(t);return this.low===i.low&&this.high===i.high},n}();t.Int64=i;r=function(){function n(n){this.low=0;this.high=0;this.low=parseInt(n,10)}return n.prototype.Equals=function(t){var i=new n(t);return this.low===i.low&&this.high===i.high},n}();t.UInt64=r;u=function(){function n(){}return n.ToByte=function(n){return this.ToUInt8(n)},n.ToInt16=function(n){return 32767&n|(32768&n)<<16>>16},n.ToInt32=function(n){return 2147483647&n|2147483648&n},n.ToUInt8=function(n){return 255&n},n.ToUInt32=function(n){return 4294967295&n},n}();t.Number=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.NotSet=0]="NotSet";n[n.DistinguishedName=1]="DistinguishedName";n[n.GenericData=2]="GenericData";n[n.IPV4Address=3]="IPV4Address";n[n.IPv6Address=4]="IPv6Address";n[n.MailSubject=5]="MailSubject";n[n.PhoneNumber=6]="PhoneNumber";n[n.QueryString=7]="QueryString";n[n.SipAddress=8]="SipAddress";n[n.SmtpAddress=9]="SmtpAddress";n[n.Identity=10]="Identity";n[n.Uri=11]="Uri";n[n.Fqdn=12]="Fqdn";n[n.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={}))},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),f=i(1),u=i(3),e=function(){function n(){}return n.getPayloadBlob=function(n,t){var f=new r.IO.MemoryStream,i=new r.CompactBinaryProtocolWriter(f);return i.WriteFieldBegin(r.BondDataType.BT_MAP,3),i.WriteMapContainerBegin(t,r.BondDataType.BT_STRING,r.BondDataType.BT_LIST),Object.keys(n).forEach(function(t){var f,e;for(i.WriteString(t),f=n[t],i.WriteContainerBegin(1,r.BondDataType.BT_STRUCT),i.WriteFieldBegin(r.BondDataType.BT_STRING,2),i.WriteString("act_default_source"),i.WriteFieldBegin(r.BondDataType.BT_STRING,5),i.WriteString(u.newGuid()),i.WriteFieldBegin(r.BondDataType.BT_INT64,6),i.WriteInt64(u.numberToBondInt64(Date.now())),i.WriteFieldBegin(r.BondDataType.BT_LIST,8),i.WriteContainerBegin(f.length,r.BondDataType.BT_STRUCT),e=0;e<f.length;++e)i.WriteBlob(f[e]);i.WriteStructEnd(!1)}),i.WriteStructEnd(!1),f.GetBuffer()},n.getEventBlob=function(n){var o=new r.IO.MemoryStream,t=new r.CompactBinaryProtocolWriter(o),i,e;return t.WriteFieldBegin(r.BondDataType.BT_STRING,1),t.WriteString(n.id),t.WriteFieldBegin(r.BondDataType.BT_INT64,3),t.WriteInt64(u.numberToBondInt64(n.timestamp)),t.WriteFieldBegin(r.BondDataType.BT_STRING,5),t.WriteString(n.type),t.WriteFieldBegin(r.BondDataType.BT_STRING,6),t.WriteString(n.name),i=[],e=[],Object.keys(n.properties).forEach(function(t){n.properties[t].pii===f.AWTPiiKind.NotSet?i.push(t):e.push(t)}),i.length&&(t.WriteFieldBegin(r.BondDataType.BT_MAP,13),t.WriteMapContainerBegin(i.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRING),i.forEach(function(i){t.WriteString(i);t.WriteString(n.properties[i].value)})),e.length&&(t.WriteFieldBegin(r.BondDataType.BT_MAP,30),t.WriteMapContainerBegin(e.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRUCT),e.forEach(function(i){t.WriteString(i);t.WriteFieldBegin(r.BondDataType.BT_INT32,1);t.WriteInt32(1);t.WriteFieldBegin(r.BondDataType.BT_INT32,2);t.WriteInt32(n.properties[i].pii);t.WriteFieldBegin(r.BondDataType.BT_STRING,3);t.WriteString(n.properties[i].value);t.WriteStructEnd(!1)})),t.WriteStructEnd(!1),o.GetBuffer()},n.base64Encode=function(n){return r.Encoding.Base64.GetString(n)},n}();t.default=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=/[xy]/g;t.numberToBondInt64=function(n){var t=new r.Int64("0");return t.low=4294967295&n,t.high=Math.floor(n/4294967296),t};t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(u,function(n){var t=16*Math.random()|0;return("x"===n?t:3&t|8).toString(16)})};t.isPii=function(n){return!isNaN(n)&&null!==n&&n>=0&&n<=13}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Version="1.2.2";t.FullVersionString="AWT-Web-CJS-"+t.Version},function(n,t,i){"use strict";var r,u;Object.defineProperty(t,"__esModule",{value:!0});r=i(1);t.AWTPiiKind=r.AWTPiiKind;u=i(13);t.AWT=u.default;t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.BT_STOP=0]="BT_STOP";n[n.BT_STOP_BASE=1]="BT_STOP_BASE";n[n.BT_UINT8=3]="BT_UINT8";n[n.BT_UINT32=5]="BT_UINT32";n[n.BT_UINT64=6]="BT_UINT64";n[n.BT_STRING=9]="BT_STRING";n[n.BT_STRUCT=10]="BT_STRUCT";n[n.BT_LIST=11]="BT_LIST";n[n.BT_MAP=13]="BT_MAP";n[n.BT_INT32=16]="BT_INT32";n[n.BT_INT64=17]="BT_INT64";n[n.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(t.BondDataType||(t.BondDataType={}))},function(n,t,i){"use strict";var r,u,f,e,o,s;Object.defineProperty(t,"__esModule",{value:!0});r=i(0);u=function(){function n(){}return n.GetBytes=function(n){for(var t,i=[],r=0;r<n.length;++r)t=n.charCodeAt(r),t<128?i.push(t):t<2048?i.push(192|t>>6,128|63&t):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|63&t):(t=65536+((1023&t)<<10|1023&n.charCodeAt(++r)),i.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|63&t));return i},n}();t.Utf8=u;f=function(){function n(){}return n.GetString=function(n){for(var u,e,f,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],o=n.length%3,r=0,s=n.length-o;r<s;r+=3)u=(n[r]<<16)+(n[r+1]<<8)+n[r+2],i.push([t.charAt((f=u)>>18&63),t.charAt(f>>12&63),t.charAt(f>>6&63),t.charAt(63&f)].join(""));switch(o){case 1:u=n[n.length-1];i.push(t.charAt(u>>2));i.push(t.charAt(u<<4&63));i.push("==");break;case 2:e=(n[n.length-2]<<8)+n[n.length-1];i.push(t.charAt(e>>10));i.push(t.charAt(e>>4&63));i.push(t.charAt(e<<2&63));i.push("=")}return i.join("")},n}();t.Base64=f;e=function(){function n(){}return n.GetBytes=function(n){for(var t=[];4294967168&n;)t.push(127&n|128),n>>>=7;return t.push(127&n),t},n}();t.Varint=e;o=function(){function n(){}return n.GetBytes=function(n){for(var t=n.low,i=n.high,r=[];i||4294967168&t;)r.push(127&t|128),t=(127&i)<<25|t>>>7,i>>>=7;return r.push(127&t),r},n}();t.Varint64=o;s=function(){function n(){}return n.EncodeZigzag32=function(n){return(n=r.Number.ToInt32(n))<<1^n>>31},n.EncodeZigzag64=function(n){var f=n.low,e=n.high,i=e<<1|f>>>31,u=f<<1,t;return 2147483648&e&&(i=~i,u=~u),t=new r.UInt64("0"),t.low=u,t.high=i,t},n}();t.Zigzag=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(){this._buffer=[]}return n.prototype.WriteByte=function(n){this._buffer.push(r.Number.ToByte(n))},n.prototype.Write=function(n,t,i){for(;i--;)this.WriteByte(n[t++])},n.prototype.GetBuffer=function(){return this._buffer},n}();t.MemoryStream=u},function(n,t,i){"use strict";var f,r,e,u,o;Object.defineProperty(t,"__esModule",{value:!0});f=i(6);t.BondDataType=f.BondDataType;r=i(7);t.Encoding=r;e=i(8);t.IO=e;u=i(0);t.Int64=u.Int64;t.UInt64=u.UInt64;t.Number=u.Number;o=function(){function n(n){this._stream=n}return n.prototype.WriteBlob=function(n){this._stream.Write(n,0,n.length)},n.prototype.WriteContainerBegin=function(n,t){this.WriteUInt8(t);this.WriteUInt32(n)},n.prototype.WriteMapContainerBegin=function(n,t,i){this.WriteUInt8(t);this.WriteUInt8(i);this.WriteUInt32(n)},n.prototype.WriteFieldBegin=function(n,t){t<=5?this._stream.WriteByte(n|t<<5):t<=255?(this._stream.WriteByte(192|n),this._stream.WriteByte(t)):(this._stream.WriteByte(224|n),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},n.prototype.WriteInt32=function(n){n=r.Zigzag.EncodeZigzag32(n);this.WriteUInt32(n)},n.prototype.WriteInt64=function(n){this.WriteUInt64(r.Zigzag.EncodeZigzag64(n))},n.prototype.WriteString=function(n){if(""===n)this.WriteUInt32(0);else{var t=r.Utf8.GetBytes(n);this.WriteUInt32(t.length);this._stream.Write(t,0,t.length)}},n.prototype.WriteStructEnd=function(n){this.WriteUInt8(n?f.BondDataType.BT_STOP_BASE:f.BondDataType.BT_STOP)},n.prototype.WriteUInt32=function(n){var t=r.Varint.GetBytes(u.Number.ToUInt32(n));this._stream.Write(t,0,t.length)},n.prototype.WriteUInt64=function(n){var t=r.Varint64.GetBytes(n);this._stream.Write(t,0,t.length)},n.prototype.WriteUInt8=function(n){this._stream.WriteByte(u.Number.ToUInt8(n))},n}();t.CompactBinaryProtocolWriter=o},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){this._killedTokenDictionary={}}return n.prototype.setKillSwitchTenants=function(n,t){var u=this,i,r;if(n&&t)try{if(i=n.split(","),"this-request-only"===t)return i;r=1e3*parseInt(t,10);i.forEach(function(n){u._killedTokenDictionary[n]=Date.now()+r})}catch(n){return[]}return[]},n.prototype.isTenantKilled=function(n){return void 0!==this._killedTokenDictionary[n]&&this._killedTokenDictionary[n]>Date.now()||(delete this._killedTokenDictionary[n],!1)},n}();t.default=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),u=function(){function n(n,t){this._maxRequestSize=n;this._outboundQueue=t;this._currentBatch={};this._currentBatchSize=0}return n.prototype.addEventToBatch=function(n){var t=r.default.getEventBlob(n);t.length>this._maxRequestSize||(this._currentBatchSize+t.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[n.tenantToken]&&(this._currentBatch[n.tenantToken]=[]),this._currentBatch[n.tenantToken].push(t),this._currentBatchSize+=t.length))},n.prototype.flushBatch=function(){this._currentBatchSize>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},n}();t.default=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.shouldRetryForStatus=function(n){return!(n>=300&&n<500&&408!==n||501===n||505===n)},n.getMillisToBackoffForRetry=function(n){var t,i=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,n)*i,Math.min(t,12e4)},n}();t.default=i},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(1),r=i(14),u=i(3),o=i(4),e=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,s=/\./g,h=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,c=function(){function n(){}return n.initialize=function(n,t){if(void 0===t&&(t={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=n;this._overrideValuesFromConfig(t);r.default.initialize(this._config);this._isInitialized=!0},n.flush=function(n){this._isInitialized&&!this._isDestroyed&&r.default.flush(n)},n.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,r.default.flushAndTeardown())},n.setContext=function(n,t,i){void 0===i&&(i="allTkns");null!==(t=this._sanitizeProperty(n,t))&&(this._contextProperties[i]||(this._contextProperties[i]={}),this._contextProperties[i][n]=t)},n.logEvent=function(n){var i=this,t;if(this._isInitialized){if(!n.name||!n.properties)return;if(n.name=n.name.toLowerCase(),n.name.replace(s,"_"),t="",n.type?(n.type.toLowerCase(),t="custom."):n.type="custom",!e.test(n.name)||!e.test(n.type))return;if(n.type=t+n.type,isNaN(n.timestamp)&&(n.timestamp=(new Date).getTime()),n.tenantToken||(n.tenantToken=this._defaultTenantToken),n.id=u.newGuid(),Object.keys(n.properties).forEach(function(t){n.properties[t]=i._sanitizeProperty(t,n.properties[t]);null===n.properties[t]&&delete n.properties[t]}),this._addContextIfAbsent(n,n.tenantToken),this._addContextIfAbsent(n,"allTkns"),0===Object.keys(n.properties).length)return;this._setDefaultProperty(n,"EventInfo.InitId",this._getInitId(n.tenantToken));this._setDefaultProperty(n,"EventInfo.Sequence",this._getSequenceId(n.tenantToken));this._setDefaultProperty(n,"EventInfo.SdkVersion",o.FullVersionString);this._setDefaultProperty(n,"EventInfo.Name",n.name);this._setDefaultProperty(n,"EventInfo.Time",new Date(n.timestamp).toISOString());r.default.sendEvent(n)}},n._overrideValuesFromConfig=function(n){n.collectorUrl&&(this._config.collectorUrl=n.collectorUrl);n.sendingTimer>1e3&&(this._config.sendingTimer=n.sendingTimer)},n._getInitId=function(n){return void 0===this._initIdMap[n]&&(this._initIdMap[n]=u.newGuid()),this._initIdMap[n]},n._getSequenceId=function(n){return void 0===this._sequenceIdMap[n]&&(this._sequenceIdMap[n]=0),(++this._sequenceIdMap[n]).toString()},n._setDefaultProperty=function(n,t,i){n.properties[t]={value:i,pii:f.AWTPiiKind.NotSet}},n._addContextIfAbsent=function(n,t){if(this._contextProperties[t]){var i=this._contextProperties[t];Object.keys(i).forEach(function(t){n.properties[t]||(n.properties[t]=i[t])})}},n._sanitizeProperty=function(n,t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t}),h.test(n)&&null!=t&&null!==t.value&&void 0!==t.value&&""!==t.value?(void 0===t.pii&&(t.pii=f.AWTPiiKind.NotSet),t.value=t.value.toString(),u.isPii(t.pii)?t:null):null},n._isInitialized=!1,n._isDestroyed=!1,n._contextProperties={},n._sequenceIdMap={},n._initIdMap={},n._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},n}();t.default=c},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(11),r=i(2),u=i(12),e=i(10),o=i(4),s=function(){function n(){}return n.initialize=function(n){this._inboundQueues.push([]);this._recordBatcher=new f.default(2936012,this._outboundQueue);this._newEventsAllowed=!0;"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64");this._sendingTimer=n.sendingTimer;this._urlString=n.collectorUrl+this._urlString+"&x-apikey="},n.sendEvent=function(n){var t=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(n),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer)))},n.flushAndTeardown=function(){this._newEventsAllowed=!1;this._batchAndSendEvents(!0)},n.flush=function(n){this._inboundQueues.push([]);this._isCurrentlyFlushing?this._flushQueue.push(n):(this._isCurrentlyFlushing=!0,this._flush(n))},n._batchAndSendEvents=function(n){for(this._running=!0;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch();this._sendRequest(this._outboundQueue.pop(),0,n)},n._retryRequestIfNeeded=function(n,t,i,r,f){var o=this,e=!0;n&&void 0!==n.status&&(this._killSwitch.setKillSwitchTenants(n.getResponseHeader("kill-tokens"),n.getResponseHeader("kill-duration-seconds")).forEach(function(n){delete t[n];i--}),(!u.default.shouldRetryForStatus(n.status)||i<=0)&&(e=!1));e&&f<4?setTimeout(function(){return o._sendRequest(t,f+1,!1)},u.default.getMillisToBackoffForRetry(f)):this._handleRequestFinished(null)},n._sendRequest=function(n,t,i){var o=this,s;try{var u=new XMLHttpRequest,e=0,f="";(Object.keys(n).forEach(function(t){o._killSwitch.isTenantKilled(t)?delete n[t]:(f.length>0&&(f+=","),f+=t,e++)}),u.open("POST",this._urlString+f,!i),i||(u.ontimeout=function(){o._retryRequestIfNeeded(u,n,e,f,t)},u.onerror=function(){o._retryRequestIfNeeded(u,n,e,f,t)},u.onload=function(){o._handleRequestFinished(u)}),e>0)?(s=r.default.getPayloadBlob(n,e),"undefined"==typeof Uint8Array?u.send(r.default.base64Encode(s)):u.send(new Uint8Array(s))):i&&this._handleRequestFinished(null)}catch(n){this._handleRequestFinished(null)}},n._handleRequestFinished=function(n){var t=this;n&&this._killSwitch.setKillSwitchTenants(n.getResponseHeader("kill-tokens"),n.getResponseHeader("kill-duration-seconds"));this._inboundQueues[0].length>0?this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},n._flush=function(n){var t=this;this._running||(this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1));this._checkPrimaryInboundQueueEmpty(function(){t._inboundQueues.shift();null!=n&&n();t._flushQueue.length>0?setTimeout(function(){return t._flush(t._flushQueue.shift())},t._sendingTimer):(t._isCurrentlyFlushing=!1,t._inboundQueues[0].length>0&&(t._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},t._sendingTimer)))})},n._checkPrimaryInboundQueueEmpty=function(n){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(n):setTimeout(function(){return t._checkPrimaryInboundQueueEmpty(n)},250)},n._checkOutboundQueueEmptyAndSent=function(n){var t=this;this._running?setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(n)},250):n()},n._outboundQueue=[],n._inboundQueues=[],n._newEventsAllowed=!1,n._killSwitch=new e.default,n._isCurrentlyFlushing=!1,n._flushQueue=[],n._running=!1,n._timeout=-1,n._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+o.FullVersionString,n}();t.default=s},function(n,t,i){n.exports=i(5)}])};n.exports=t()},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnnotationState=void 0,function(n){n[n.Undefined=0]="Undefined";n[n.Created=10]="Created";n[n.Sent=20]="Sent";n[n.Duplicated=30]="Duplicated";n[n.Seen=40]="Seen";n[n.Tried=50]="Tried";n[n.Kept=60]="Kept";n[n.Rejected=70]="Rejected"}(t.AnnotationState||(t.AnnotationState={}))},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemChanges=t.ItemOperation=void 0,function(n){n[n.None=0]="None";n[n.Added=1]="Added";n[n.Updated=2]="Updated";n[n.Deleted=3]="Deleted"}(t.ItemOperation||(t.ItemOperation={})),function(n){n[n.ContentChanged=0]="ContentChanged";n[n.ContentWasEmpty=1]="ContentWasEmpty";n[n.FormattingChanged=2]="FormattingChanged"}(t.ItemChanges||(t.ItemChanges={}))},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GridConstants=t.OpenType=t.BlobRefType=void 0,function(n){n[n.None=0]="None";n[n.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";n[n.AlCodedLocation=2]="AlCodedLocation"}(t.BlobRefType||(t.BlobRefType={})),function(n){n[n.NewDocument=0]="NewDocument";n[n.EditDocument=1]="EditDocument";n[n.ViewOnlyDocument=2]="ViewOnlyDocument"}(t.OpenType||(t.OpenType={}));var i=function(){function n(){}return n.lowerIndexBound=1,n.maxNumberOfRows=1048576,n.maxNumberOfColumns=16384,n.firstColumnName="A",n.lastColumnName="XFD",n}();t.GridConstants=i},function(n,t,i){"use strict";var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.BinaryClassificationAnnotation=t.Annotation=void 0;r=i(29);u=function(){function n(t){r.SchemaObject.assign(n,this,t)}return Object.defineProperty(n.prototype,"metadata",{get:function(){return this.M_},set:function(n){this.M_=n},enumerable:!1,configurable:!0}),n.getTypeName=function(){return"AugLoop_Core_Annotation"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Annotation=u;f=function(){function n(t){r.SchemaObject.assign(n,this,t)}return Object.defineProperty(n.prototype,"metadata",{get:function(){return this.M_},set:function(n){this.M_=n},enumerable:!1,configurable:!0}),n.getTypeName=function(){return"AugLoop_Core_BinaryClassificationAnnotation"},n.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.BinaryClassificationAnnotation=f},function(n,t,i){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k;Object.defineProperty(t,"__esModule",{value:!0});t.SignalOperation=t.MicroSyncOperation=t.DeltaUpdateOperation=t.VisibilityOperation=t.FocusOperation=t.PurgeOperation=t.DeleteOperation=t.UpdateOperation=t.UpdateAnnotationMetaDataOperation=t.MoveOperation=t.AddOperation=t.OperationWithSiblingContext=t.Operation=t.ItemChangesDelta=t.ItemDelta=void 0;r=i(29);u=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_ItemDelta"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.ItemDelta=u;f=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_ItemChangesDelta"},n.getBaseTypes=function(){return["AugLoop_Core_ItemDelta"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.ItemChangesDelta=f;e=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_Operation"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Operation=e;o=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_OperationWithSiblingContext"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.OperationWithSiblingContext=o;s=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_AddOperation"},n.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.AddOperation=s;h=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_MoveOperation"},n.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.MoveOperation=h;c=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.UpdateAnnotationMetaDataOperation=c;l=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_UpdateOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.UpdateOperation=l;a=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_DeleteOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.DeleteOperation=a;v=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_PurgeOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.PurgeOperation=v;y=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_FocusOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.FocusOperation=y;p=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_VisibilityOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.VisibilityOperation=p;w=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_DeltaUpdateOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.DeltaUpdateOperation=w;b=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_MicroSyncOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.MicroSyncOperation=b;k=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Signals_SignalOperation"},n.getBaseTypes=function(){return["AugLoop_Core_Operation"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.SignalOperation=k},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Signal=void 0;var r=i(29),u=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Signals_Signal"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Signal=u},function(n,t,i){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p;Object.defineProperty(t,"__esModule",{value:!0});t.TenantContextHolder=t.UserContextHolder=t.ContextHolder=t.DynamicContext=t.GridNeighborhoodContext=t.GridCell=t.SubDocument=t.Document=t.Session=t.TileGroup=t.Binary=t.Blob=void 0;r=i(29);u=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_Blob"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Blob=u;f=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_Binary"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Binary=f;e=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_TileGroup"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.TileGroup=e;o=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_Session"},n.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Session=o;s=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_Document"},n.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.Document=s;h=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_SubDocument"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.SubDocument=h;c=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_GridCell"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.GridCell=c;l=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_GridNeighborhoodContext"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.GridNeighborhoodContext=l;a=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_DynamicContext"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.DynamicContext=a;v=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_ContextHolder"},n.getBaseTypes=function(){return[]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.ContextHolder=v;y=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_UserContextHolder"},n.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.UserContextHolder=y;p=function(){function n(t){r.SchemaObject.assign(n,this,t)}return n.getTypeName=function(){return"AugLoop_Core_TenantContextHolder"},n.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]},n.typeGuard=function(t){return r.SchemaObject.matchesTypesFor(t,[n.getTypeName()])},n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()},n}();t.TenantContextHolder=p},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(n,t,i){"use strict";function u(n){return null==n}function h(n,t,i,c,v,y,p){function g(n){n?o.length&&e.unshift(""+o.pop()):e.length&&o.push(""+e.shift());b&&(b.style.minWidth=o.length?""+o.slice(-1):"590px")}var d,w=null==p?void 0:p.data,b=document.getElementById(v),tt,k,it,nt;if(!u(w)){if("string"==typeof w&&w.includes("ResponsePageHeight")){if(tt=w.split(":"),k=document.getElementById(r.IFRAME_ID),k&&k.style)return void(k.style.height=tt[2]+"px");c({EventId:r.IFRAME_ID,CustomProperties:{Message:"IFrame element undefined or null"}})}if("ResponsePageLoaded"===w.Type)return it={responseEventType:"ResponsePageLoaded",dateTime:new Date,hasSurveyPromptShown:w.FormTitle.includes("prompt")},!(null==w?void 0:w.Message)&&function(n){if(!u(n)){var t=n.split(",").slice(1).map(function(n){return(""+n).split("=")[1]});e.push.apply(e,t)}}(w.FormTitle),g(),t(it),null==b||b.blur(),void(!1!==y&&l(f,v,n,i,t,c));if("FormResponseCanceled"===w.Type)return nt={dateTime:new Date,responseEventType:"FormResponseCanceled"},c({EventId:r.GATECRASH_ON_SURVEY_CANCEL,CustomProperties:{Message:"gatecrash: survey cancel triggered: "+nt.responseEventType}}),void s(v,n,t,i,c,nt);if("FormResponseBack"===w.Type&&g(!0),"FormResponseSubmitted"===w.Type||"FormPartialResponseSubmitted"===w.Type){g();c({EventId:r.GATECRASH_ON_SURVEY_DATA_SUBMIT,CustomProperties:{Message:"gatecrash: onSubmitCallback has been triggered for type:  + "+w.Type}});try{i({pageInfo:a(w.Message),responseType:w.Type,formTitle:w.FormTitle})}catch(f){c({EventId:r.GATECRASH_ON_SURVEY_DATA_SUBMIT,CustomProperties:{Message:"gatecrash: Error: "+f}});window.removeEventListener("message",h.bind(null,n,t,i,c,v))}finally{"FormResponseSubmitted"===w.Type&&((null===(d=null==w?void 0:w.FormTitle)||void 0===d?void 0:d.includes("prompt"))?s(v,n,t,i,c,{dateTime:new Date,responseEventType:"FormAutoDismissed"}):(f=!1,!1!==y&&l(f,v,n,i,t,c,!0)))}}}}function s(n,t,i,e,o,c){var l,a;n=null!=n?n:"";l=document.getElementById(n),(function(n,t,i){var f=document.getElementById(r.CLOSE_BUTTON_ID);f&&!u(n)&&(f.removeEventListener("mouseenter",function(){f.style.backgroundColor="lightgray"}),f.removeEventListener("mouseleave",function(){f.style.background="none"}),f.removeEventListener("click",function(){s(n,t)}),i())}(n,t,function(){i&&e&&o&&window.removeEventListener("message",h.bind(null,t,i,e,o,n))}),null==l||l.remove(),f=!1,t)&&(c?t(c):(a={dateTime:new Date,responseEventType:"FormClosed"},t(a)))}function c(n,t,i,u,f){var o=!1,e;try{new y.SurveyEmbed(null==t?void 0:t.customerVoiceFormId,r.DEFAULT_BASE_URL).renderInline(n,t,u,f);o=!0}catch(n){e=n.message;throw i({EventId:r.GATECRASH_RENDER_ERROR,CustomProperties:{ErrorMessage:null!=e?e:"gatecrash: Error thrown and could not be cast as type Error."}}),n;}return o}function l(n,t,i,u,f,e,o){if(!n){var c={dateTime:new Date,responseEventType:"FormAutoDismissed"},l=setTimeout(function(){s(t,i,f,u,e,c)},o?5e3:2e4),h=document.getElementById(r.IFRAME_ID);h&&h.addEventListener("mouseover",function(){clearTimeout(l);n=!0},{once:!0})}}function a(n){var i,t,r,f;if(u(n))throw new Error("Error: Submit messages are null/undefined or length of 0");for(i=[],t=0;t<n.length;t++)r=v(n[t].questionAnswers),f={pageType:n[t].PageType,questionAnswers:r},i.push(f);return i}function v(n){var r,i,t,f;if(u(n))throw new Error("Error: current message is null/undefined or length of 0");for(r=[],i=0;i<n.length;i++)t=n[i],u(t.subtitle)||(f={questionType:t.subtitle,questionId:t.questionId,questionValue:t.title,answerValue:t.answer},r.push(f));return r}Object.defineProperty(t,"__esModule",{value:!0});t.getQuestionList=t.getPageInfo=t.renderSurvey=t.renderCVSurvey=void 0;var y=i(90),r=i(49),f=!1,e=[],o=[];t.renderCVSurvey=function(n,t,i,f,e,o,l,a){var v=document.getElementById(n),y;if(v){!function(n,t,i,r,u,f){window.addEventListener("message",h.bind(null,i,r,t,u,n,f))}(n,t,i,f,e,null==a?void 0:a.timeOutEnabled);try{c(n,o,e,l,null==a?void 0:a.cancelButtonEnabled),function(n){n.style.padding="0px";n.style.paddingRight="10px";n.style.paddingLeft="10px"}(v);!1!==(null==a?void 0:a.closeButtonEnabled)&&function(n,t,i,f,e,o){if(!u(n)&&!u(t)){var c=document.createElement("div"),h=document.createElement("button");h.id=r.CLOSE_BUTTON_ID;c.id=r.SURVEY_DIV_ID;h.textContent="X";c.appendChild(h);n.insertBefore(c,n.childNodes[0]);n.style.padding="0px";n.style.paddingRight="10px";n.style.paddingLeft="10px";h.setAttribute("style","float: right; background: none; border: 0px;\n    padding: 3px; margin-top: 5px; font-size: large; font-weigth: bolder"),function(n,t,i,r,u,f){n.addEventListener("mouseenter",function(){n.style.backgroundColor="lightgray"});n.addEventListener("mouseleave",function(){n.style.background="none"});n.addEventListener("click",function(){s(f,t,i,r,u)})}(h,i,f,e,o,t)}}(v,n,i,f,t,e)}catch(n){y=n.message;e({EventId:r.GATECRASH_RENDER_ERROR,CustomProperties:{ErrorMessage:null!=y?y:"gatecrash: Error thrown and could not be cast as type Error."}})}}else e({EventId:r.GATECRASH_RENDER_ERROR,CustomProperties:{Message:"Parent element with id "+n+" not found."}})};t.renderSurvey=c;t.getPageInfo=a;t.getQuestionList=v},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SurveyEmbed=void 0;var r=i(49),u=function(){function n(n,t){if(this._formId=n,!this._formId)throw new Error("form_id should be provided.");this._baseUrl=t||r.DEFAULT_BASE_URL;this._compact="false"}return n.prototype.renderInline=function(n,t,i,u){var e,f;if(!n)throw new Error("parent_element_id should be provided");if(e=document.getElementById(n),!e)throw new Error("Parent element with id '"+n+"' not found.");f=document.createElement("iframe");f.src=this.generateUrl(t,i,u);f.id=r.IFRAME_ID;f.width="100%";f.height="100%";f.style.border="none";e.textContent="";e.appendChild(f)},n.prototype.generateUrl=function(n,t,i){var r,u,f;if(null==n)throw new Error("user_context is requred");if(r=this._baseUrl+"Pages/ResponsePage.aspx?",u=!1!==i?"true":"false",r+=this._getQueryStringParameter("id",this._formId),r+="&"+this._getQueryStringParameter("embed","true"),this._compact&&(r+="&"+this._getQueryStringParameter("compact",this._compact)),f=JSON.stringify(n),f&&(r+="&"+this._getQueryStringParameter("ctx",f)),!n||!Object.prototype.hasOwnProperty.call(n,"locale"))throw new Error("locale should be provided");return r+="&lang="+n.locale,r+("&datawithevent=true&showcancel="+u+"&embed=true&oembedocv="+u+"&themecolor="+(t&&t.appPrimaryColor?t.appPrimaryColor:"")+"&autosubmit=true&autonavigate=true&disableresponsive=true&hostappdomain="+window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+"/")},n.prototype._getQueryStringParameter=function(n,t){return encodeURIComponent(n)+"="+encodeURIComponent(t)},n}();t.SurveyEmbed=u},function(n,t,i){"use strict";function lt(n){if("string"!=typeof n&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||""===n)throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function si(n){return"string"!=typeof n&&(n=String(n)),n}function hi(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return rr&&(t[Symbol.iterator]=function(){return t}),t}function h(n){this.map={};n instanceof h?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function ci(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function or(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function tf(n){var t=new FileReader,i=or(t);return t.readAsArrayBuffer(n),i}function sr(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function hr(){return this.bodyUsed=!1,this._initBody=function(n){var t;this.bodyUsed=this.bodyUsed;this._bodyInit=n;n?"string"==typeof n?this._bodyText=n:dt&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:ur&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:ir&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():gt&&dt&&(t=n)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=sr(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):gt&&(ArrayBuffer.prototype.isPrototypeOf(n)||er(n))?this._bodyArrayBuffer=sr(n):this._bodyText=n=Object.prototype.toString.call(n):this._bodyText="";this.headers.get("content-type")||("string"==typeof n?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):ir&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},dt&&(this.blob=function(){var n=ci(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=ci(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(tf)}),this.text=function(){var t,n,i,r=ci(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=new FileReader,i=or(n),n.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},ur&&(this.formData=function(){return this.text().then(rf)}),this.json=function(){return this.text().then(JSON.parse)},this}function tt(n,t){var r,u,i,f;if(!(this instanceof tt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(i=(t=t||{}).body,n instanceof tt){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;t.headers||(this.headers=new h(n.headers));this.method=n.method;this.mode=n.mode;this.signal=n.signal;i||null==n._bodyInit||(i=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(r=t.method||this.method||"GET",u=r.toUpperCase(),cr.indexOf(u)>-1?u:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");(this._initBody(i),"GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)||(f=/([?&])_=[^&]*/,f.test(this.url)?this.url=this.url.replace(f,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime())}function rf(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function b(n,t){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={});this.type="default";this.status=void 0===t.status?200:t.status;this.ok=this.status>=200&&this.status<300;this.statusText=void 0===t.statusText?"":""+t.statusText;this.headers=new h(t.headers);this.url=t.url||"";this._initBody(n)}function ar(n,t){return new Promise(function(i,r){function e(){u.abort()}var f=new tt(n,t),u;if(f.signal&&f.signal.aborted)return r(new it("Aborted","AbortError"));u=new XMLHttpRequest;u.onload=function(){var r,n,t={status:u.status,statusText:u.statusText,headers:(r=u.getAllResponseHeaders()||"",n=new h,r.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(n){return 0===n.indexOf("\n")?n.substr(1,n.length):n}).forEach(function(t){var i=t.split(":"),r=i.shift().trim(),u;r&&(u=i.join(":").trim(),n.append(r,u))}),n)},f;t.url="responseURL"in u?u.responseURL:t.headers.get("X-Request-URL");f="response"in u?u.response:u.responseText;setTimeout(function(){i(new b(f,t))},0)};u.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)};u.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)};u.onabort=function(){setTimeout(function(){r(new it("Aborted","AbortError"))},0)};u.open(f.method,function(n){try{return""===n&&c.location.href?c.location.href:n}catch(t){return n}}(f.url),!0);"include"===f.credentials?u.withCredentials=!0:"omit"===f.credentials&&(u.withCredentials=!1);"responseType"in u&&(dt?u.responseType="blob":gt&&f.headers.get("Content-Type")&&-1!==f.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer"));!t||"object"!=typeof t.headers||t.headers instanceof h?f.headers.forEach(function(n,t){u.setRequestHeader(t,n)}):Object.getOwnPropertyNames(t.headers).forEach(function(n){u.setRequestHeader(n,si(t.headers[n]))});f.signal&&(f.signal.addEventListener("abort",e),u.onreadystatechange=function(){4===u.readyState&&f.signal.removeEventListener("abort",e)});u.send(void 0===f._bodyInit?null:f._bodyInit)})}function yr(n,t){var r,u,i;void 0===t&&(t=!0);r="";for(u in n||[])n.hasOwnProperty(u)&&(i=n[u],null!=i&&"object"!=typeof i&&(r+=(r?"&":"")+(u+"="+(t?encodeURIComponent(i):i))));return r}function li(n){return new Promise(function(t){setTimeout(t,n)})}function ni(n,t){var i=n&&n[t];if(i||Object.getOwnPropertyDescriptor(n,t))return i}function of(n,t){if(!n)return Promise.resolve(null);var i=ni(n,t);return i?Promise.resolve(i):new Promise(function(i){var r;Object.defineProperty(n,t,{configurable:!0,enumerable:!0,get:function(){return r},set:function(n){i(r=n)}})})}function pr(n,t,i,r){return void 0===r&&(r=100),Object(e.b)(this,void 0,void 0,function(){var u;return Object(e.d)(this,function(f){switch(f.label){case 0:return(u=ni(n,t))||0===i?[2,u]:[4,li(r)];case 1:return f.sent(),[2,pr(n,t,i-1,r)]}})})}function sf(n,t){return new Promise(function(i){n.activateAnnotation(t,{callback:function(n){try{var r=(n&&n.items?n.items:[]).filter(function(n){return t===ef.SchemaObject.getTypeNameFor(n.body)});i(r&&r[0]&&r[0].body)}catch(n){i({error:n})}}})})}function hf(n){return void 0===n&&(n=100),Object(e.b)(this,void 0,void 0,function(){var t,i,r;return Object(e.d)(this,function(u){switch(u.label){case 0:return(t=ni(window,"augLoop"))?[3,7]:(i=Object(s.a)("TulipsAugLoopPackageDelayLoad",-1))>0?[4,li(i)]:[3,2];case 1:return u.sent(),t=ni(window,"augLoop"),[3,7];case 2:return r=Object(s.a)("TulipsAugLoopLoadRetryTimes",5),[4,pr(window,"augLoop",r,n)];case 3:return(t=u.sent())?[3,5]:[4,of(window,"augLoop")];case 4:t=u.sent();u.label=5;case 5:return n>0?[4,li(n)]:[3,7];case 6:u.sent();u.label=7;case 7:return[2,t]}})})}function cf(n,t,i){return void 0===i&&(i=100),Object(e.b)(this,void 0,void 0,function(){var r,u,f;return Object(e.d)(this,function(e){switch(e.label){case 0:return(u=t)?[4,t()]:[3,2];case 1:u=e.sent();e.label=2;case 2:return(r=u)?[3,5]:[4,hf(i)];case 3:if(!e.sent())throw new Error("Unable to get AL runtime");if(!(f=window.augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().getSession()))throw new Error("Unable to get AL session promise");return[4,f];case 4:if(!(r=e.sent()))throw new Error("Unable to get AL session");e.label=5;case 5:return[2,sf(r,n)]}})})}function at(){return ai||(ai=new vf),ai}function wr(){var i,r,f,e,n,o,t,h,c,l;ti||(ti=nf.a((n=u.get().getCommonInitOptions(),o=(null===(i=n.telemetryGroup)||void 0===i?void 0:i.audienceGroup)||(null===(r=n.telemetryGroup)||void 0===r?void 0:r.audience),t=o&&-1!==["dogfood","edog","int","microsoft"].indexOf(o.toLowerCase()),h=t?null===(f=n.webSurfacesSettings)||void 0===f?void 0:f.webSurfacesIntUrl:null===(e=n.webSurfacesSettings)||void 0===e?void 0:e.webSurfacesProdUrl,c=t?d.a.WebSurfacesIntLink:d.a.WebSurfacesProdLink,l=t?"WebSurfacesIntLink":"WebSurfacesProdLink",h||Object(s.a)(l,c)),null))}function ie(){try{var n=document&&(document.documentElement||document.getElementsByTagName("body")[0]);return{pageWidth:(null===window||void 0===window?void 0:window.innerWidth)||(null==n?void 0:n.clientWidth),pageHeight:(null===window||void 0===window?void 0:window.innerHeight)||(null==n?void 0:n.clientHeight),pageTop:(null===window||void 0===window?void 0:window.pageYOffset)||(null==n?void 0:n.scrollTop),pageLeft:(null===window||void 0===window?void 0:window.pageXOffset)||(null==n?void 0:n.scrollLeft),screenWidth:screen?screen.width:0,screenHeight:screen?screen.height:0,colorDepth:screen?screen.colorDepth:0,userAgent:null===navigator||void 0===navigator?void 0:navigator.userAgent}}catch(n){return null}}function pi(n,t){var i,u,r;return n?(i=n[t],i||(u=t.toLowerCase(),i=n[Object.keys(n).find(function(n){return n.toLowerCase()===u})]),o.Utils.isNOU(i))?null:!o.Utils.isArray(i)&&(o.Utils.isObject(i)||o.Utils.isFunction(i))?null:(r=(new Date).toISOString(),{userFactType:"Local",userFactName:t,userFactValue:i.toString(),sourceDateTime:r,storageDateTime:r,clientIngestionDateTime:r}):null}function re(n){var t,i;try{return vi||(t=u.get().getCommonInitOptions(),vi=[t,null==t?void 0:t.applicationSettings,null==t?void 0:t.telemetryGroup,null==t?void 0:t.applicationGroup,null==t?void 0:t.webGroup,u.get().getFloodgateInitOptions(),u.get(),ie(),{userConsentGroup:u.get().getUserConsentGroup(),feedbackEnabledByAADC:u.get().isFeedbackSurveyEnabledByAADC()}]),i=vi.reduce(function(t,i){return t||pi(i,n)},null),i||(i=function(n){var t=n&&n.split("__"),u;if(!t||t.length<=1)return null;var i=null,f=t[0],r=t.pop();return(r&&1===t.length&&(i=pi(window[f]||window,r)),!i&&r&&t.length>1)&&("window"===f&&t.shift(),u=t.reduce(function(n,t){return n&&n[t]},window),u&&(i=pi(u,r))),i&&(i.userFactName=n),i}(n)),i}catch(t){return f.b().logEvent(f.a.UserFacts.LocalFact.Error.VALUE,2,{ErrorMessage:"Error getting local fact - "+n+" "+(t&&t.message?": "+t.message:"")+" "}),null}}function p(){return oe}function iu(){return tu}function nt(n){pt=n}function he(){return pt}function ru(n,t){if(void 0===t&&(t=null),pt)return pt;st++;var i=new Promise(function(i,r){var e=function(n,t){var i=o.FloodgateEngine.getTelemetryLogger();i&&i.log_Event(ii.TelemetryEvent.Floodgate.Start.Failed,{Count:st,ErrorMessage:n,ErrorDetails:t&&t.stack});r(n)},h,f,c,a,v,l;try{if(h=u.get().getCommonInitOptions(),!h)return void e("Invalid floodgate common init options, state: "+yt);if(f=u.get().getFloodgateInitOptions(),f||(c=o.FloodgateEngine.getTelemetryLogger(),c&&c.log_Event(ii.TelemetryEvent.Floodgate.Start.Warning,{Count:st,ErrorMessage:"Invalid floodgate init options, state: "+yt}),u.get().setFloodgateInitOptions({}),f=u.get().getFloodgateInitOptions()),t||ri||f&&f.authTokenCallback&&(ri=new te,wi=new ue),a=gr.Governor.GetChannelCoolDown(vt.GovernedChannelType.TeachingMessage),v=Object(s.a)("TeachingMessageCooldown",a),gr.Governor.SetDefaultChannelCoolDown(vt.GovernedChannelType.TeachingMessage,v),!(ft=t||o.FloodgateEngine.make(h.build||"",kf.make(),f.onSurveyActivatedCallback,new et.a,f.settingStorageCallback,se||new ne,new gf,new df,[ri],wi,iu())))return nt(null),void e("Failed to create floodgate engine");if(n||st>1)ft.start(),i();else{if(l=ft.startAsync(),!l)return nt(null),void e("Failed to get floodgate engine");l.then(function(){i()}).catch(function(n){nt(null);e("Failed to start floodgate engine",n)})}}catch(n){nt(null);e("Failed to load floodgate engine: "+(n&&n.toString()),n)}});return nt(i),i.catch(function(){nt(null)}),i}function uu(n){return void 0===n&&(n=!1),ru(n)}function fu(){ft&&ft.stop();nt(null)}function eu(){st=0;pt=null;ft=null;ri=null;wi=null}function bt(n){!function(){for(var t,n=0,i=fi;n<i.length;n++)t=i[n],w.m(t.id,t.event,t.listener);fi=[]}();ou(n)}function kt(n,t,i){w.g(n,t,i);fi.push({event:t,id:n,listener:i})}function g(n,t,i,r,e,o){var s=u.get();f.b().logEvent(n,1,{CampaignId:s.getFloodgateSurvey().getCampaignId(),SurveyId:s.getFloodgateSurvey().getId(),SurveyType:s.getFloodgateSurvey().getSurveyType(),PromptAutoDismiss:s.getFloodgateInitOptions().autoDismiss.toString(),ClientFeedbackId:t,IsEmailPolicyEnabled:i,PersonalizerUserAction:r,PersonalizerEventId:e,ActualSetAutoDismissValue:o})}function cu(){var n=document.getElementById(r.d.TFormEmailCheckBox),t;n&&(t=document.getElementById(r.d.TFormEmailTextBox),t.value=n.checked?u.get().getCommonInitOptions().userEmail:null,t.disabled=!n.checked)}function le(n){n.keyCode===r.e.Esc&&(n.preventDefault(),n.stopPropagation(),bt(!1),lu(),au())}function ae(n){n.preventDefault();n.stopPropagation();bt(!1);lu();au()}function lu(){if(wt&&bi())return p().logUserActionForSurveyAsync(0,u.get().getFloodgateSurvey().getId(),u.get().getFloodgateSurvey().getCampaignId()),void g(f.a.SURVEY_UI_PROMPT_USERCLOSED,void 0,void 0,0,p().getEventIdForSurveyId(u.get().getFloodgateSurvey().getId()),ht);g(wt?f.a.SURVEY_UI_PROMPT_USERCLOSED:f.a.SURVEY_UI_FORM_USERCLOSED,void 0,void 0,void 0,void 0,ht)}function au(){ui&&(clearTimeout(ui),ui=0)}function ve(n){var i,t,r;n.preventDefault();n.stopPropagation();u.get().getFloodgateSurvey().getSurveyType()===l.ISurvey.Type.Intercept?(i=u.get().getFloodgateSurvey().getInterceptUrl(),t=window.open(i,"_blank"),r=!hu(t)&&(t.focus(),!0),bt(!1),g(r?f.a.SURVEY_UI_PROMPT_CLICKED:f.a.SURVEY_UI_REDIRECTIONFAILURE)):vu()}function vu(){wt=!1;w.l(r.d.TPromptContainer,!1);w.l(r.d.TFormContainer,!0);w.b(r.d.ToastContainer,r.c.ToastZoom);(" "+document.getElementById(r.d.TFormContainer).className+" ").indexOf(" "+r.c.Visible+" ")>-1&&document.getElementById(r.d.ToastContainer).setAttribute("role","");var n=document.getElementsByName(r.d.TFormRating);n&&n.length>0&&n[0].focus();bi()?(p().logUserActionForSurveyAsync(2,u.get().getFloodgateSurvey().getId(),u.get().getFloodgateSurvey().getCampaignId()),g(f.a.SURVEY_UI_FORM_SHOWN,void 0,void 0,2,p().getEventIdForSurveyId(u.get().getFloodgateSurvey().getId()),ht)):g(f.a.SURVEY_UI_FORM_SHOWN,void 0,void 0,void 0,void 0,ht)}function ye(){document.getElementById(r.d.TFormSubmitButton).disabled=!1}function pe(n){var e,o;n.preventDefault();n.stopPropagation();w.l(r.d.TFormSubmitButton,!1);var s=new ce.a(r.d.TFormSubmitButtonSpinner),t=new yi.a(u.get().getCommonInitOptions().environment,l.ISurvey.Type[u.get().getFloodgateSurvey().getSurveyType()],u.get().getCommonInitOptions().appId,"Survey",u.get().getCommonInitOptions().applicationGroup,u.get().getCommonInitOptions().telemetryGroup,u.get().getCommonInitOptions().webGroup),i=document.getElementById(r.d.TFormComment),h=i&&!!i.value,c=document.querySelector('input[name="'+r.d.TFormRating+'"]:checked');u.get().getFloodgateSurvey().setValues(Number(c.value),h?i.value:"");t.setManifestValues(u.get().getFloodgateSurvey().getJsonElements());e=document.getElementById(r.d.TFormEmailCheckBox);o=document.getElementById(r.d.TFormEmailTextBox);e&&e.checked&&""!==o.value&&t.setEmail(o.value);t.submit();s.destroy();bt(!0);g(f.a.SURVEY_UI_FORM_SUBMIT,t.getClientFeedbackId(),u.get().getFloodgateInitOptions().showEmailAddress)}function bi(){return p().isEnabled(u.get().getFloodgateSurvey().getSurveyType(),u.get().getFloodgateSurvey().getLauncherType(),u.get().getFloodgateSurvey().getGoverenedChannelType())}function we(n,t,i){return[{attributes:[{name:r.a.Type,value:r.b.Radio},{name:r.a.Value,value:n},{name:r.a.Name,value:i}],id:n,tag:r.h.Input},{attributes:[{name:r.a.For,value:n}],children:[{children:[{tag:r.h.Span}],classes:[r.c.ChoiceGroupIcon],tag:r.h.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:t,tag:r.h.Span}],classes:[r.c.FontSubText],tag:r.h.Label}]}function be(){for(var o,n,i=[],f=0,t=0,e=u.get().getFloodgateSurvey().getRatingValuesAscending();t<e.length;t++)o=e[t],i.push([f,o]),f++;return function(n,t,i){var f={children:[],tag:r.h.FieldSet},u,e,o;for(yu(t)||Array.prototype.push.apply(f.children,[{classes:[r.c.FontSubText],id:r.d.TFormRatingQuestion,innerText:t,tag:r.h.Legend,attributes:[{name:r.a.AriaLabel,value:t}]}]),u=0,e=i;u<e.length;u++)o=e[u],Array.prototype.push.apply(f.children,we(o[0].toString(),o[1],n));return{children:[f],classes:[r.c.ChoiceGroup],id:n}}(r.d.TFormRating,null===(n=u.get().getFloodgateSurvey().getRatingQuestion())||void 0===n?void 0:n.trim(),i.reverse())}function ke(n){var i,e,t,o;i=pu.a({attributes:[{name:r.a.DataHtml2CanvasIgnore,value:r.b.True},{name:r.a.Role,value:"alert"}],children:[(t=u.get().getFloodgateSurvey().getSurveyType()===l.ISurvey.Type.Intercept,o={children:[{classes:[r.c.FontText,r.c.TextAlignLeft],id:r.d.TPromptTitle,innerText:t?u.get().getFloodgateSurvey().getInterceptTitle():u.get().getFloodgateSurvey().getTitle()},{classes:[r.c.FontSubText,r.c.TextAlignLeft],id:r.d.TPromptText,innerText:t?u.get().getFloodgateSurvey().getInterceptQuestion():u.get().getFloodgateSurvey().getPromptQuestion()}],id:r.d.TPromptContainer,tag:r.h.Button},o),{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.AriaLabel,value:rt.a().CloseLabel}],id:r.d.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z"/><\/svg>',tag:r.h.Button},u.get().getFloodgateSurvey().getSurveyType()!==l.ISurvey.Type.Intercept?(e={children:[{classes:[r.c.FontText,r.c.TextAlignLeft],id:r.d.TFormTitle,innerText:u.get().getFloodgateSurvey().getTitle()},be(),{attributes:[{name:r.a.Placeholder,value:u.get().getFloodgateSurvey().getCommentQuestion()},{name:r.a.AriaLabel,value:u.get().getFloodgateSurvey().getCommentQuestion()},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength}],classes:[r.c.FontSubText,r.c.TextInput],id:r.d.TFormComment,tag:r.h.TextArea},{brs:u.get().getFloodgateInitOptions().showEmailAddress&&u.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:r.a.Type,value:r.b.Checkbox},{name:u.get().getCommonInitOptions().userEmailConsentDefault?r.b.Checked:r.b.Unchecked,value:""}],classes:[r.c.TFormEmailCheckbox,r.c.CheckBox],id:r.d.TFormEmailCheckBox,tag:r.h.Input},{attributes:[{name:r.a.For,value:r.d.TFormEmailCheckBox}],classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.TFormEmailLabel],innerText:rt.a().Form.EmailCheckBoxLabel,tag:r.h.Label},{attributes:[{name:r.a.Type,value:r.b.Text},{name:r.a.Placeholder,value:rt.a().Form.EmailPlaceholder},{name:r.a.AriaLabel,value:rt.a().Form.EmailPlaceholder},{name:r.a.Name,value:r.d.BasicFormEmailInput},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength},{name:r.a.Value,value:u.get().getCommonInitOptions().userEmailConsentDefault?u.get().getCommonInitOptions().userEmail:""}],classes:[r.c.FontSubText,r.c.FormEmailInput,r.c.TextInput],id:r.d.TFormEmailTextBox,tag:r.h.Input}]},{children:[{attributes:[{name:r.a.HRef,value:r.i.PrivacyStatementLink},{name:r.a.Target,value:r.b.BlankWindow},{name:r.a.Rel,value:r.b.NoReferrer}],classes:[r.c.Link],innerText:rt.a().PrivacyStatement,tag:r.h.Anchor}],classes:[r.c.FontSubSubText,r.c.TextAlignLeft,r.c.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:r.a.Disabled,value:r.b.True}],classes:[r.c.FontSubText,r.c.SubmitButton],id:r.d.TFormSubmitButton,innerText:rt.a().Form.Submit,tag:r.h.Button},{classes:[r.c.Spinner,r.c.Hidden],id:r.d.TFormSubmitButtonSpinner,tag:r.h.Div}],id:r.d.TFormSubmitButtonContainer}],classes:[r.c.Hidden],id:r.d.TFormContainer},e):{}],classes:[r.c.Toast,w.f()?r.c.Rtl:""],id:r.d.ToastContainer});document.body.insertBefore(i,document.body.firstChild);w.l(r.d.ToastContainer,!0),function(n){var o,e,s,t;for(void 0===n&&(n=function(){}),ou=n,wt=!0,kt(r.d.ToastContainer,"keyup",le),kt(r.d.ToastCancel,"click",ae),kt(r.d.TPromptContainer,"click",ve),kt(r.d.TFormSubmitButton,"click",pe),kt(r.d.TFormEmailCheckBox,"click",cu),cu(null),o=document.querySelectorAll('input[name="'+r.d.TFormRating+'"]'),e=0;e<o.length;++e)w.h(o[e],"click",ye);var h=u.get().getFloodgateSurvey().getSurveyType()===l.ISurvey.Type.Intercept,i=u.get().getFloodgateInitOptions().autoDismiss,c=bi();switch(!0){case h:i=0;break;case c:s=p().getOverrideValueForSurveyId(0,u.get().getFloodgateSurvey().getId());hu(s)||(i=s);break;default:i=u.get().getFloodgateInitOptions().autoDismiss}if(ht=i,u.get().getFloodgateSurvey().showPrompt||h?g(f.a.SURVEY_UI_PROMPT_SHOWN,void 0,void 0,void 0,p().getEventIdForSurveyId(u.get().getFloodgateSurvey().getId()),i):vu(),0!==i){t=void 0;switch(i){case 1:t=7e3;break;case 2:t=14e3;break;case 3:t=21e3;break;case 4:t=28e3;break;case 5:t=6e4;break;case 6:t=9e4;break;case 7:t=12e4;break;case 8:t=15e4}void 0!==t&&(ui=window.setTimeout(function(){wt&&(bt(!1),c?(p().logUserActionForSurveyAsync(1,u.get().getFloodgateSurvey().getId(),u.get().getFloodgateSurvey().getCampaignId()),g(f.a.SURVEY_UI_PROMPT_AUTODISMISSED,void 0,void 0,1,p().getEventIdForSurveyId(u.get().getFloodgateSurvey().getId()),i)):g(f.a.SURVEY_UI_PROMPT_AUTODISMISSED,void 0,void 0,void 0,void 0,ht))},t))}}(function(t){w.l(r.d.ToastContainer,!1);w.d(r.d.ToastContainer);u.get().getFloodgateInitOptions().onDismiss(u.get().getFloodgateSurvey().getCampaignId(),t);n()})}function di(n){if(null!=n)return n.questionValue}function gi(n){return Object(y.isNOU)(null==n?void 0:n.answerValue[0])?null==n?void 0:n.answerValue[0]:""+(null==n?void 0:n.answerValue[0])}function ge(n){var t,i,r,u,f,e,o;return n.pageInfo.forEach(function(s){s.questionAnswers.forEach(function(h){switch(null==h?void 0:h.questionType){case"rating":"rating"!==s.pageType&&"singlepage"!==s.pageType||(t=function(n){return parseInt(null==n?void 0:n.answerValue[0],10)-1}(h),u=di(h),"FormPartialResponseSubmitted"!==n.responseType&&"FormResponseSubmitted"!==n.responseType||(ei=s.pageType));break;case"prompt":f=di(h);e=gi(h);break;case"verbatim":"verbatim"!==s.pageType&&"singlepage"!==s.pageType||(o=di(h),i=gi(h),"FormResponseSubmitted"===n.responseType&&(ei=s.pageType));break;case"email":r=gi(h)}})}),{rating:t,ratingQuestion:u,email:r,comment:i,commentTitle:o,promptQuestion:f,promptResponse:e}}function no(n,t){n.setManifestValues(u.get().getFloodgateSurvey().getJsonElements()),function(n,t){var i=JSON.parse(n.getExtendedManifestData());i.surveyStrings=JSON.stringify({prompt:{title:"",question:null==t?void 0:t.promptQuestion,yesButtonText:"YES",noButtonText:"NO"},rating:[{question:null==t?void 0:t.ratingQuestion,options:[]}],comment:[{question:null==t?void 0:t.commentTitle}]});n.setExtendedManifestData(JSON.stringify(i))}(n,t);t.email&&n.setEmail(t.email);var i=function(){var n=u.get().getCommonInitOptions().applicationGroup.appData,t={additionalInfo:{SurveyDescription:d.e,Fligtht:u.get().getCVSurveyFlights()}};return Object(y.isNOU)(n)?JSON.stringify(t):JSON.stringify(Object.assign(JSON.parse(n),t))}();return n.setAppData(i),n.setClientFeedbackId(u.get().getFloodgateSurvey().getPreGeneratedClientFeedbackId()),n}function to(n){var e;try{var t=ge(n),o=t.rating,s=t.comment,i=t.promptResponse;if(!Object(y.isNOU)(i)){if(!1===ki)return ki=!0,k(i===r.f.No?f.a.SURVEY_UI_PROMPT_USERCLOSED:f.a.SURVEY_UI_PROMPT_CLICKED);if(!0===ki&&i===r.f.No)return}e=new yi.a(u.get().getCommonInitOptions().environment,l.ISurvey.Type[u.get().getFloodgateSurvey().getSurveyType()],u.get().getCommonInitOptions().appId,"Survey",u.get().getCommonInitOptions().applicationGroup,u.get().getCommonInitOptions().telemetryGroup,u.get().getCommonInitOptions().webGroup);u.get().getFloodgateSurvey().setValues(Number(o),s||"");no(e,t);e.submit();"FormResponseSubmitted"!==n.responseType&&"FormPartialResponseSubmitted"!==n.responseType||(bu=!0);k("singlepage"===ei||"rating"===ei?f.a.SURVEY_UI_FORM_SUBMIT:f.a.SURVEY_UI_FORM_SECONDARY_SUBMIT)}catch(n){k(f.a.SURVEY_UI_FORM_SUBMIT_ERROR)}}function io(n){switch(n.responseEventType){case"FormClosed":k(f.a.SURVEY_UI_FORM_USERCLOSED);break;case"FormAutoDismissed":k(f.a.SURVEY_UI_PROMPT_AUTODISMISSED);break;case"FormResponseCanceled":k(f.a.SURVEY_UI_FORM_USERCLOSED);break;default:k(f.a.SURVEY_UI_FORM_NO_RETURN_TYPE)}wu(bu)}function ro(n){document.getElementById(r.d.ToastContainer).style.display="inherit";!0===n.hasSurveyPromptShown?k(f.a.SURVEY_UI_PROMPT_SHOWN):k(f.a.SURVEY_UI_FORM_SHOWN)}function uo(n){var t=u.get(),i={CampaignId:t.getFloodgateSurvey().getCampaignId(),SurveyId:t.getFloodgateSurvey().getId(),SurveyType:t.getFloodgateSurvey().getSurveyType(),ErrorMessage:n.CustomProperties.ErrorMessage?n.CustomProperties.ErrorMessage:null,Message:n.CustomProperties.Message?n.CustomProperties.Message:null};k(n.EventId,i)}function k(n,t){var r,i=u.get();r=t||{CampaignId:i.getFloodgateSurvey().getCampaignId(),SurveyId:i.getFloodgateSurvey().getId(),SurveyType:i.getFloodgateSurvey().getSurveyType(),ClientFeedbackId:u.get().getFloodgateSurvey().getPreGeneratedClientFeedbackId(),CVFormId:i.getFloodgateSurvey().getCVSurveyFormId()};f.b().logEvent(n,1,r)}function ku(){return new Promise(function(n,t){var i=function(n){var i=o.FloodgateEngine.getTelemetryLogger();i&&i.log_Event(ii.TelemetryEvent.Floodgate.Initialize.Failed,{ErrorMessage:n});t(n)};if(yt)n();else{try{tr.a()}catch(n){t("CommonApp initialization failed: {"+n+"}")}o.FloodgateEngine.setTelemetryLogger(new oo);su.a().then(function(){try{!function(){var n,i,t,r;if(!et.a.isStorageAvailable())throw new Error("window.localStorage is not available.");if(a.a().OfficeBrowserFeedback.floodgate=a.a().OfficeBrowserFeedback.floodgate||{},n=a.a().OfficeBrowserFeedback.floodgate.initOptions,void 0!==(n=n||{}).campaignDefinitions){if(i=Object(dr.FilterValidCampaignDefinitions)(n.campaignDefinitions),i.error)throw new Error("floodgate.initOptions.campaignDefinitions error: "+i.error);(new et.a).write(l.IFloodgateStorageProvider.FileType.CampaignDefinitions,JSON.stringify(n.campaignDefinitions))}t=u.get();(t.setFloodgateInitOptions(n),ee.a.resetSessionActivity(),p().setup(t),iu().setup(t),yt=!0,t.getFloodgateInitOptions().surveyEnabled)||(r=o.FloodgateEngine.getTelemetryLogger(),r&&r.log_Event(ii.TelemetryEvent.Floodgate.Start.SurveysDisabled,{Count:st,Message:"Floodgate initialized with surveys disabled (surveyEnabled is false)"}))}()}catch(n){i("CommonFloodgate initialization failed: {"+n+"}")}n()}).catch(function(n){i("Initialization failed: {"+n+"}")})}})}function nr(n){return new Promise(function(t,i){var e,o;if(ct)i("Control already open");else{if(!u.get().isFeedbackSurveyEnabledByAADC())return f.b().logEvent(f.a.SURVEY_UI_DISABLED_AADC,2,{CampaignId:n.getCampaignId(),Data:JSON.stringify({ageGroup:u.get().getCommonInitOptions().ageGroup,authenticationType:u.get().getCommonInitOptions().authenticationType})}),void i("Prompt is prohibited by AADC");if(u.get().setFloodgateSurvey(n||new eo),u.get().isCVSurveyEnabled()&&n.getLauncherType()===d.d){var l=u.get().getCVSurveyFlights(),a={customerVoiceFormId:n.getCVSurveyFormId(),flights:l,isCommercialHost:u.get().getCommonInitOptions().isCommercialHost,locale:u.get().getCommonInitOptions().locale,userEmailConsentDefault:u.get().getCommonInitOptions().userEmailConsentDefault,platform:u.get().getCommonInitOptions().telemetryGroup.platform,productName:u.get().getProductName(),uiHost:u.get().getUIHost()},s={},h=null!==(e=u.get().getCommonInitOptions().primaryColour)&&void 0!==e?e:"",c=null!==(o=u.get().getCommonInitOptions().secondaryColour)&&void 0!==o?o:"";return h&&(s.appPrimaryColor=h.replace("#","")),c&&(s.appSecondaryColor=c.replace("#","")),function(n,t,i){wu=function(n){u.get().getFloodgateInitOptions().onDismiss(u.get().getFloodgateSurvey().getCampaignId(),n);i()};var f=document.createElement("div");f.id=r.d.ToastContainer;f.style.position="fixed";f.style.bottom="56px";f.style.right="19px";f.style.zIndex="999";document.body.appendChild(f);document.getElementById(r.d.ToastContainer).style.display="none";Object(de.renderCVSurvey)(r.d.ToastContainer,to,io,ro,uo,n,t)}(a,s,function(){ct=!1}),ct=!0,void t()}ke(function(){ct=!1});ct=!0;t()}})}function du(n){return nr(new fo(n))}function so(){tr.b();su.b();yt=!1;eu();ct=!1}function gu(){return l.IFloodgateSettingIdMap.RoamingSettingIdMap}var fr,er,cr,lr,it,tu,fi,yu,pu;i.r(t);i.d(t,"getEngineStartPromise",function(){return he});i.d(t,"resetEngine",function(){return eu});i.d(t,"setEngineStartPromise",function(){return nt});i.d(t,"start",function(){return uu});i.d(t,"startInternal",function(){return ru});i.d(t,"stop",function(){return fu});i.d(t,"initialize",function(){return ku});i.d(t,"showSurvey",function(){return nr});i.d(t,"showCustomSurvey",function(){return du});i.d(t,"reset",function(){return so});i.d(t,"getSettingIdMap",function(){return gu});var tr=i(26),u=i(1),a=i(8),o=i(9),e=i(6),l=i(11),s=i(12),d=i(7),nf=i(30),f=i(2),oi=i(14),c="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==c&&c,ir="URLSearchParams"in c,rr="Symbol"in c&&"iterator"in Symbol,dt="FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch(n){return!1}}(),ur="FormData"in c,gt="ArrayBuffer"in c;gt&&(fr=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],er=ArrayBuffer.isView||function(n){return n&&fr.indexOf(Object.prototype.toString.call(n))>-1});h.prototype.append=function(n,t){n=lt(n);t=si(t);var i=this.map[n];this.map[n]=i?i+", "+t:t};h.prototype.delete=function(n){delete this.map[lt(n)]};h.prototype.get=function(n){return n=lt(n),this.has(n)?this.map[n]:null};h.prototype.has=function(n){return this.map.hasOwnProperty(lt(n))};h.prototype.set=function(n,t){this.map[lt(n)]=si(t)};h.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};h.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),hi(n)};h.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),hi(n)};h.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),hi(n)};rr&&(h.prototype[Symbol.iterator]=h.prototype.entries);cr=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];tt.prototype.clone=function(){return new tt(this,{body:this._bodyInit})};hr.call(tt.prototype);hr.call(b.prototype);b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})};b.error=function(){var n=new b(null,{status:0,statusText:""});return n.type="error",n};lr=[301,302,303,307,308];b.redirect=function(n,t){if(-1===lr.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:n}})};it=c.DOMException;try{new it}catch(n){(it=function(n,t){this.message=n;this.name=t;var i=Error(n);this.stack=i.stack}).prototype=Object.create(Error.prototype);it.prototype.constructor=it}ar.polyfill=!0;c.fetch||(c.fetch=ar,c.Headers=h,c.Request=tt,c.Response=b);var v=i(4),uf=v.l,vr=function(){function n(n){this.sessionId=n}return n.prototype.sendGetRequest=function(n,t,i,r){return Object(e.b)(this,void 0,void 0,function(){var u;return Object(e.d)(this,function(){return u={method:"GET",headers:this.createHeaders(t)},[2,i?this.timeoutFetch(n,u,null!=r?r:5e3):fetch(n,u)]})})},n.prototype.sendPostRequest=function(n,t,i,r,u){return Object(e.b)(this,void 0,void 0,function(){var f;return Object(e.d)(this,function(){return f={method:"POST",headers:this.createHeaders(i),body:t},[2,r?this.timeoutFetch(n,f,null!=u?u:5e3):fetch(n,f)]})})},n.prototype.createHeaders=function(n){var t="undefined"!=typeof Headers&&new Headers;return t&&(uf(n)||t.append("Authorization","Bearer "+n),t.append("X-CorrelationId",v.i()),this.sessionId&&t.append("X-UserSessionId",this.sessionId)),t},n.prototype.timeoutFetch=function(n,t,i){return void 0===t&&(t={}),new Promise(function(r,u){fetch(n,t).then(r,u);setTimeout(function(){return u(new Error("Service request timed out"))},i)})},n}();var ff=i(33),et=i(15),ef=i(51);var lf=function(){},ai,ti,af=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.locale="en-us";this.country="US";this.locale=r;this.country=u;this.authTokenCallback=e;this.augLoopCallback=o;this.app=n;this.platform=t;this.version=i;this.sessionId=f;this.campaignFlights=s;this.campaignParameters=h;this.ageGroup=c;this.authenticationType=l;this.tmsBaseUrlPrefix=a&&-1!==["dogfood","edog","int","microsoft"].indexOf(a.toLowerCase())?"https://messaging.officeppe.com/lifecycle/":"https://messaging.office.com/lifecycle/";this.tmsgCache=this.tmsgCache||v||new ff.a(["MessageMetadata","UserGovernance","CampaignContent","DynamicSettings","LogLevelSettings","UserFacts"])}return n.prototype.getContent=function(n){return Object(e.b)(this,void 0,void 0,function(){return Object(e.d)(this,function(t){switch(t.label){case 0:return this.tmsgCache.isItemExpired(n)?[4,this.refreshItemsInCacheFromTmsService([n])]:[3,2];case 1:t.sent();t.label=2;case 2:return[2,this.retrieveCacheItemAndCreateContentResponse(n)]}})})},n.prototype.getMultipleContents=function(n){return Object(e.b)(this,void 0,void 0,function(){var i,u,t,r,f,o;return Object(e.d)(this,function(e){switch(e.label){case 0:return[4,this.refreshItemsInCacheFromTmsService(n)];case 1:for(e.sent(),i=[],u=[],t=0,r=n;t<r.length;t++)f=r[t],o=this.createCachedContentResponse(f),i.push(o);return this.refreshItemsInCacheFromTmsService(u),[2,i]}})})},n.prototype.getUserFactsContent=function(n){return Object(e.b)(this,void 0,void 0,function(){return Object(e.d)(this,function(t){switch(t.label){case 0:return[4,this.refreshItemsInCacheFromTulipsService(n)];case 1:return t.sent(),[2,this.retrieveCacheItemAndCreateContentResponse(n)]}})})},n.prototype.sendBeaconRequestToService=function(n,t,i,r,u,o,h,c){return Object(e.b)(this,void 0,void 0,function(){var b,a,v,y,p,k,g,w,l;return Object(e.d)(this,function(nt){switch(nt.label){case 0:return this.sessionId=h,this.authTokenCallback=c,b=Object(s.a)("TmsAppId",d.c.TMSAppID),[4,this.getAuthToken(b)];case 1:return a=nt.sent(),v=void 0,a?[3,4]:(y=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:y=nt.sent();nt.label=3;case 3:v=y;nt.label=4;case 4:p=+new Date;nt.label=5;case 5:return nt.trys.push([5,7,,8]),k={app:n,country:o,locale:u,platform:i,puid:v,version:r},g=JSON.stringify({actionName:t.actionName,actionUrl:t.actionUrl}),[4,this.sendRequest(k,a,"TmsActionUrl",this.tmsBaseUrlPrefix+"SetCampaignAction?",g,"POST")];case 6:return(w=nt.sent())&&200===w.status?[2,!0]:(f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,2,this.createTelemetryData(p,w,"Beacon"+t.actionName)),[2,!1]);case 7:return l=nt.sent(),f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,2,Object(e.a)({ErrorMessage:"Error fetching from TMS SetCampaignAction endpoint"+(l&&l.message?": "+l.message:"")},this.createTelemetryData(p,null,"Beacon"+t.actionName))),[2,!1];case 8:return[2]}})})},n.prototype.getCachedContent=function(n){return this.tmsgCache.getItemContent(n)},n.prototype.getAugLoopUserFactsContent=function(n){return Object(e.b)(this,void 0,void 0,function(){return Object(e.d)(this,function(t){switch(t.label){case 0:return this.tmsgCache.isItemExpired("UserFacts")?[4,this.refreshUserFactsInCacheFromAugLoop()]:[3,2];case 1:t.sent();t.label=2;case 2:return[2,this.retrieveCacheItemAndCreateContentResponse(n)]}})})},n.prototype.refreshUserFactsInCacheFromAugLoop=function(){return Object(e.b)(this,void 0,void 0,function(){var i,r,n,h,c,t,u,o;return Object(e.d)(this,function(l){switch(l.label){case 0:if(!this.tmsgCache.isItemExpired("UserFacts"))return i=this.tmsgCache.getItemContent("UserFacts"),f.b().logEvent(f.a.UserFacts.AugLoop.Requests.VALUE,3,{Count:i?i.length:-1,Type:"AugLoopUserFactsCached",Flights:this.campaignFlights}),[2,i];r=+new Date;l.label=1;case 1:return l.trys.push([1,3,,4]),h=Object(s.a)("TulipsAugLoopAnnotationName","AugLoop_User_UserLifecycleFactsAnnotation"),c=this.augLoopCallback.getRuntimeSession,[4,cf(h,c)];case 2:return(t=l.sent())&&t.userFacts?(n=this.addClientIngestionTimeAndNormalizeKeysInArray(t.userFacts),this.tmsgCache.setContentItem("UserFacts",n,864e5),f.b().logEvent(f.a.UserFacts.AugLoop.Requests.VALUE,3,Object(e.a)({Count:n?n.length:-1},this.createTelemetryData(r,null,"AugLoopUserFacts")))):(u=t&&t.error,f.b().logEvent(f.a.UserFacts.AugLoop.Error.VALUE,2,Object(e.a)({ErrorMessage:"Error getting augloop facts "+(u&&u.toString())},this.createTelemetryData(r,null,"AugLoopUserFacts")))),[3,4];case 3:return o=l.sent(),f.b().logEvent(f.a.UserFacts.AugLoop.Error.VALUE,2,Object(e.a)({ErrorMessage:"Error getting facts "+(o&&o.message)},this.createTelemetryData(r,null,"AugLoopUserFacts"))),[3,4];case 4:return[2,n]}})})},n.prototype.createTelemetryData=function(n,t,i){var u=t||{},r=u.headers,f=u.status,e=u.statusText,o=r&&r.get("X-UserSessionId"),s=r&&r.get("X-CorrelationId");return{Type:i,TimeMilliseconds:+new Date-n,SessionId:o||this.sessionId,CorrelationId:s||void 0,HttpStatusCode:f||void 0,HttpStatusText:e||void 0,Flights:this.campaignFlights}},n.prototype.sendRequest=function(n,t,i,r,u,f){this.tmsgTransport=this.tmsgTransport||new vr(this.sessionId);var e=yr(n),o=Object(s.a)(i,r);return"POST"===f?this.tmsgTransport.sendPostRequest(o+e,u,t):this.tmsgTransport.sendGetRequest(o+e,t)},n.prototype.retrieveCacheItemAndCreateContentResponse=function(n){var t=this.createCachedContentResponse(n);return this.tmsgCache.isItemExpired(n)&&("UserFacts"===n?this.refreshItemsInCacheFromTulipsService(n):this.refreshItemsInCacheFromTmsService([n])),t},n.prototype.createCachedContentResponse=function(n){var t=new lf;return t.content=this.tmsgCache.getItemContent(n),t.contentType=n,t},n.prototype.getAuthToken=function(n){return Object(e.b)(this,void 0,void 0,function(){var r,u,i,o,t,s=this;return Object(e.d)(this,function(e){switch(e.label){case 0:if(!this.authTokenCallback||!this.authTokenCallback.getAuthToken)return[2,null];r=+new Date;u=function(){return+new Date-r};i=function(t){return void 0===t&&(t=void 0),{ErrorMessage:t,SessionId:s.sessionId,TimeMilliseconds:u(),Type:n}};e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.authTokenCallback.getAuthToken(n)];case 2:return o=e.sent(),f.b().logEvent(f.a.WebSurfaces.Common.Info.VALUE,3,i()),[2,o];case 3:return t=e.sent(),f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,2,i("Error getting token "+(t&&t.message?": "+t.message:""))),[3,4];case 4:return[2,null]}})})},n.prototype.refreshItemsInCacheFromTmsService=function(n){return Object(e.b)(this,void 0,void 0,function(){var h,i,c,l,b,a,v,y,r,p,k,w,g,u,t,o;return Object(e.d)(this,function(nt){switch(nt.label){case 0:if(0===n.length)return[2];for(h=[],i=0,c=n;i<c.length;i++)l=c[i],this.tmsgCache.isItemExpired(l)&&h.push(l);return 0===h.length?[2]:(-1===n.indexOf("DynamicSettings")&&n.push("DynamicSettings"),b=Object(s.a)("TmsAppId",d.c.TMSAppID),[4,this.getAuthToken(b)]);case 1:return a=nt.sent(),v=void 0,a?[3,4]:(y=this.authTokenCallback.getUserPuid)?[4,this.authTokenCallback.getUserPuid()]:[3,3];case 2:y=nt.sent();nt.label=3;case 3:v=y;nt.label=4;case 4:r=+new Date;nt.label=5;case 5:return nt.trys.push([5,10,,11]),p=document&&(document.documentElement||document.getElementsByTagName("body")[0]),k={pageWidth:window.innerWidth||p.clientWidth,pageHeight:window.innerHeight||p.clientHeight,screenWidth:screen?screen.width:void 0,screenHeight:screen?screen.height:void 0,colorDepth:screen?screen.colorDepth:void 0},w=et.a.safeReadObject(oi.FileType.DebugOverrides,{}),g=w.replaceTmsQueryParams||Object(e.a)(Object(e.a)({country:this.country,locale:this.locale,app:this.app,platform:this.platform,version:this.version,campaignParams:yr(k)+"&more=true&"+(this.campaignParameters||""),contentType:n.join(";"),puid:v,OFC_FLIGHTS:this.campaignFlights},w.addTmsQueryParams||{}),{ageGroup:this.ageGroup,authenticationType:this.authenticationType}),[4,this.sendRequest(g,a,"TmsServiceUrl",this.tmsBaseUrlPrefix+"CampaignMetadataAggregator?")];case 6:return 200!==(u=nt.sent()).status?[3,8]:[4,u.json()];case 7:return t=nt.sent(),-1!==n.indexOf("MessageMetadata")&&void 0!==t.MessageMetadata&&this.tmsgCache.setContentItem("MessageMetadata",t.MessageMetadata,Object(s.a)("TmsMessageMetadataExpiry",144e5)),-1!==n.indexOf("UserGovernance")&&void 0!==t.UserGovernanceRules&&this.tmsgCache.setContentItem("UserGovernance",t.UserGovernanceRules,Object(s.a)("TmsUserGovernanceRulesExpiry",144e5)),-1!==n.indexOf("CampaignContent")&&void 0!==t.CampaignContent&&this.tmsgCache.setContentItem("CampaignContent",t.CampaignContent,Object(s.a)("TmsCampaignContentExpiry",144e5)),void 0!==t.DynamicSettings&&this.tmsgCache.setContentItem("DynamicSettings",t.DynamicSettings,Object(s.a)("TmsDynamicSettingsExpiry",144e5)),void 0!==t.LogLevelSettings&&this.tmsgCache.setContentItem("LogLevelSettings",t.LogLevelSettings,Object(s.a)("TmsLogLevelSettingsExpiry",144e5)),f.b().logEvent(f.a.WebSurfaces.Messaging.Requests.VALUE,3,this.createTelemetryData(r,u,n.join(";"))),[3,9];case 8:f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,2,this.createTelemetryData(r,u,n.join(";")));nt.label=9;case 9:return[3,11];case 10:return o=nt.sent(),f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,2,Object(e.a)({ErrorMessage:"Error fetching from TMS"+(o&&o.message?": "+o.message:"")},this.createTelemetryData(r,null,n.join(";")))),[3,11];case 11:return[2]}})})},n.prototype.refreshItemsInCacheFromTulipsService=function(n){return Object(e.b)(this,void 0,void 0,function(){var o,h,i,t,u,c,r;return Object(e.d)(this,function(l){switch(l.label){case 0:return this.tmsgCache.isItemExpired(n)?(o=Object(s.a)("TulipsAppId",d.c.TULIPSAppID),[4,this.getAuthToken(o)]):[2];case 1:if(!(h=l.sent()))return[2];i=+new Date;l.label=2;case 2:return l.trys.push([2,7,,8]),[4,this.sendRequest({},h,"TulipsServiceUrl","https://substrate.office.com/OfficePersonalizationUserLifecycle/api/facts")];case 3:return 200!==(t=l.sent()).status&&204!==t.status?[3,5]:[4,t.json()];case 4:return u=l.sent(),-1!==n.indexOf("UserFacts")&&void 0!==u&&(c=this.addClientIngestionTimeAndNormalizeKeys(u),this.tmsgCache.setContentItem("UserFacts",c,864e5)),f.b().logEvent(f.a.UserFacts.Messaging.Requests.VALUE,3,this.createTelemetryData(i,t,n)),[3,6];case 5:f.b().logEvent(f.a.UserFacts.Common.Error.VALUE,2,this.createTelemetryData(i,t,n));l.label=6;case 6:return[3,8];case 7:return r=l.sent(),f.b().logEvent(f.a.UserFacts.Common.Error.VALUE,2,Object(e.a)({ErrorMessage:"Error fetching from TULIPS"+(r&&r.message?": "+r.message:"")},this.createTelemetryData(i,null,n))),[3,8];case 8:return[2]}})})},n.prototype.addClientIngestionTimeAndNormalizeKeys=function(n){var t=this,i=new Date(Date.now()).toISOString();return n.map(function(n){var r=t.normalizeKeys(n);return r.clientIngestionDateTime=i,r})},n.prototype.addClientIngestionTimeAndNormalizeKeysInArray=function(n){var t=this,i=new Date(Date.now()).toISOString();return n.map(function(n){var r=t.normalizeKeys(n);return r.clientIngestionDateTime=i,r})},n.prototype.normalizeKeys=function(n){for(var t,r={},i=0,u=Object.keys(n);i<u.length;i++)t=u[i],r[t.charAt(0).toLowerCase()+t.substring(1)]=n[t];return r},n}(),vf=function(){function n(){var r,f,t;this.configuration=u.get();var n=this.configuration&&this.configuration.getFloodgateInitOptions(),i=this.configuration&&this.configuration.getCommonInitOptions(),e=n&&n.authTokenCallback;(e&&(e.getAuthToken||e.getUserPuid)||this.isAugLoopEnabled())&&(t=this.configuration.getCommonInitOptions(),this.tmsgClient=new af(t.appId.toString(),"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),n.authTokenCallback,n.augLoopCallback,n.campaignFlights,n.campaignQueryParameters,i.ageGroup,i.authenticationType,(null===(r=i.telemetryGroup)||void 0===r?void 0:r.audienceGroup)||(null===(f=i.telemetryGroup)||void 0===f?void 0:f.audience)))}return n.prototype.getCampaignDefinitions=function(){var n,t=(n=et.a.safeReadObject(oi.FileType.DebugOverrides,{}))&&n.tmsResponse&&n.tmsResponse.CampaignContent&&{contentType:"CampaignContent",content:n.tmsResponse.CampaignContent};return t&&t.content?Promise.resolve(t.content):this.tmsgClient?this.tmsgClient.getContent("CampaignContent").then(function(n){return n.content}):Promise.resolve(null)},n.prototype.getCachedCampaignDefinitions=function(){var n;if(null!==(n=this.tmsgClient)&&void 0!==n)return n.getCachedContent("CampaignContent")},n.prototype.getUserGovernanceRules=function(){return this.tmsgClient?this.tmsgClient.getContent("UserGovernance").then(function(n){return n.content}):Promise.resolve(null)},n.prototype.getMessageMetadata=function(){return this.tmsgClient?this.tmsgClient.getContent("MessageMetadata").then(function(n){return n.content}):Promise.resolve(null)},n.prototype.getUserFacts=function(){var n,r=this,t=(n=et.a.safeReadObject(oi.FileType.DebugOverrides,{}))&&n.userFactsResponse&&{contentType:"UserFacts",content:n.userFactsResponse},i;return t&&t.content?Promise.resolve(t.content):this.tmsgClient?this.isAugLoopEnabled()?(i=Object(s.a)("TulipsLoadTimeout",1e3),Object(v.b)(i,this.getAugLoopUserFacts()).then(function(n){return n}).catch(function(){return r.getSubstrateUserFacts()})):this.getSubstrateUserFacts():Promise.resolve(null)},n.prototype.getCachedUserFacts=function(){var n;if(null!==(n=this.tmsgClient)&&void 0!==n)return n.getCachedContent("UserFacts")},n.prototype.setCampaignAction=function(n){if(this.tmsgClient){var t=this.configuration.getCommonInitOptions(),i=this.configuration.getFloodgateInitOptions();return this.tmsgClient.sendBeaconRequestToService(t.appId.toString(),n,"Web",t.build,t.originalLocale,this.extractCountryFromLocale(t.originalLocale),this.configuration.getSdkSessionId(),i.authTokenCallback)}},n.prototype.extractCountryFromLocale=function(n){if(n){var t=n.split("-");return 2===t.length?t[1]:void 0}},n.prototype.getSubstrateUserFacts=function(){return this.tmsgClient?this.tmsgClient.getUserFactsContent("UserFacts").then(function(n){return n.content}):Promise.resolve(null)},n.prototype.getAugLoopUserFacts=function(){return this.tmsgClient?this.tmsgClient.getAugLoopUserFactsContent("UserFacts").then(function(n){return n.content}):Promise.resolve(null)},n.prototype.isAugLoopEnabled=function(){var n,t,i;if(null!==(i=null===(t=null===(n=this.configuration)||void 0===n?void 0:n.getFloodgateInitOptions())||void 0===t?void 0:t.augLoopCallback)&&void 0!==i)return i.isEnabled},n}();var vi,br=function(){function n(){}return n.prototype.makeSurveyLauncher=function(n){return this.AcceptsSurvey(n)?new yf(n):null},n.prototype.AcceptsSurvey=function(t){return!Object(v.l)(t)&&t.getType()===l.ISurvey.Type.GenericMessagingSurface&&t.getLauncherType().toLocaleLowerCase()===n.LAUNCHER_TYPE},n.LAUNCHER_TYPE="coachingux",n}(),yf=function(){function n(n){var t;this.survey=n;!ti&&n&&n.getSurveyInfo&&(null===(t=n.getSurveyInfo())||void 0===t?void 0:t.getBusinessLevel())===l.ISurveyInfo.BusinessLevel.Critical&&setTimeout(wr,1e3)}return n.prototype.launch=function(n){var v=this,t=this.survey&&this.survey.getSurveyInfo(),i=t&&t.getMetadata(),r=i&&i.getContentMetadata();if(r){var o=new Date,h=function(){var n=a.b();return n&&n.OfficeWebSurfaces},c=function(i){var u=h(),f;i&&u.Initialize(i);u.RemoveSurface();f=Object(e.a)(Object(e.a)({},r),{surfaceContext:{surveyForm:v.survey,surveyParams:n}});u.RenderSurface(f,null,t.getBackEndId())},l=function(n){f.b().logEvent(f.a.WebSurfaces.Common.Error.VALUE,1,{ErrorMessage:"Error loading websurfaces"+(n&&n.message?": "+n.message:""),TimeMilliseconds:Date.now()-+o})};try{if(h())return void c();wr();ti.then(function(){var r=u.get().getCommonInitOptions(),n=u.get().getFloodgateInitOptions(),i=n&&n.onSurveyActivatedCallback,f=Object(e.a)(Object(e.a)(Object(e.a)({},r),n),{beaconCallback:function(n){if(n)return at().setCampaignAction(n)},surfaceInitTime:o,surfaceId:t.getBackEndId(),logSessionId:u.get().getSdkSessionId(),logSettings:Object(s.a)("LogLevelSettings",void 0),renderer:i,renderCallback:i&&i.onTeachingCampaignRender});c(f)}).catch(function(n){l(n)})}catch(n){l(n)}}},n}(),pf=function(){function n(n){var t;if(this.showPrompt=!0,this.showEmailRequest=!1,!n)throw Error("survey must not be null");if(this.survey=n,n.getType()===l.ISurvey.Type.Intercept){if(this.isIntercept=!0,t=n.getComponent("Intercept"),!t)throw Error("intercept component must not be null");this.intercept=t}else{this.isIntercept=!1;var i=n.getComponent("Prompt"),r=n.getComponent("Comment"),u=n.getComponent("Rating"),f=n.getComponent("CVSurvey");if(!i)throw Error("prompt component must not be null");if(this.prompt=i,this.showEmailRequest=n.getSurveyInfo().isAdditionalDataRequested(0),!r)throw Error("comment component must not be null");if(this.comment=r,!u)throw Error("rating component must not be null");if(this.rating=u,f&&(this.cvSurvey=f,this.getLauncherType()===d.d&&!this.getCVSurveyFormId()))throw Error("CvSurveyId should not be null");}}return n.prototype.getLauncherType=function(){if(!this.isIntercept)return this.survey.getLauncherType()},n.prototype.getCVSurveyFormId=function(){if(!this.isIntercept)return this.cvSurvey.getFormId()},n.prototype.getPreGeneratedClientFeedbackId=function(){return this.survey.getPreGeneratedClientFeedbackId()},n.prototype.getPromptQuestion=function(){if(!this.isIntercept)return this.prompt.getQuestion()},n.prototype.getTitle=function(){if(!this.isIntercept)return this.prompt.getTitle()},n.prototype.getPromptYesButtonText=function(){if(!this.isIntercept)return this.prompt.getYesButtonText()},n.prototype.getPromptNoButtonText=function(){if(!this.isIntercept)return this.prompt.getNoButtonText()},n.prototype.getRatingValuesAscending=function(){if(!this.isIntercept)return this.rating.getRatingValuesAscending()},n.prototype.getRatingQuestion=function(){if(!this.isIntercept)return this.rating.getQuestion()},n.prototype.getCommentQuestion=function(){if(!this.isIntercept)return this.comment.getQuestion()},n.prototype.getInterceptTitle=function(){if(this.isIntercept)return this.intercept.getTitle()},n.prototype.getInterceptQuestion=function(){if(this.isIntercept)return this.intercept.getQuestion()},n.prototype.getInterceptUrl=function(){if(this.isIntercept)return this.intercept.getUrl()},n.prototype.setValues=function(n,t){this.isIntercept||(this.rating.setSelectedRatingIndex(n),this.comment.setSubmittedText(t))},n.prototype.getJsonElements=function(){return this.survey.getJsonElements()},n.prototype.getSurveyType=function(){return this.survey.getType()},n.prototype.getCampaignId=function(){return this.survey.getSurveyInfo().getBackEndId()},n.prototype.getId=function(){return this.survey.getSurveyInfo().getId()},n.prototype.getGoverenedChannelType=function(){return this.survey.getSurveyInfo().getGovernedChannelType()},n}(),wf=o.Utils.isNOU,kr=function(){function n(){}return n.prototype.makeSurveyLauncher=function(n){return this.AcceptsSurvey(n)?new bf(n):null},n.prototype.AcceptsSurvey=function(n){return!wf(n)&&n.getType()!==o.Api.ISurvey.Type.GenericMessagingSurface},n.LAUNCHER_TYPE=o.Api.ISurvey.LAUNCHER_TYPE_DEFAULT,n}(),bf=function(){function n(n){this.survey=n}return n.prototype.launch=function(){a.a().OfficeBrowserFeedback.floodgate.showSurvey(new pf(this.survey))},n}(),ot=o.Utils.isNOU,kf=function(){function n(n,t){this.rudeSurveyLauncherFactory=n;this.coachingUXLauncherFactory=t}return n.make=function(){return new n(new kr,new br)},n.prototype.makeSurveyLauncher=function(n){if(ot(n))return null;switch(n.getLauncherType().toLocaleLowerCase()){case br.LAUNCHER_TYPE:return this.makeGenericMessagingSurfaceLauncher(n);case kr.LAUNCHER_TYPE:default:return this.makeRudeSurveyLauncher(n)}},n.prototype.AcceptsSurvey=function(n){if(ot(n))return!1;switch(n.getType()){case o.Api.ISurvey.Type.GenericMessagingSurface:return!ot(this.coachingUXLauncherFactory)&&this.coachingUXLauncherFactory.AcceptsSurvey(n);default:return u.get().checkIfSurveysEnabled()&&!ot(this.rudeSurveyLauncherFactory)&&this.rudeSurveyLauncherFactory.AcceptsSurvey(n)}},n.prototype.makeGenericMessagingSurfaceLauncher=function(n){return ot(this.coachingUXLauncherFactory)?null:this.coachingUXLauncherFactory.makeSurveyLauncher(n)},n.prototype.makeRudeSurveyLauncher=function(n){return ot(this.rudeSurveyLauncherFactory)?null:this.rudeSurveyLauncherFactory.makeSurveyLauncher(n)},n}(),yi=i(22),df=function(){function n(){}return n.prototype.makeTransporter=function(n){return new yi.a(u.get().getCommonInitOptions().environment,n,u.get().getCommonInitOptions().appId,"Survey",u.get().getCommonInitOptions().applicationGroup,u.get().getCommonInitOptions().telemetryGroup,u.get().getCommonInitOptions().webGroup)},n}(),gf=function(){function n(){}return n.prototype.getLanguage=function(){return u.get().getCommonInitOptions().originalLocale},n}(),rt=i(5),ne=function(){function n(){}return n.prototype.loadStringResource=function(n){var t=rt.a();switch(n){case 5:return t.Floodgate.Nps.Rating.Points11Value0;case 6:return t.Floodgate.Nps.Rating.Points11Value1;case 7:return t.Floodgate.Nps.Rating.Points11Value2;case 8:return t.Floodgate.Nps.Rating.Points11Value3;case 9:return t.Floodgate.Nps.Rating.Points11Value4;case 10:return t.Floodgate.Nps.Rating.Points11Value5;case 11:return t.Floodgate.Nps.Rating.Points11Value6;case 12:return t.Floodgate.Nps.Rating.Points11Value7;case 13:return t.Floodgate.Nps.Rating.Points11Value8;case 14:return t.Floodgate.Nps.Rating.Points11Value9;case 15:return t.Floodgate.Nps.Rating.Points11Value10;case 16:return t.Floodgate.Nps.Rating.Points5Value1;case 17:return t.Floodgate.Nps.Rating.Points5Value2;case 18:return t.Floodgate.Nps.Rating.Points5Value3;case 19:return t.Floodgate.Nps.Rating.Points5Value4;case 20:return t.Floodgate.Nps.Rating.Points5Value5;case 4:return t.Floodgate.Nps.Rating.Question;case 21:return t.Floodgate.Nps.Comment.Question;case 3:return t.Floodgate.Nps.Prompt.No;case 1:return t.Floodgate.Nps.Prompt.Question;case 0:return t.Floodgate.Nps.Prompt.Title;case 2:return t.Floodgate.Nps.Prompt.Yes;default:return""}},n.prototype.getCustomString=function(n){return u.get().getFloodgateInitOptions().uIStringGetter(n)},n}(),dr=i(21),te=function(){function n(){this.loadAsyncTriggered=!1;this.campaignDefinitions=[]}return n.prototype.load=function(){return this.loadAsyncTriggered||(this.loadAsync(),this.loadAsyncTriggered=!0),this.campaignDefinitions||[]},n.prototype.loadAsync=function(){var n=this,t=at().getCampaignDefinitions(),i,r;return t.then(function(t){n.loadCampaignDefinitions(t);n.loadAsyncTriggered=!0}),i=Object(s.a)("TmsLoadTimeout",1e3),r=Object(v.b)(i,t),new Promise(function(t){r.then(function(i){n.loadCampaignDefinitions(i);n.loadAsyncTriggered=!0;t(n.campaignDefinitions)}).catch(function(){n.campaignDefinitions.length<=0&&n.loadCampaignDefinitions(at().getCachedCampaignDefinitions());t(n.campaignDefinitions)}).catch(function(){t(n.campaignDefinitions)})})},n.prototype.loadCampaignDefinitions=function(n){var t=n&&n.campaigns;t&&(this.campaignDefinitions=Object(dr.FilterValidCampaignDefinitions)(t).result)},n}();var ue=function(){function n(){this.loadAsyncTriggered=!1;this.userFacts=[];this.nameAndUserFactMap={}}return n.prototype.load=function(){return this.loadAsyncTriggered||(this.loadAsync(),this.loadAsyncTriggered=!0),this.userFacts||[]},n.prototype.loadAsync=function(){var n=this,t=at().getUserFacts().then(function(t){n.loadUserFacts(t)}),i=Object(s.a)("TulipsLoadTimeout",1e3);return Object(v.b)(i,t).then(function(){return n.userFacts}).catch(function(){return(!n.userFacts||n.userFacts.length<=0)&&n.loadUserFacts(at().getCachedUserFacts()),n.userFacts}).catch(function(){return n.userFacts})},n.prototype.getUserFact=function(n){var t=this.nameAndUserFactMap[n];return t||this.nameAndUserFactMap.hasOwnProperty(n)?t:t=this.nameAndUserFactMap[n]=re(n)},n.prototype.loadUserFacts=function(n){var t=this;n&&(this.userFacts=n||[],this.userFacts.map(function(n){t.nameAndUserFactMap[n.userFactName]=n}),this.loadAsyncTriggered=!0,this.logUserFactInfo(this.userFacts))},n.prototype.logUserFactInfo=function(n){var t,i;if(n&&!(n.length<=0)&&(t=Object(s.a)("TulipsIngestionTimeInterval",864e5),!(t<=0))){try{var u=Date.now(),r=function(n){var i=Date.parse(n);return!!isNaN(i)||u-i>t},e={Count:n.length,RefreshTime:t,IngestionTime:n[0].clientIngestionDateTime,SourcesExpired:n.filter(function(n){return n&&r(n.sourceDateTime)}).length||void 0,StoragesExpired:n.filter(function(n){return n&&r(n.storageDateTime)}).length||void 0,IngestionsExpired:n.filter(function(n){return n&&r(n.clientIngestionDateTime)}).length||void 0};i={Message:"UserFacts",Data:JSON.stringify(e)}}catch(n){i={ErrorMessage:"Error getting UserFact info"}}f.b().logEvent(f.a.UserFacts.Provider.Info.VALUE,3,i)}},n}(),ii=i(16),gr=i(32),vt=i(17),fe=i(40),ee=i.n(fe),y=i(10),nu=function(n){function t(t){var i=n.call(this)||this;return i.simpleRequestEnabled=!1,i.simpleRequestEnabled=null!=t&&t,i}return Object(e.c)(t,n),t.prototype.postRequestWithRetry=function(n,t,i,r){var u=this;return new Promise(function(e,o){u.sendPostRequest(n,t,void 0,!0,r).then(e).catch(function(s){if(f.b().logEvent(f.a.DYNAMICTRANSPORT_POST_ERROR,2,{ErrorMessage:s.toString(),TimeMilliseconds:r,Count:i,CorrelationId:u.requestId}),i<=1)return o(s);u.postRequestWithRetry(n,t,i-1,r).then(e).catch(o)})})},t.prototype.createHeaders=function(n){var t="undefined"!=typeof Headers&&new Headers;return t&&(this.simpleRequestEnabled?this.createSimpleHeaders(t):this.createNormalHeaders(t),Object(y.isNOU)(n)||t.append("Authorization","Bearer "+n)),t},t.prototype.createNormalHeaders=function(n){this.requestId=Object(y.guid)();n.append("X-Request-ID",this.requestId);n.append("Content-Type","application/json")},t.prototype.createSimpleHeaders=function(n){n.append("Content-Type","text/plain")},t}(vr),ut=i(23),oe=new(function(){function n(){this.personalizerEnabled=!1;this.dynamicTransport=new nu;this.personalizerSurveyInformationMap={}}return n.prototype.setup=function(n){this.personalizerEnabled=n.getFloodgateInitOptions().governanceServiceEnabled&&n.getFloodgateInitOptions().personalizerEnabled;this.personalizerEnabled&&(this.isProduction=0===n.getCommonInitOptions().environment,this.retryLimit=n.getFloodgateInitOptions().governanceServiceConfig.retry,this.timeout=n.getFloodgateInitOptions().governanceServiceConfig.timeout,this.requestUrl=this.isProduction?"https://oness.microsoft.com/api/v1.0/Reward":"https://onessppe.microsoft.com/api/v1.0/Reward")},n.prototype.setEventIdAndOverrideValueForSurveyId=function(n,t,i,r){if(!this.personalizerEnabled||o.Utils.isNOU(n)||o.Utils.isNOU(r)||0!==t)return!1;var u=this.validateAndGetAutoDismissTime(i);return!o.Utils.isNOU(u)&&(this.personalizerSurveyInformationMap[r]={eventId:n,recommendedAutoDismissValue:u,userAction:void 0},!0)},n.prototype.getOverrideValueForSurveyId=function(n,t){if(this.personalizerEnabled&&!o.Utils.isNOU(t)&&this.infoExistsForSurveyId(t)&&0===n)return this.personalizerSurveyInformationMap[t].recommendedAutoDismissValue},n.prototype.logUserActionForSurveyAsync=function(n,t,i){return Object(e.b)(this,void 0,void 0,function(){var r,u,s,c,l,h;return Object(e.d)(this,function(e){switch(e.label){case 0:if(!o.Utils.isNOU(n)&&this.infoExistsForSurveyId(t)&&(this.personalizerSurveyInformationMap[t].userAction=n),r={error:!1},u=this.getValidatedActionPayloadForSurveyId(t),o.Utils.isNOU(u))return r.error=!0,r.errorMessage="Action Payload validation failed.",f.b().logEvent(f.a.PERSONALIZER_CLIENTFAILURE,1,{Message:"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: "+r.errorMessage,CampaignId:i,SurveyId:t}),[2,r];e.label=1;case 1:return e.trys.push([1,3,,4]),c=performance.now(),[4,this.dynamicTransport.postRequestWithRetry(this.requestUrl,JSON.stringify(u),this.retryLimit,this.timeout)];case 2:return s=e.sent(),l=performance.now(),f.b().logEvent(f.a.PERSONALIZER_SERVICEREWARDRESULT,1,{TimeMilliseconds:l-c,HttpStatusCode:s.status,HttpStatusText:s.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,CampaignId:i,PersonalizerUserAction:u.UserAction,PersonalizerEventId:u.EventId,SurveyId:t}),s.ok||(r.error=!0,r.errorMessage="Server Error, status: "+s.status+", status text: "+s.statusText),[2,r];case 3:return h=e.sent(),r.error=!0,r.errorMessage="Error: "+h.toString()+", Error stack: "+h.stack,f.b().logEvent(f.a.PERSONALIZER_CLIENTFAILURE,1,{Message:"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: "+r.errorMessage,CampaignId:i,SurveyId:t,PersonalizerUserAction:u.UserAction,PersonalizerEventId:u.EventId}),[2,r];case 4:return[2]}})})},n.prototype.getEventIdForSurveyId=function(n){if(this.infoExistsForSurveyId(n))return this.personalizerSurveyInformationMap[n].eventId},n.prototype.isEnabled=function(n,t,i){return n===l.ISurvey.Type.Fps&&t!==d.d&&"customux"!==t&&i===vt.GovernedChannelType.Standard&&this.personalizerEnabled},n.prototype.getValidatedActionPayloadForSurveyId=function(n){if(this.infoExistsForSurveyId(n)){var t=this.personalizerSurveyInformationMap[n];if(!o.Utils.isNOU(t.eventId)&&!(o.Utils.isNOU(t.userAction)||2!==t.userAction&&0!==t.userAction&&1!==t.userAction))return{UserAction:t.userAction,EventId:t.eventId}}},n.prototype.validateAndGetAutoDismissTime=function(n){if(!o.Utils.isNOU(n)&&"string"==typeof n)switch(parseInt(n,10)){case 0:return 0;case 7:return 1;case 14:return 2;case 21:return 3;case 28:return 4;case 60:return 5;case 90:return 6;case 120:return 7;case 150:return 8;default:return}},n.prototype.infoExistsForSurveyId=function(n){return!o.Utils.isNOU(n)&&!o.Utils.isNOU(this.personalizerSurveyInformationMap[n])},n.prototype.buildConfigTelemetryString=function(){var n={retry:this.retryLimit,timeout:this.timeout};return JSON.stringify(n)},n}());tu=new(function(){function n(){this.personalizerClient=p();this.governanceServiceEnabled=!1;this.forceServicelessSurveyDisplay=!1;this.lastSurveyFailedSync=void 0;this.clientState=ut.GovernanceServiceClientState.Disabled}return n.prototype.setup=function(n){if(this.governanceServiceEnabled=n.getFloodgateInitOptions().governanceServiceEnabled,this.governanceServiceEnabled){if((this.clientInfo={applicationId:n.getCommonInitOptions().appId.toString(),sessionId:n.getCommonInitOptions().sessionId,version:n.getCommonInitOptions().build,surveyPlatform:1,hostPlatform:6,tenantId:n.getCommonInitOptions().telemetryGroup.tenantId,deviceId:n.getCommonInitOptions().telemetryGroup.deviceId,audience:n.getCommonInitOptions().telemetryGroup.audience},this.userId=n.getCommonInitOptions().telemetryGroup.loggableUserId,Object(y.isNOU)(this.clientInfo.sessionId))||Object(y.isNOU)(this.clientInfo.version)||!Object(y.isValidUserId)(this.userId))return void(this.clientState=ut.GovernanceServiceClientState.InitializationFailed);this.forceServicelessSurveyDisplay=n.getFloodgateInitOptions().governanceServiceConfig.forceServicelessSurveyDisplay;this.retryLimit=n.getFloodgateInitOptions().governanceServiceConfig.retry;this.timeout=n.getFloodgateInitOptions().governanceServiceConfig.timeout;this.simpleRequestEnabled=n.getFloodgateInitOptions().governanceServiceConfig.simpleRequestEnabled;this.isProduction=0===n.getCommonInitOptions().environment;this.clientState=ut.GovernanceServiceClientState.Enabled;this.dynamicTransport=new nu(this.simpleRequestEnabled)}},n.prototype.isEnabled=function(n){return this.clientState===ut.GovernanceServiceClientState.Enabled&&this.governanceServiceEnabled&&n===vt.GovernedChannelType.Standard},n.prototype.shouldForceDisplay=function(){return this.forceServicelessSurveyDisplay},n.prototype.getClientInfo=function(){return this.clientInfo},n.prototype.getClientState=function(){return this.clientState},n.prototype.getLastSurveyFailedSync=function(){return this.lastSurveyFailedSync},n.prototype.checkGovernancePermitAsync=function(n,t,i,r){return Object(e.b)(this,void 0,void 0,function(){var p,c,l,o,u,v,w,h,s,a;return Object(e.d)(this,function(e){switch(e.label){case 0:p=(this.isProduction?"https://oness.microsoft.com/api/v1.0/UserSurvey":"https://onessppe.microsoft.com/api/v1.0/UserSurvey")+(this.simpleRequestEnabled?"/SimpleRequest":"");c=this.buildSurveyInfo(n,t,r);l=this.buildBodyRequest(c,i);o={permission:!1,error:!1};e.label=1;case 1:return e.trys.push([1,4,,5]),w=performance.now(),[4,this.dynamicTransport.postRequestWithRetry(p,l,this.retryLimit,this.timeout)];case 2:return u=e.sent(),v=performance.now()-w,h=void 0,u.ok?[4,u.text()]:(this.lastSurveyFailedSync=c,o.errorMessage="Server Error, status: "+u.status+", status text: "+u.statusText,o.error=!0,f.b().logEvent(f.a.GOVERNANCE_SERVICERESULT,1,{TimeMilliseconds:v,HttpStatusCode:u.status,HttpStatusText:u.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,GovernanceRequestBody:l,GovernanceResponseText:h,CampaignId:n.getCampaignId(),SurveyId:n.getSurveyInfo().getId()}),[2,o]);case 3:return h=e.sent(),f.b().logEvent(f.a.GOVERNANCE_SERVICERESULT,1,{TimeMilliseconds:v,HttpStatusCode:u.status,HttpStatusText:u.statusText,AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,GovernanceRequestBody:l,GovernanceResponseText:h,CampaignId:n.getCampaignId(),SurveyId:n.getSurveyInfo().getId()}),(s=JSON.parse(h)).lastTriggerSurveyTime=Object(y.stringToDate)(new Date(s.lastTriggerSurveyTime).toISOString()),Object(y.isNumber)(s.timeUntilNextSurveyAllowed)&&Object(y.isDate)(s.lastTriggerSurveyTime)?(0===s.timeUntilNextSurveyAllowed&&(o.permission=!0,this.personalizerClient.isEnabled(n.getType(),n.getLauncherType(),n.getSurveyInfo().getGovernedChannelType())&&this.personalizerClient.setEventIdAndOverrideValueForSurveyId(this.dynamicTransport.requestId,0,s.actionId,n.getSurveyInfo().getId(),n.getCampaignId())),o.lastTriggerSurvey=s,this.lastSurveyFailedSync=void 0):(o.errorMessage="Service Response is not formatted correctly: "+h,o.error=!0,this.lastSurveyFailedSync=c),[3,5];case 4:return a=e.sent(),this.lastSurveyFailedSync=c,f.b().logEvent(f.a.GOVERNANCE_SERVICEFAILURE,2,{ErrorMessage:a.toString(),AdditionalSurveyInfo:this.buildConfigTelemetryString(),CorrelationId:this.dynamicTransport.requestId,HttpStatusCode:null==u?void 0:u.status,HttpStatusText:null==u?void 0:u.statusText,GovernanceRequestBody:l}),o.error=!0,o.errorMessage="Error: "+a.toString()+", Error stack: "+a.stack,[3,5];case 5:return[2,o]}})})},n.prototype.buildSurveyInfo=function(n,t,i){var u=l.ISurvey.Type[n.getType()],f=ut.GovernanceServiceSurveyType[u],r=new Date,e=this.personalizerClient.isEnabled(n.getType(),n.getLauncherType(),n.getSurveyInfo().getGovernedChannelType());return{surveyId:n.getCampaignId(),surveyTriggerTime:r,surveyType:f,surveyLevelCooldown:t,surveyChannel:i,localOffsetTime:r.getTimezoneOffset(),personalizerEnabled:e}},n.prototype.buildBodyRequest=function(n,t){var i={userId:this.userId,userLevelCooldown:t,survey:n,client:this.clientInfo};return this.simpleRequestEnabled&&(this.dynamicTransport.requestId=Object(v.i)(),i.requestId=this.dynamicTransport.requestId),JSON.stringify(i)},n.prototype.buildConfigTelemetryString=function(){var n={retry:this.retryLimit,timeout:this.timeout,simpleRequestEnabled:this.simpleRequestEnabled};return JSON.stringify(n)},n}());var ft,se,yt=!1,st=0,pt=null,ri=null,wi=null;a.f(function(){return ft});a.j(uu);a.k(fu);var ou,wt,ui,ht,su=i(27),r=i(0),w=i(3),ce=i(34),hu=v.l;fi=[];yu=v.l;pu=i(31);var wu,ei,de=i(52),bu=!1,ki=!1;var fo=function(){function n(n){this.comment="";this.ratingIndex=-1;this.showPrompt=n.showPrompt;this.showEmailRequest=!!v.j(n.showEmailRequest)&&n.showEmailRequest;this.survey=n}return n.prototype.getLauncherType=function(){return this.survey.launcherType},n.prototype.getCVSurveyFormId=function(){return this.survey.customerVoiceFormId},n.prototype.getPreGeneratedClientFeedbackId=function(){},n.prototype.getPromptQuestion=function(){return this.survey.promptQuestion},n.prototype.getTitle=function(){return this.survey.title},n.prototype.getPromptYesButtonText=function(){return this.survey.promptYesButtonText},n.prototype.getPromptNoButtonText=function(){return this.survey.promptNoButtonText},n.prototype.getRatingValuesAscending=function(){return this.survey.ratingValuesAscending},n.prototype.getRatingQuestion=function(){return this.survey.ratingQuestion},n.prototype.getCommentQuestion=function(){return this.survey.commentQuestion},n.prototype.getInterceptTitle=function(){},n.prototype.getInterceptQuestion=function(){},n.prototype.getInterceptUrl=function(){},n.prototype.setValues=function(n,t){this.comment=t;this.ratingIndex=this.isRatingIndexValid(n)?n:-1},n.prototype.getJsonElements=function(){var n={};return n.comment=this.comment,n.rating=this.getNormalizedRatingScore(),n.survey={surveyId:this.getCampaignId()},n},n.prototype.getSurveyType=function(){return this.survey.surveyType},n.prototype.getCampaignId=function(){return this.survey.campaignId},n.prototype.getId=function(){return this.getCampaignId()},n.prototype.getGoverenedChannelType=function(){},n.prototype.isRatingIndexValid=function(n){return n>=0&&n<this.survey.ratingValuesAscending.length},n.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.ratingIndex)?this.survey.isZeroBased?this.ratingIndex/(this.survey.ratingValuesAscending.length-1):(this.ratingIndex+1)/this.survey.ratingValuesAscending.length:-1},n}(),eo=function(){function n(){this.showPrompt=!0;this.showEmailRequest=!0;this.comment=""}return n.prototype.getCVSurveyFormId=function(){return"Form ID"},n.prototype.getLauncherType=function(){return"Launcher Type"},n.prototype.getPromptQuestion=function(){return"Prompt question?"},n.prototype.getTitle=function(){return"Title"},n.prototype.getPromptYesButtonText=function(){return"Yes"},n.prototype.getPromptNoButtonText=function(){return"No"},n.prototype.getRatingValuesAscending=function(){return["worst","worse","ok","better","best"]},n.prototype.getRatingQuestion=function(){return"Rating question?"},n.prototype.getCommentQuestion=function(){return"Comment question?"},n.prototype.getInterceptTitle=function(){return"Intercept Title"},n.prototype.getInterceptQuestion=function(){return"Intercept question?"},n.prototype.getInterceptUrl=function(){return"https://example.com"},n.prototype.setValues=function(n,t){t&&(this.comment=t);v.k(n)&&n>=0&&n<=4&&(this.rating=n/4)},n.prototype.getJsonElements=function(){var n={};return this.comment&&(n.comment=this.comment),this.rating&&(n.rating=this.rating),n},n.prototype.getSurveyType=function(){return l.ISurvey.Type.Nps},n.prototype.getCampaignId=function(){return"10000000-0000-0000-0000-000000000000"},n.prototype.getId=function(){return"00000000-0000-0000-0000-000000000000"},n.prototype.getGoverenedChannelType=function(){return vt.GovernedChannelType.Standard},n.prototype.getPreGeneratedClientFeedbackId=function(){return"00000000-0000-0000-0000-000000000000"},n}(),oo=function(){function n(){}return n.prototype.log_TriggerMet=function(n,t,i,r,u){f.b().logEvent(f.a.SURVEY_FLOODGATE_TRIGGERMET,1,{CampaignId:n,SurveyId:t,SurveyType:i,SurveyActivityInfo:r,AdditionalSurveyInfo:u})},n.prototype.log_UserSelected=function(n,t,i,r){f.b().logEvent(f.a.SURVEY_FLOODGATE_USERSELECTED,1,{CampaignId:n,SurveyId:t,SurveyType:i,AdditionalSurveyInfo:r})},n.prototype.log_CampaignLoad_Failed=function(n){f.b().logEvent(f.a.SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED,2,{ErrorMessage:n})},n.prototype.log_Error=function(n,t){var i={name:n};f.b().logEvent(i,2,{ErrorMessage:t})},n.prototype.log_Event=function(n,t,i){var r={name:n};f.b().logEvent(r,1,t,i)},n.prototype.log_LocalError=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this.log_Local(2,n,i)},n.prototype.log_Local=function(n){for(var i=[],t=2;t<arguments.length;t++)i[t-2]=arguments[t];f.b().logLocal(n,i)},n}(),ct=!1;a.h(du);a.i(nr);a.g(ku);a.c(gu)},function(n,t,i){"use strict";function lr(n){var u=document.getElementById(r.d.MainContainer).querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]"),t,i;if(n.id===r.d.LastTabbable){for(t=0;t<u.length;t++)if((i=u[t]).id!==r.d.FirstTabbable&&vt(i))return void i.focus()}else if(n.id===r.d.FirstTabbable)for(t=u.length-1;t>=0;t--)if((i=u[t]).id!==r.d.LastTabbable&&vt(i))return void i.focus()}function vt(n){if(!n.parentElement)return!1;if(/\S/.test(n.parentElement.id)){if(n.parentElement.className.indexOf(r.c.Visible)>=0)return!0;if(n.parentElement.className.indexOf(r.c.Hidden)>=0)return!1}return vt(n.parentElement)}function ht(n){for(var t=0;t<st.length;t++)st[t]===n?u.k(st[t],r.a.AriaSelected,r.b.True):u.k(st[t],r.a.AriaSelected,r.b.False)}function v(n){u.i(window,"keyup",ei),function(){for(var t,n=0,i=ct;n<i.length;n++)t=i[n],u.m(t.id,t.event,t.listener);ct=[]}();ri(n)}function o(n,t,i){u.g(n,t,i);ct.push({event:t,id:n,listener:i})}function fi(n){ri=n;u.c(window,"keyup",ei);o(r.d.OverlayBackground,"click",vr);o(r.d.MainContainer,"click",yr);o(r.d.MainContainer,"keyup",ar);o(r.d.PrivacyStatementLink,"click",pr);o(r.d.EmailCheckBox,"click",vi);o(r.d.BasicFormComment,"keyup",tu);o(r.d.SingleFormComment,"keyup",iu);vi(null)}function ar(n){(n.keyCode||n.which)===r.e.Tab&&(document.activeElement.id===r.d.FirstTabbable&&n.shiftKey||document.activeElement.id===r.d.LastTabbable&&!n.shiftKey)&&(n.stopPropagation(),lr(document.activeElement))}function ei(n){n.keyCode===r.e.Esc&&(n.preventDefault(),n.stopPropagation(),v(!1))}function vr(n){n.preventDefault();n.stopPropagation();v(!1)}function yr(n){n.stopPropagation()}function pr(n){n.stopPropagation()}function ut(n,t){var i,f;if((n.preventDefault(),n.stopPropagation(),u.j(r.d.OverallSmileAnchor,r.c.OverallAnchorActive),u.j(r.d.OverallFrownAnchor,r.c.OverallAnchorActive),u.j(r.d.OverallIdeaAnchor,r.c.OverallAnchorActive),u.j(r.d.OverallBugAnchor,r.c.OverallAnchorActive),t&&u.b(t,r.c.OverallAnchorActive),c.b().logEvent(c.a.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:l,PanelType:a}),void 0!==l)&&(u.l(r.d.LeftFormContainer,!0),u.l(r.d.MiddleFormContainer,!0),u.l(r.d.LeftPanelContainer,!1),i=rt[l],si(i.containerId),yt&&si(i.containerId),i.onSelect(l)),void 0!==a){for(f in u.l(r.d.LeftFormContainer,!1),u.l(r.d.MiddleFormContainer,!1),u.l(r.d.LeftPanelContainer,!0),g)g.hasOwnProperty(f)&&u.l(g[f].containerId,!0);g[a].onSelect(a)}}function wr(n){l=s.b.Smile;a=void 0;ht(r.d.OverallSmileAnchor);u.k(r.d.MiddleFormContainer,r.a.AriaExpanded,r.b.True);u.k(r.d.MiddleFormContainer,r.a.AriaLabelledBy,r.d.OverallSmileAnchor);ut(n,r.d.OverallSmileAnchor)}function br(n){l=s.b.Frown;a=void 0;ht(r.d.OverallFrownAnchor);u.k(r.d.MiddleFormContainer,r.a.AriaExpanded,r.b.True);u.k(r.d.MiddleFormContainer,r.a.AriaLabelledBy,r.d.OverallFrownAnchor);ut(n,r.d.OverallFrownAnchor)}function kr(n){l=s.b.Idea;a=void 0;ht(r.d.OverallIdeaAnchor);u.k(r.d.MiddleFormContainer,r.a.AriaExpanded,r.b.True);u.k(r.d.MiddleFormContainer,r.a.AriaLabelledBy,r.d.OverallIdeaAnchor);ut(n,r.d.OverallIdeaAnchor)}function dr(n){l=s.b.Bug;a=void 0;ht(r.d.OverallBugAnchor);u.k(r.d.MiddleFormContainer,r.a.AriaExpanded,r.b.True);u.k(r.d.MiddleFormContainer,r.a.AriaLabelledBy,r.d.OverallBugAnchor);ut(n,r.d.OverallBugAnchor)}function oi(n,t){u.l(r.d.LeftFormContainer,t);for(var f=document.getElementById(r.d.MiddleFormContainer).children,i=0;i<f.length;i++)f[i].id!==n&&u.l(f[i].id,t)}function si(n){for(var t in rt)rt.hasOwnProperty(t)&&u.l(rt[t].containerId,!1);ui?(u.l(r.d.LeftFormContainer,!1),u.l(r.d.MiddleFormContainer,!0),u.l(n,!0)):(u.b(r.d.ColumnSeparatorDiv,r.c.ShowRightBorder),u.l(r.d.MiddleFormContainer,!0),u.l(n,!0),u.b(r.d.LeftFormContainer,r.c.SlideLeft),u.b(r.d.MiddleFormContainer,r.c.SlideLeft))}function hi(n,t,i,f,o,s,h){return function(s){var k;s.preventDefault();s.stopPropagation();u.l(n,!1);var it=new cr.a(t),y=new sr.a(e.get().getCommonInitOptions().environment,"Sas",e.get().getCommonInitOptions().appId,l,e.get().getCommonInitOptions().applicationGroup,e.get().getCommonInitOptions().telemetryGroup,e.get().getCommonInitOptions().webGroup),p=document.getElementById(i);p&&!!p.value&&y.setComment(p.value);var d=document.getElementById(r.d.EmailCheckBox),w=document.getElementById(f),g=w&&!!w.value;d&&d.checked&&g&&y.setEmail(w.value);var nt=document.getElementById(o),tt=nt&&nt.checked,b=document.getElementById(h);(b&&b.selectedIndex>0&&y.setCategory(b.value),c.b().logEvent(c.a.InApp.UI.Form.Submit.VALUE,1,{FeedbackType:l,IsEmailIncluded:g,IsScreenshotIncluded:tt}),tt)?(k=performance.now(),hr.a(document.body).then(function(n){var t=performance.now();c.b().logEvent(c.a.Shared.Screenshot.Render.Success.VALUE,1,{TimeMilliseconds:t-k});y.setScreenshot(n);y.submit()}).catch(function(n){var t=performance.now();c.b().logEvent(c.a.Shared.Screenshot.Render.Failed.VALUE,2,{ErrorMessage:n,TimeMilliseconds:t-k});y.submit()})):y.submit();it.destroy();e.get().getInAppFeedbackInitOptions().isShowThanks?function(n){l=void 0;a=0;oi(r.d.ThanksPanelContainer,!1);ut(n,void 0)}(s):v(!0)}}function ci(n,t){oi(r.d.ThanksPanelContainer,!0);v(t)}function gr(n){n.preventDefault();n.stopPropagation();window.open(document.getElementById(r.d.UserVoiceFormGoButton).getAttribute(r.a.Source));v(!1)}function nu(n){n.preventDefault();n.stopPropagation();window.open(e.get().getInAppFeedbackInitOptions().feedbackForumUrl);v(!1)}function li(n,t){return function(){u.a(n,t)}}function ai(){v(!1)}function vi(){var t=document.getElementById(r.d.EmailCheckBox),n;t&&(n=document.getElementById(r.d.SingleFormEmailInput),n||(n=document.getElementById(r.d.BasicFormEmailInput)),n.value=t.checked?e.get().getCommonInitOptions().userEmail:null,n.disabled=!t.checked)}function tu(){var n=document.getElementById(r.d.BasicFormComment),t=n&&!!n.value;document.getElementById(r.d.BasicFormSubmitButton).disabled=!t}function iu(){var n=document.getElementById(r.d.SingleFormComment),t=n&&!!n.value;document.getElementById(r.d.SingleFormSubmitButton).disabled=!t}function yi(n){for(var e,o=n||[],i=[{attributes:[{name:"selected",value:"true"}],innerText:f.a().Form.CategoryPlaceholder,tag:r.h.Option}],t=0,u=o;t<u.length;t++)e=u[t],i.push({innerText:e,tag:r.h.Option});return i}function wi(n){return{children:[ru,{attributes:[{name:r.a.Type,value:"radio"},{name:r.a.Name,value:n},{name:r.a.Value,value:"1"}],tag:r.h.Input},uu,{attributes:[{name:r.a.Type,value:"radio"},{name:r.a.Name,value:n},{name:r.a.Value,value:"2"}],tag:r.h.Input},fu,{attributes:[{name:r.a.Type,value:"radio"},{name:r.a.Name,value:n},{name:r.a.Value,value:"3"}],tag:r.h.Input},eu,{attributes:[{name:r.a.Type,value:"radio"},{name:r.a.Name,value:n},{name:r.a.Value,value:"4"}],tag:r.h.Input},ou,{attributes:[{name:r.a.Type,value:"radio"},{name:r.a.Name,value:n},{name:r.a.Value,value:"5"}],tag:r.h.Input},su],classes:[r.c.Rating],id:n,tag:r.h.Span}}function hu(){var n=e.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:r.a.For,value:r.d.BasicFormComment}],classes:[r.c.FontSubtitle,r.c.TextAlignLeft,r.c.FormQuestionMiddleText],id:r.d.BasicFormQuestionMiddleText,tag:r.h.Label,innerText:e.get().getInAppFeedbackInitOptions().transitionEnabled?"":f.a().SingleForm.Title},{attributes:[{name:r.a.Id,value:r.d.BasicFormCategoriesDropdown},{name:r.a.AriaLabel,value:f.a().Form.CategoryPlaceholder}],brs:n.show,children:yi(n?n.customCategories:null),classes:[r.c.FontSubText,r.c.FormCategoriesDropdown,r.c.TextInput],tag:r.h.Select},{attributes:[{name:r.a.Placeholder,value:f.a().Form.CommentPlaceholder},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength}],classes:[r.c.FontSubText,r.c.FormComment,r.c.TextInput],id:r.d.BasicFormComment,tag:r.h.TextArea},{brs:!1,children:[{attributes:[{name:r.a.For,value:r.d.BasicFormRating}],classes:[r.c.FontText,r.c.TextAlignLeft,r.c.FormRatingLabel],innerText:f.a().Form.RatingLabel,tag:r.h.Label},wi(r.d.BasicFormRating)],classes:[r.c.FormRatingContainer]},{brs:bt(),children:[{attributes:[{name:r.a.Type,value:r.b.Checkbox},{name:r.b.Unchecked,value:""}],classes:[r.c.FormEmailCheckBox,r.c.CheckBox],id:r.d.EmailCheckBox,tag:r.h.Input},{attributes:[{name:r.a.For,value:r.d.EmailCheckBox}],classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.FormEmailLabel],innerText:f.a().Form.EmailCheckBoxLabel,tag:r.h.Label},{attributes:[{name:r.a.Type,value:r.b.Text},{name:r.a.Placeholder,value:f.a().Form.EmailPlaceholder},{name:r.a.AriaLabel,value:f.a().Form.EmailPlaceholder},{name:r.a.Name,value:r.d.BasicFormEmailInput},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength},{name:r.a.Value,value:e.get().getInAppFeedbackInitOptions().userEmail?e.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[r.c.FontSubText,r.c.FormEmailInput,r.c.TextInput],id:r.d.BasicFormEmailInput,tag:r.h.Input}],classes:[r.c.FormEmailContainer]},{children:[{attributes:[{name:r.a.Type,value:r.b.Checkbox},{name:r.a.Value,value:r.b.Unchecked}],brs:et(),classes:[r.c.FormScreenshotCheckbox,r.c.CheckBox],id:r.d.BasicFormScreenshotCheckbox,tag:r.h.Input},{attributes:[{name:r.a.For,value:r.d.BasicFormScreenshotCheckbox}],brs:et(),classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.FormScreenshotLabel],innerText:f.a().Form.ScreenshotLabel,tag:r.h.Label},{attributes:[{name:r.a.Preview,value:r.b.ScreenshotPreview},{name:r.a.Alt,value:f.a().Form.ScreenshotImgAltText}],brs:e.get().getInAppFeedbackInitOptions().screenshot,id:r.d.BasicFormScreenshotPreview,classes:[r.c.FormScreenshotPreview],tag:r.h.Img}],classes:[r.c.FormScreenshotContainer]},{children:[{classes:[r.c.FontSubSubText,r.c.TextAlignLeft],innerText:f.a().Form.PrivacyLabel,tag:r.h.Label},{classes:[r.c.FontSubSubText,r.c.TextAlignLeft],innerText:e.get().getCommonInitOptions().isCommercialHost?f.a().Form.PrivacyConsent+" ":"",tag:r.h.Label},{attributes:[{name:r.a.HRef,value:r.i.PrivacyStatementLink},{name:r.a.Target,value:r.b.BlankWindow},{name:r.a.Rel,value:r.b.NoReferrer}],classes:[r.c.Link],id:r.d.PrivacyStatementLink,innerText:f.a().PrivacyStatement,tag:r.h.Anchor}],classes:[r.c.FontSubSubText,r.c.TextAlignLeft,r.c.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.AriaLabel,value:f.a().Form.Cancel}],classes:[r.c.CancelButton],id:r.d.BasicFormCancelButton,innerText:f.a().Form.Cancel,tag:r.h.Button},{attributes:[{name:r.a.Disabled,value:r.b.True}],classes:[r.c.SubmitButton],id:r.d.BasicFormSubmitButton,innerText:f.a().Form.Submit,tag:r.h.Button},{classes:[r.c.Spinner,r.c.Hidden],id:r.d.BasicFormSubmitButtonSpinner,tag:r.h.Div}],classes:[r.c.FormSubmitButtonContainer]}],classes:[e.get().getInAppFeedbackInitOptions().transitionEnabled?r.c.Hidden:r.c.Visible,r.c.MarginLeft60px],id:wt}}function cu(n){switch(n){case s.b.Smile:document.getElementById(r.d.BasicFormQuestionMiddleText).textContent=f.a().SmileForm.Title;break;case s.b.Frown:document.getElementById(r.d.BasicFormQuestionMiddleText).textContent=f.a().FrownForm.Title;break;case s.b.Idea:document.getElementById(r.d.BasicFormQuestionMiddleText).textContent=f.a().IdeaForm.Title;break;case s.b.Bug:document.getElementById(r.d.BasicFormQuestionMiddleText).textContent=f.a().BugForm.Title}document.getElementById(r.d.BasicFormComment).focus()}function bt(){return!!e.get().getInAppFeedbackInitOptions().showEmailAddress&&(!e.get().getCommonInitOptions().isCommercialHost||1===e.get().getCommonInitOptions().emailPolicyValue)}function et(){return!!e.get().getInAppFeedbackInitOptions().screenshot&&(!e.get().getCommonInitOptions().isCommercialHost||1===e.get().getCommonInitOptions().screenshotPolicyValue)}function lu(n){var i={children:[]},r={};for(var t in n)n.hasOwnProperty(t)&&(n[t].containerId in r||(i.children.push(n[t].generate()),r[n[t].containerId]=!0));return i.children}function di(n){var i={children:[]},r={};for(var t in n)n.hasOwnProperty(t)&&(n[t].containerId in r||(i.children.push(n[t].generate()),r[n[t].containerId]=!0));return i.children}function au(n){var t={children:[]};return s.b.Smile in n&&t.children.push(ot(r.d.OverallSmileAnchor,r.d.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/><\/svg>',r.d.OverallSmileText,f.a().SmileForm.Anchor)),s.b.Frown in n&&t.children.push(ot(r.d.OverallFrownAnchor,r.d.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/><\/svg>',r.d.OverallFrownText,f.a().FrownForm.Anchor)),s.b.IdeaRedirect in n&&t.children.push(ot(r.d.OverallFeedbackPortalIdeaAnchor,r.d.OverallIdeaImage,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" focusable="false" viewBox="0,0,2048,2048"><path fill="#FAFAFA" fill-opacity="1.000" d="M 213 1920 v -546 l 275 -649 h 1072 l 275 649 v 546 z" /><path fill="#3A3A38" fill-opacity="1.000" d="M 1877 1365 v 598 h -1706 v -598 l 289 -682 h 288 l -41 41 l 44 44 h -239 l -248 597 h 1520 l -221 -532 l 63 -62 m 166 680 h -1536 v 426 h 1536 z" /><path fill="#FAFAFA" fill-opacity="1.000" d="M 1049 1067 l -342 -343 l 664 -664 l 482 483 l -523 524 z" /><path fill="#797774" fill-opacity="1.000" d="M 1536 649 l -271 -272 l 60 -60 l 272 271 m -211 212 l -272 -272 l 60 -60 l 272 271 m -211 211 l -272 -271 l 61 -61 l 271 272 z" /><path fill="#1E8BCD" fill-opacity="1.000" d="M 989 1067 l -343 -343 l 725 -724 l 543 543 l -524 524 h -121 l 524 -524 l -422 -422 l -604 603 l 343 343 z" /><path fill="#3A3A38" fill-opacity="1.000" d="M 1451 1109 h -854 v -85 h 854 z" /><\/svg>',r.d.OverallIdeaText,f.a().IdeaForm.Anchor)),s.b.Idea in n&&t.children.push(ot(r.d.OverallIdeaAnchor,r.d.OverallIdeaImage,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" focusable="false" viewBox="0,0,2048,2048"><path fill="#FAFAFA" fill-opacity="1.000" d="M 213 1920 v -546 l 275 -649 h 1072 l 275 649 v 546 z" /><path fill="#3A3A38" fill-opacity="1.000" d="M 1877 1365 v 598 h -1706 v -598 l 289 -682 h 288 l -41 41 l 44 44 h -239 l -248 597 h 1520 l -221 -532 l 63 -62 m 166 680 h -1536 v 426 h 1536 z" /><path fill="#FAFAFA" fill-opacity="1.000" d="M 1049 1067 l -342 -343 l 664 -664 l 482 483 l -523 524 z" /><path fill="#797774" fill-opacity="1.000" d="M 1536 649 l -271 -272 l 60 -60 l 272 271 m -211 212 l -272 -272 l 60 -60 l 272 271 m -211 211 l -272 -271 l 61 -61 l 271 272 z" /><path fill="#1E8BCD" fill-opacity="1.000" d="M 989 1067 l -343 -343 l 725 -724 l 543 543 l -524 524 h -121 l 524 -524 l -422 -422 l -604 603 l 343 343 z" /><path fill="#3A3A38" fill-opacity="1.000" d="M 1451 1109 h -854 v -85 h 854 z" /><\/svg>',r.d.OverallIdeaText,f.a().IdeaForm.Anchor)),s.b.Bug in n&&t.children.push(ot(r.d.OverallBugAnchor,r.d.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/><\/svg>',r.d.OverallBugText,f.a().BugForm.Anchor)),t.children}function ot(n,t,i,u,f){return{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.Role,value:r.b.Tab},{name:r.a.AriaLabel,value:f},{name:r.a.AriaSelected,value:r.b.False}],children:[{classes:[r.c.OverallImage],id:t,innerHTML:i,tag:r.h.Div},{classes:[r.c.FontSubtitle,r.c.OverallText],id:u,innerText:f}],classes:[r.c.OverallAnchor,r.c.TextAlignLeft],id:n,tag:r.h.Button}}function vu(){var n,t,i,u,o,s,h,c=e.get().getCommonInitOptions().primaryColour;return{children:[{tag:r.h.Div,id:r.d.ThanksPanelInnerContainer,children:[{id:r.d.ThanksPanelDiscussion,innerHTML:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30.4 25.3"\n\trole="presentation" alt="" tabindex="-1" focusable="false">\n\t<defs>\n\t\t<style>\n\t\t\t.cls-1,.cls-3{isolation:isolate;}\n\t\t\t.cls-2{fill:#e1dfdd;}\n\t\t\t.cls-3{fill:'+c+';opacity:0.4;}\n\t\t\t.cls-4{fill:#c8c6c4;mix-blend-mode:multiply;}\n\t\t\t.cls-5{fill:#fff;}<\/style>\n\t<\/defs>\n\t<title>commentsOffice<\/title>\n\t<g class="cls-1">\n\t\t<g id="Layer_1" data-name="Layer 1">\n\t\t\t<path class="cls-2" d="M17.8,0H1.2A1.216,1.216,0,0,0,0,1.2V15.3a1.1554,1.1554,0,0,0,1.2,1.2H7l.1,\n\t\t\t\t4.1L10,16.5h7.9a1.1554,1.1554,0,0,0,1.2-1.2V1.2A1.305,1.305,0,0,0,17.8,0Z"/>\n\t\t\t<path class="cls-3" d="M28.5,10.8a6.0429,6.0429,0,0,0-3.2-2,7.1943,7.1943,0,0,0-6.4,1,7.4884,\n\t\t\t\t7.4884,0,0,0-3.1,5.7,6.016,6.016,0,0,0,.9,3.7,6.9394,6.9394,0,0,0,5,3.7l2.9,2.4L24.4,23a7.8372,\n\t\t\t\t7.8372,0,0,0,3-1.3,7.4574,7.4574,0,0,0,3-4.7A7.5076,7.5076,0,0,0,28.5,10.8Z"/>\n\t\t\t<path id="Layer2_1_MEMBER_1_FILL" data-name="Layer2 1 MEMBER 1 FILL" class="cls-4" d="M11.9885,\n\t\t\t\t8.0154a.8939.8939,0,1,0,.6371-.2589.8653.8653,0,0,0-.6371.2589M6.8115,9.24A.8977.8977,0,1,0,\n\t\t\t\t5.5532,7.9589.8977.8977,0,1,0,6.8115,9.24m3.2259-1.2412a.894.894,0,1,0,.2588.637A.8653.8653,\n\t\t\t\t0,0,0,10.0374,7.9983Z"/>\n\t\t\t<path class="cls-5" d="M20.9019,16.3243a.8008.8008,0,0,0,.2586-.5659.8371.8371,0,0,\n\t\t\t\t0-.21-.5919.7693.7693,0,0,0-1.1091-.05.8379.8379,0,0,0-.2627.5706.8012.8012,0,0,0,\n\t\t\t\t.2066.5869.77.77,0,0,0,1.1167.05m1.51-.51a.8014.8014,0,0,0,.2066.5874.7695.7695,0,0,0,\n\t\t\t\t1.1127.0541.8379.8379,0,0,0,.2627-.57.8009.8009,0,0,0-.2066-.5869.7694.7694,0,0,\n\t\t\t\t0-1.1167-.05.8011.8011,0,0,0-.2587.5663m2.8279.1272a.8371.8371,0,0,0,.21.5919.7693.7693,0,0,\n\t\t\t\t0,1.1091.05.8379.8379,0,0,0,.2627-.5706.8012.8012,0,0,0-.2066-.5869.77.77,0,0,\n\t\t\t\t0-1.1167-.05A.8008.8008,0,0,0,25.24,15.9416Z"/>\n\t\t<\/g>\n\t<\/g>\n<\/svg>',tag:r.h.Div},{id:r.d.ThanksPanelVerticalContainer,tag:r.h.Div,children:[{classes:[r.c.FontTitle,r.c.TextAlignLeft,r.c.FormQuestionMiddleText,r.c.ThanksPanelTitle],innerText:null===(n=f.a().ThanksPanel)||void 0===n?void 0:n.Title,tag:r.h.Div},{classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.ThanksPanelMessage],innerText:null===(t=f.a().ThanksPanel)||void 0===t?void 0:t.AppreciateText,tag:r.h.Div},{classes:[r.c.SubmitButton],id:r.d.ThanksPanelCloseButton,innerText:null===(i=f.a().ThanksPanel)||void 0===i?void 0:i.Close,ariaLabel:null===(u=f.a().ThanksPanel)||void 0===u?void 0:u.Close,tag:r.h.Button,role:r.g.Button,attributes:[{name:"aria-label",value:(null===(o=f.a().ThanksPanel)||void 0===o?void 0:o.Title)+" "+(null===(s=f.a().ThanksPanel)||void 0===s?void 0:s.AppreciateText)+" "+(null===(h=f.a().ThanksPanel)||void 0===h?void 0:h.Close)},{name:"type",value:"button"}]}]}]}],classes:[r.c.Hidden],id:dt}}function yu(n){0===n&&document.getElementById(r.d.ThanksPanelCloseButton).focus()}function pu(){var n=e.get().getInAppFeedbackInitOptions().userVoice;return{children:[{classes:[r.c.FontSubtitle,r.c.TextAlignLeft,r.c.FormQuestionMiddleText],innerText:f.a().UserVoiceForm.Title},{classes:[r.c.FontText,r.c.TextAlignLeft,r.c.FormMiddleText],innerText:f.a().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:r.a.Source,value:n.url}],classes:[r.c.SubmitButton],id:r.d.UserVoiceFormGoButton,innerText:f.a().UserVoiceForm.Button,tag:r.h.Button}],classes:[r.c.FormSubmitButtonContainer]}],classes:[r.c.FormBottomContainer]}],classes:[r.c.Hidden,r.c.MarginLeft60px],id:gt}}function wu(){document.getElementById(r.d.UserVoiceFormGoButton).focus()}function bu(){}function ku(){}function du(n){var i={},t,a,c,l;e.get().getInAppFeedbackInitOptions().isShowThanks&&(i[0]=p);t={};a=e.get().getInAppFeedbackInitOptions().transitionEnabled;t[s.b.Smile]=h;t[s.b.Frown]=h;void 0!==e.get().getInAppFeedbackInitOptions().feedbackForumUrl?t[s.b.IdeaRedirect]=k:t[s.b.Idea]=e.get().getInAppFeedbackInitOptions().userVoice&&"en"===e.get().getCommonInitOptions().locale?b:h;e.get().getInAppFeedbackInitOptions().bugForm&&(t[s.b.Bug]=h);rr(kt.a(function(n,t){return{attributes:[{name:r.a.DataHtml2CanvasIgnore,value:r.b.True}],children:[{attributes:[{name:r.a.Role,value:r.b.Dialog},{name:r.a.AriaModal,value:r.b.True}],children:[{attributes:[{name:r.a.Role,value:r.b.TabList},{name:r.a.AriaDescribedBy,value:r.d.QuestionLeftText},{name:r.a.AriaLabel,value:f.a().FeedbackSubtitle},{name:r.a.AriaOrientation,value:r.b.AriaOrientationValueVertical}],children:[{attributes:[{name:r.a.TabIndex,value:r.b.Zero}],id:r.d.FirstTabbable},{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.AriaLabel,value:f.a().CloseLabel}],id:r.d.CloseButton,classes:[r.c.CloseButton],innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z"/><\/svg>',tag:r.h.Button},{children:[{classes:[r.c.FormWideContainer,r.c.Hidden],children:di(t),id:r.d.LeftPanelContainer,tag:r.h.Div},{children:[{classes:[r.c.FontSubtitle,r.c.TextAlignLeft],id:r.d.QuestionLeftText,innerText:f.a().FeedbackSubtitle},{children:[{children:au(n),id:r.d.OverallAnchorsContainer}],id:r.d.ColumnSeparatorDiv}],classes:[r.c.FormContainer],id:r.d.LeftFormContainer},{children:lu(n),classes:[r.c.FormContainer,e.get().getInAppFeedbackInitOptions().transitionEnabled?r.c.Hidden:r.c.Visible],attributes:[{name:r.a.Role,value:r.b.TabPanel},{name:r.a.AriaExpanded,value:r.b.False}],id:r.d.MiddleFormContainer}],classes:[r.c.Hidden],id:r.d.MainContentHolder,tag:r.h.Form},{attributes:[{name:r.a.TabIndex,value:r.b.Zero}],id:r.d.LastTabbable}],id:r.d.MainContainer}],classes:[u.f()?r.c.Rtl:""],id:r.d.OverlayBackground}]}}(t,i)));l=!window.innerWidth||window.innerWidth<800;void 0===(c=function(t){u.l(r.d.OverlayBackground,!1);u.d(r.d.OverlayBackground);e.get().getInAppFeedbackInitOptions().onDismiss(t);n()})&&(c=function(){});ui=l;rt=t;g=i;yt=a;o(r.d.OverallSmileAnchor,"click",wr);o(r.d.OverallFrownAnchor,"click",br);o(r.d.OverallIdeaAnchor,"click",kr);o(r.d.OverallBugAnchor,"click",dr);o(r.d.CloseButton,"click",function(){v(!1)});o(r.d.BasicFormSubmitButton,"click",hi(r.d.BasicFormSubmitButton,r.d.BasicFormSubmitButtonSpinner,r.d.BasicFormComment,r.d.BasicFormEmailInput,r.d.BasicFormScreenshotCheckbox,r.d.BasicFormScreenshotPreview,r.d.BasicFormCategoriesDropdown));o(r.d.BasicFormScreenshotCheckbox,"click",li(r.d.BasicFormScreenshotCheckbox,r.d.BasicFormScreenshotPreview));o(r.d.UserVoiceFormGoButton,"click",gr);o(r.d.OverallFeedbackPortalIdeaAnchor,"click",nu);o(r.d.ThanksPanelCloseButton,"click",function(){return ci(0,!0)});o(r.d.BasicFormCancelButton,"click",ai);fi(c);yt||(u.b(r.d.MainContentHolder,r.c.MarginLeft180px),u.b(r.d.ColumnSeparatorDiv,r.c.ShowRightBorder));l&&u.b(r.d.OverlayBackground,r.c.NarrowLayout)}function gu(n,t){var i={};e.get().getInAppFeedbackInitOptions().isShowThanks&&(i[0]=p);rr(kt.a(function(n){var t;return{attributes:[{name:r.a.DataHtml2CanvasIgnore,value:r.b.True}],children:[{children:[{attributes:[{name:r.a.TabIndex,value:r.b.Zero}],id:r.d.FirstTabbable},{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.AriaLabel,value:f.a().CloseLabel}],id:r.d.CloseButton,classes:[r.c.CloseButton],innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z"/><\/svg>',tag:r.h.Button},{children:[{children:[(t=e.get().getInAppFeedbackLaunchOptions().categories,{children:[{attributes:[{name:r.a.For,value:r.d.SingleFormComment}],classes:[r.c.FontSubtitle,r.c.TextAlignLeft,r.c.FormQuestionMiddleText],id:r.d.SingleFormQuestionMiddleText,innerText:f.a().SingleForm.Title,tag:r.h.Label},{attributes:[{name:r.a.Id,value:r.d.SingleFormCategoriesDropdown}],brs:t.show,children:yi(t?t.customCategories:null),classes:[r.c.FontSubText,r.c.FormCategoriesDropdown,r.c.TextInput],tag:r.h.Select},{attributes:[{name:r.a.Placeholder,value:f.a().Form.CommentPlaceholder},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength}],classes:[r.c.FontSubText,r.c.FormComment,r.c.TextInput],id:r.d.SingleFormComment,tag:r.h.TextArea},{brs:!1,children:[{attributes:[{name:r.a.For,value:r.d.SingleFormRating}],classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.FormRatingLabel],innerText:f.a().Form.RatingLabel,tag:r.h.Label},wi(r.d.SingleFormRating)],classes:[r.c.FormRatingContainer]},{brs:bt(),children:[{attributes:[{name:r.a.Type,value:r.b.Checkbox},{name:r.b.Unchecked,value:""}],classes:[r.c.FormEmailCheckBox,r.c.CheckBox],id:r.d.EmailCheckBox,tag:r.h.Input},{attributes:[{name:r.a.For,value:r.d.EmailCheckBox}],classes:[r.c.FontSubText,r.c.TextAlignLeft,r.c.FormEmailLabel],innerText:f.a().Form.EmailCheckBoxLabel,tag:r.h.Label},{attributes:[{name:r.a.Type,value:r.b.Text},{name:r.a.Placeholder,value:f.a().Form.EmailPlaceholder},{name:r.a.AriaLabel,value:f.a().Form.EmailPlaceholder},{name:r.a.Name,value:r.d.SingleFormEmailInput},{name:r.a.MaxLength,value:r.b.TextAreaMaxLength},{name:r.a.Value,value:e.get().getInAppFeedbackInitOptions().userEmail?e.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[r.c.FontSubText,r.c.FormEmailInput,r.c.TextInput],id:r.d.SingleFormEmailInput,tag:r.h.Input}],classes:[r.c.FormEmailContainer]},{children:[{attributes:[{name:r.a.Type,value:r.b.Checkbox},{name:r.a.Value,value:r.b.Unchecked}],brs:et(),classes:[r.c.FormScreenshotCheckbox,r.c.CheckBox],id:r.d.SingleFormScreenshotCheckbox,tag:r.h.Input},{attributes:[{name:r.a.For,value:r.d.SingleFormScreenshotCheckbox}],brs:et(),classes:[r.c.FontText,r.c.TextAlignLeft,r.c.FormScreenshotLabel],innerText:f.a().Form.ScreenshotLabel,tag:r.h.Label},{attributes:[{name:r.a.Preview,value:r.b.ScreenshotPreview}],brs:e.get().getInAppFeedbackInitOptions().screenshot,id:r.d.SingleFormScreenshotPreview,classes:[r.c.FormScreenshotPreview],tag:r.h.Img}],classes:[r.c.FormScreenshotContainer]},{children:[{classes:[r.c.FontSubSubText,r.c.TextAlignLeft],innerText:f.a().Form.PrivacyLabel,tag:r.h.Label},{classes:[r.c.FontSubSubText,r.c.TextAlignLeft],innerText:e.get().getCommonInitOptions().isCommercialHost?f.a().Form.PrivacyConsent+" ":"",tag:r.h.Label},{attributes:[{name:r.a.HRef,value:r.i.PrivacyStatementLink},{name:r.a.Target,value:r.b.BlankWindow},{name:r.a.Rel,value:r.b.NoReferrer}],classes:[r.c.Link],id:r.d.PrivacyStatementLink,innerText:f.a().PrivacyStatement,tag:r.h.Anchor}],classes:[r.c.FontSubSubText,r.c.TextAlignLeft,r.c.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:r.a.Type,value:r.b.Button},{name:r.a.AriaLabel,value:f.a().Form.Cancel}],classes:[r.c.CancelButton],id:r.d.SingleFormCancelButton,innerText:f.a().Form.Cancel,tag:r.h.Button},{attributes:[{name:r.a.Disabled,value:r.b.True}],classes:[r.c.SubmitButton],id:r.d.SingleFormSubmitButton,innerText:f.a().Form.Submit,tag:r.h.Button},{classes:[r.c.Spinner,r.c.Hidden],id:r.d.SingleFormSubmitButtonSpinner,tag:r.h.Div}],classes:[r.c.FormSubmitButtonContainer]}],id:ki})],classes:[r.c.FormContainer],id:r.d.MiddleFormContainer}].concat(di(n)),classes:[r.c.Hidden],id:r.d.MainContentHolder,tag:r.h.Form},{attributes:[{name:r.a.TabIndex,value:r.b.Zero}],id:r.d.LastTabbable}],id:r.d.MainContainer}],classes:[r.c.SingleLayout,u.f()?r.c.Rtl:""],id:r.d.OverlayBackground}}(i))),function(n,t,i){void 0===i&&(i=function(){});l=n;g=t;o(r.d.SingleFormSubmitButton,"click",hi(r.d.SingleFormSubmitButton,r.d.SingleFormSubmitButtonSpinner,r.d.SingleFormComment,r.d.SingleFormEmailInput,r.d.SingleFormScreenshotCheckbox,r.d.SingleFormScreenshotPreview,r.d.SingleFormCategoriesDropdown));o(r.d.SingleFormScreenshotCheckbox,"click",li(r.d.SingleFormScreenshotCheckbox,r.d.SingleFormScreenshotPreview));o(r.d.CloseButton,"click",function(){v(!1)});o(r.d.ThanksPanelCloseButton,"click",function(n){return ci(n,!0)});o(r.d.SingleFormCancelButton,"click",ai);fi(i)}(t,i,function(t){u.l(r.d.OverlayBackground,!1);u.d(r.d.OverlayBackground);e.get().getInAppFeedbackInitOptions().onDismiss(t);n()});u.b(r.d.OverlayBackground,r.c.SingleLayout);u.a(r.d.SingleFormScreenshotCheckbox,r.d.SingleFormScreenshotPreview)}function rr(n){document.body.insertBefore(n,document.body.firstChild);u.l(r.d.OverlayBackground,!0);u.e()>9||-1===u.e()?setTimeout(ur,900):ur()}function ur(){u.l(r.d.MainContentHolder,!0);document.getElementById(r.d.OverallSmileAnchor)?(document.getElementById(r.d.OverallSmileAnchor).focus(),u.a(r.d.BasicFormScreenshotCheckbox,r.d.BasicFormScreenshotPreview)):document.getElementById(r.d.SingleFormComment)&&(document.getElementById(r.d.SingleFormComment).focus(),u.a(r.d.SingleFormScreenshotCheckbox,r.d.SingleFormScreenshotPreview))}function ni(){return new Promise(function(n,t){if(at)n();else{try{ti.a()}catch(n){t("CommonApp initialization failed: {"+n+"}")}ii.a().then(function(){e.get().setInAppFeedbackInitOptions(y.a().OfficeBrowserFeedback.initOptions);at=!0;n()}).catch(function(n){t("Initialization failed: {"+n+"}")})}})}function fr(n){return new Promise(function(t,i){w?i("Control already open"):ni().then(function(){e.get().setInAppFeedbackLaunchOptions(n);du(function(){w=!1});c.b().logEvent(c.a.InApp.UI.Picker.Shown.VALUE,1,{IsBugEnabled:e.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==e.get().getInAppFeedbackInitOptions().userVoice});w=!0;t()}).catch(function(n){i("Initialization failed: {"+n+"}")})})}function er(n,t){return new Promise(function(i,r){if(w)r("Control already open");else{var u=e.validateFeedbackType(n);ni().then(function(){e.get().setInAppFeedbackLaunchOptions(t);gu(function(){w=!1},u);c.b().logEvent(c.a.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:u});w=!0;i()}).catch(function(n){r("Initialization failed: {"+n+"}")})}})}function or(){return y.a().OfficeBrowserFeedback.initOptions.isCommercialHost&&2===y.a().OfficeBrowserFeedback.initOptions.sendFeedbackPolicyValue?1:e.get().determineAADCPolicy(y.a().OfficeBrowserFeedback.initOptions.authenticationType,y.a().OfficeBrowserFeedback.initOptions.ageGroup)?0:2}function nf(){ti.b();ii.b();at=!1;w=!1}var h,p,b,k,ct,nt,f,wt,bi,ki,kt,dt,gi,gt,nr,tr,ir,y,at,w;i.r(t);i.d(t,"initialize",function(){return ni});i.d(t,"multiFeedback",function(){return fr});i.d(t,"singleFeedback",function(){return er});i.d(t,"getFeedbackStatus",function(){return or});i.d(t,"reset",function(){return nf});h={};i.r(h);i.d(h,"generate",function(){return hu});i.d(h,"containerId",function(){return wt});i.d(h,"onSelect",function(){return cu});i.d(h,"isEmailEnabled",function(){return bt});i.d(h,"isScreenshotEnabled",function(){return et});i.d(h,"type",function(){return bi});p={};i.r(p);i.d(p,"generate",function(){return vu});i.d(p,"containerId",function(){return dt});i.d(p,"onSelect",function(){return yu});i.d(p,"type",function(){return gi});b={};i.r(b);i.d(b,"generate",function(){return pu});i.d(b,"containerId",function(){return gt});i.d(b,"onSelect",function(){return wu});i.d(b,"type",function(){return nr});k={};i.r(k);i.d(k,"generate",function(){return bu});i.d(k,"containerId",function(){return tr});i.d(k,"onSelect",function(){return ku});i.d(k,"type",function(){return ir});var ti=i(26),ii=i(27),e=i(1),c=i(2),s=i(7),r=i(0),sr=i(22),hr=i(25),cr=i(34),u=i(3);var ri,rt,g,ui=!1,yt=!0,l=void 0,a=void 0,st=[r.d.OverallSmileAnchor,r.d.OverallFrownAnchor,r.d.OverallIdeaAnchor,r.d.OverallBugAnchor];ct=[];f=i(5);!function(n){n[n.Single=0]="Single";n[n.Basic=1]="Basic";n[n.UserVoice=2]="UserVoice";n[n.FeedbackPortalIdea=3]="FeedbackPortalIdea"}(nt||(nt={}));var d="obf-star",tt={children:[{attributes:[{name:r.a.Id,value:d},{name:r.a.X,value:"0"},{name:r.a.Y,value:"0"},{name:r.a.Width,value:"105"},{name:r.a.Height,value:"100"},{name:r.a.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:d,tag:r.h.Polygon}],tag:r.h.Defs},it={attributes:[{name:r.a.xlinkHref,value:"#"+d}],tag:r.h.Use},ft={attributes:[{name:r.a.xlinkHref,value:"#"+d},{name:r.a.Transform,value:"translate(105 0)"}],tag:r.h.Use},lt={attributes:[{name:r.a.xlinkHref,value:"#"+d},{name:r.a.Transform,value:"translate(210 0)"}],tag:r.h.Use},pt={attributes:[{name:r.a.xlinkHref,value:"#"+d},{name:r.a.Transform,value:"translate(315 0)"}],tag:r.h.Use},pi={attributes:[{name:r.a.xlinkHref,value:"#"+d},{name:r.a.Transform,value:"translate(420 0)"}],tag:r.h.Use},ru={attributes:[{name:r.a.ViewBox,value:"0 0 525 100"}],children:[tt,it,ft,lt,pt,pi],classes:[r.c.RatingGraphic],tag:r.h.Svg},uu={attributes:[{name:r.a.ViewBox,value:"0 0 105 100"}],children:[tt,it],classes:[r.c.RatingGraphic,r.c.RatingGraphicFilled],tag:r.h.Svg},fu={attributes:[{name:r.a.ViewBox,value:"0 0 210 100"}],children:[tt,it,ft],classes:[r.c.RatingGraphic,r.c.RatingGraphicFilled],tag:r.h.Svg},eu={attributes:[{name:r.a.ViewBox,value:"0 0 315 100"}],children:[tt,it,ft,lt],classes:[r.c.RatingGraphic,r.c.RatingGraphicFilled],tag:r.h.Svg},ou={attributes:[{name:r.a.ViewBox,value:"0 0 420 100"}],children:[tt,it,ft,lt,pt],classes:[r.c.RatingGraphic,r.c.RatingGraphicFilled],tag:r.h.Svg},su={attributes:[{name:r.a.ViewBox,value:"0 0 525 100"}],children:[tt,it,ft,lt,pt,pi],classes:[r.c.RatingGraphic,r.c.RatingGraphicFilled],tag:r.h.Svg};wt=r.d.BasicFormContainer;bi=nt.Basic;ki=r.d.SingleFormContainer;nt.Single;kt=i(31);dt=r.d.ThanksPanelContainer;gi=0;gt=r.d.UserVoiceFormContainer;nr=nt.UserVoice;tr=r.d.FeedbackPortalIdeaContainer;ir=nt.FeedbackPortalIdea;y=i(8);at=!1;w=!1;y.m(fr);y.o(er);y.e(or)}])